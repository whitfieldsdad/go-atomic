{
  "id": "96e86706-6afd-45b6-95d6-108d23eaf2e9",
  "name": "Indicator Manipulation using FSUtil",
  "description": "Finds a file by user name (if Disk Quotas are enabled), queries allocated ranges for a file, sets a file's short name, sets a file's valid data length, sets zero data for a file, or creates a new file. Upon execution, no output\nwill be displayed. More information about fsutil can be found at https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-file\n- https://tria.ge/230601-x8x6bsgb24/behavioral2\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "db0e21a2-5f32-4299-8a46-7c99abcd67b9",
      "type": "execute-command",
      "data": {
        "command": "if (-not (Test-Path \"#{file_to_manipulate}\")) { New-Item \"#{file_to_manipulate}\" -Force } \necho \"1234567890\" \u003e \"#{file_to_manipulate}\"\nfsutil  file setZeroData offset=0 length=#{file_data_length} \"#{file_to_manipulate}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "276017ed-8514-4800-892b-3581773c14b3",
      "type": "execute-command",
      "data": {
        "command": "rm \"#{file_to_manipulate}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "db0e21a2-5f32-4299-8a46-7c99abcd67b9",
      "p": "on-success",
      "o": "276017ed-8514-4800-892b-3581773c14b3"
    },
    {
      "s": "db0e21a2-5f32-4299-8a46-7c99abcd67b9",
      "p": "on-failure",
      "o": "276017ed-8514-4800-892b-3581773c14b3"
    }
  ],
  "tags": [
    "T1070",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "file_to_manipulate",
      "type": "path",
      "description": "Path of file to manipulate",
      "value": "PathToAtomicsFolder\\..\\ExternalPayloads\\T1070-2.txt"
    },
    {
      "name": "file_data_length",
      "type": "integer",
      "description": "Data length to setzero",
      "value": "10"
    }
  ]
}