{
  "id": "8b3f4ed6-077b-4bdd-891c-2d237f19410f",
  "name": "Obfuscated Command in PowerShell",
  "description": "This is an obfuscated PowerShell command which when executed prints \"Hello, from PowerShell!\". Example is from the 2021 Threat Detection Report by Red Canary.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "fb84a3fd-da49-4f34-b939-d16a5ad66514",
      "type": "execute-command",
      "data": {
        "command": "$cmDwhy =[TyPe](\"{0}{1}\" -f 'S','TrING')  ;   $pz2Sb0  =[TYpE](\"{1}{0}{2}\"-f'nv','cO','ert')  ;  \u0026(\"{0}{2}{3}{1}{4}\" -f'In','SiO','vOKe-EXp','ReS','n') (  (\u0026(\"{1}{2}{0}\"-f'blE','gET-','vaRIA')  ('CMdw'+'h'+'y')).\"v`ALUe\"::(\"{1}{0}\" -f'iN','jO').Invoke('',( (127, 162,151, 164,145 ,55 , 110 ,157 ,163 , 164 ,40,47, 110 , 145 ,154, 154 ,157 , 54 ,40, 146, 162 , 157,155 ,40, 120, 157 ,167,145 , 162 ,123,150 ,145 , 154 , 154 , 41,47)| .('%') { ( [CHAR] (  $Pz2sB0::\"t`OinT`16\"(( [sTring]${_}) ,8)))})) )\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1027",
    "atomic-red-team"
  ]
}