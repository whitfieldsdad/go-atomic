{
  "id": "a5d8cdeb-be90-43a9-8b26-cc618deac1e0",
  "name": "Use RemCom to execute a command on a remote host",
  "description": "Requires having RemCom installed, path to RemCom is one of the input input_arguments\nWill start a process on a remote host.\nUpon successful execution, cmd will utilize RemCom.exe to spawn calc.exe on a remote endpoint (default:localhost).\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "4adeeef7-f488-49db-a82b-e8aba2704048",
      "type": "execute-command",
      "data": {
        "command": "\"PathToAtomicsFolder\\..\\ExternalPayloads\\remcom.exe\" \\\\#{remote_host} /user:#{user_name} /pwd:#{password} cmd.exe\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "a7b8d1b9-c7c5-4e89-a7ae-9e4736c2d4ff",
      "name": "Check dependency 1/1",
      "description": "RemCom tool must exist on disk in the ExternalPayloads folder\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\remcom.exe\") { exit 0} else { exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d0cc0d70-31d9-477c-b256-488a4c294cae",
      "name": "Resolve dependency 1/1",
      "description": "RemCom tool must exist on disk in the ExternalPayloads folder\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://github.com/kavika13/RemCom/raw/master/bin/Release/RemCom.exe\" -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\remcom.exe\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "c1f61758-8a2f-4712-8e71-2d34615f6107",
      "name": "Re-check dependency 1/1",
      "description": "RemCom tool must exist on disk in the ExternalPayloads folder\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\remcom.exe\") { exit 0} else { exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a7b8d1b9-c7c5-4e89-a7ae-9e4736c2d4ff",
      "p": "on-success",
      "o": "4adeeef7-f488-49db-a82b-e8aba2704048"
    },
    {
      "s": "a7b8d1b9-c7c5-4e89-a7ae-9e4736c2d4ff",
      "p": "on-failure",
      "o": "d0cc0d70-31d9-477c-b256-488a4c294cae"
    },
    {
      "s": "d0cc0d70-31d9-477c-b256-488a4c294cae",
      "p": "on-success",
      "o": "c1f61758-8a2f-4712-8e71-2d34615f6107"
    },
    {
      "s": "c1f61758-8a2f-4712-8e71-2d34615f6107",
      "p": "on-failure",
      "o": "4adeeef7-f488-49db-a82b-e8aba2704048"
    }
  ],
  "tags": [
    "T1569.002",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "remote_host",
      "type": "string",
      "description": "Remote hostname or IP address",
      "value": "localhost"
    },
    {
      "name": "user_name",
      "type": "string",
      "description": "Username",
      "value": "Administrator"
    },
    {
      "name": "password",
      "type": "string",
      "description": "Password",
      "value": "P@ssw0rd1"
    }
  ]
}