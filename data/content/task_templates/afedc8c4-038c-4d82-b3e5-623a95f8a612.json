{
  "id": "afedc8c4-038c-4d82-b3e5-623a95f8a612",
  "name": "Disable Microsoft Defender Firewall via Registry",
  "description": "Disables the Microsoft Defender Firewall for the public profile via registry\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "64f89be6-61ad-48da-bda6-8acd1bd9fa77",
      "type": "execute-command",
      "data": {
        "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 0 /f\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "ea59fbc1-2f70-47df-9888-7b9db4c6b6e6",
      "type": "execute-command",
      "data": {
        "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 1 /f\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "64f89be6-61ad-48da-bda6-8acd1bd9fa77",
      "p": "on-success",
      "o": "ea59fbc1-2f70-47df-9888-7b9db4c6b6e6"
    },
    {
      "s": "64f89be6-61ad-48da-bda6-8acd1bd9fa77",
      "p": "on-failure",
      "o": "ea59fbc1-2f70-47df-9888-7b9db4c6b6e6"
    }
  ],
  "tags": [
    "T1562",
    "T1562.004"
  ]
}