{
  "id": "fbff3f1f-b0bf-448e-840f-7e1687affdce",
  "name": "RemotePC Software Execution",
  "description": "An adversary may attempt to trick the user into downloading RemotePC Software for use as a C2 channel. \nUpon successful execution, RemotePC will be executed. \n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "974bc947-63c1-4caa-bc58-b2ce0c71c469",
      "type": "execute-command",
      "data": {
        "command": "Start-Process \"#{RemotePC_Path}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "5c2d3020-eb52-42ce-b9d3-b7613c4d9198",
      "type": "execute-command",
      "data": {
        "command": "Unregister-ScheduledTask -TaskName \"RemotePC\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"RPCServiceHealthCheck\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"ServiceMonitor\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"StartRPCService\" -Confirm:$False -ErrorAction SilentlyContinue      \nStop-Process -Name \"RemotePCPerformance\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCPerformanceService\" -force -erroraction silentlycontinue\nStop-Process -Name \"RemotePCUIU\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCDownloader\" -force -erroraction silentlycontinue\nStop-Process -Name \"RemotePCService\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCService\" -force -erroraction silentlycontinue\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "b205b759-040b-4684-a946-d7b67aa329c9",
      "name": "Check dependency 1/1",
      "description": "RemotePC must exist on disk at the specified location (#{RemotePC_Path})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{RemotePC_Path}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "561ef1a0-00e3-440c-9013-f72c0e152190",
      "name": "Resolve dependency 1/1",
      "description": "RemotePC must exist on disk at the specified location (#{RemotePC_Path})\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://static.remotepc.com/downloads/rpc/140422/RemotePC.exe\" -OutFile \"#{RemotePC_Path}\" -UseBasicParsing\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "dd051683-ccf2-49f5-9482-5fa0a551f80b",
      "name": "Re-check dependency 1/1",
      "description": "RemotePC must exist on disk at the specified location (#{RemotePC_Path})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{RemotePC_Path}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "974bc947-63c1-4caa-bc58-b2ce0c71c469",
      "p": "on-success",
      "o": "5c2d3020-eb52-42ce-b9d3-b7613c4d9198"
    },
    {
      "s": "974bc947-63c1-4caa-bc58-b2ce0c71c469",
      "p": "on-failure",
      "o": "5c2d3020-eb52-42ce-b9d3-b7613c4d9198"
    },
    {
      "s": "b205b759-040b-4684-a946-d7b67aa329c9",
      "p": "on-success",
      "o": "974bc947-63c1-4caa-bc58-b2ce0c71c469"
    },
    {
      "s": "b205b759-040b-4684-a946-d7b67aa329c9",
      "p": "on-failure",
      "o": "561ef1a0-00e3-440c-9013-f72c0e152190"
    },
    {
      "s": "561ef1a0-00e3-440c-9013-f72c0e152190",
      "p": "on-success",
      "o": "dd051683-ccf2-49f5-9482-5fa0a551f80b"
    },
    {
      "s": "dd051683-ccf2-49f5-9482-5fa0a551f80b",
      "p": "on-failure",
      "o": "974bc947-63c1-4caa-bc58-b2ce0c71c469"
    }
  ],
  "tags": [
    "T1219",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "RemotePC_Path",
      "type": "path",
      "description": "Path of RemotePC executable",
      "value": "PathToAtomicsFolder\\..\\ExternalPayloads\\RemotePC.exe"
    }
  ]
}