{
  "id": "fe135572-edcd-49a2-afe6-1d39521c5a9a",
  "name": "Stop/Start UFW firewall",
  "description": "Stop the Uncomplicated Firewall (UFW) if installed.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "9635b7c0-e876-435f-9802-33d655cb6fca",
      "type": "execute-command",
      "data": {
        "command": "ufw disable",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "5b8980b5-1b2e-458e-9e29-c9c559fd8e69",
      "type": "execute-command",
      "data": {
        "command": "ufw enable\nufw status verbose",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "e5733ec6-fc4f-4abc-9c91-e2f026f78880",
      "name": "Check dependency 1/1",
      "description": "Check if ufw is installed on the machine.\n",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "7f469bfc-0d16-49bf-85c9-abb0f1562d40",
      "name": "Resolve dependency 1/1",
      "description": "Check if ufw is installed on the machine.\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"\"",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "dc013731-6693-43b1-ada4-98792fb93329",
      "name": "Re-check dependency 1/1",
      "description": "Check if ufw is installed on the machine.\n",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
        "command_type": "sh"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "9635b7c0-e876-435f-9802-33d655cb6fca",
      "p": "on-success",
      "o": "5b8980b5-1b2e-458e-9e29-c9c559fd8e69"
    },
    {
      "s": "9635b7c0-e876-435f-9802-33d655cb6fca",
      "p": "on-failure",
      "o": "5b8980b5-1b2e-458e-9e29-c9c559fd8e69"
    },
    {
      "s": "e5733ec6-fc4f-4abc-9c91-e2f026f78880",
      "p": "on-success",
      "o": "9635b7c0-e876-435f-9802-33d655cb6fca"
    },
    {
      "s": "e5733ec6-fc4f-4abc-9c91-e2f026f78880",
      "p": "on-failure",
      "o": "7f469bfc-0d16-49bf-85c9-abb0f1562d40"
    },
    {
      "s": "7f469bfc-0d16-49bf-85c9-abb0f1562d40",
      "p": "on-success",
      "o": "dc013731-6693-43b1-ada4-98792fb93329"
    },
    {
      "s": "dc013731-6693-43b1-ada4-98792fb93329",
      "p": "on-failure",
      "o": "9635b7c0-e876-435f-9802-33d655cb6fca"
    }
  ],
  "tags": [
    "T1562",
    "T1562.004"
  ],
  "input_arguments": null
}