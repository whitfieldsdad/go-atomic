{
  "id": "f2fa019e-fb2a-4d28-9dc6-fd1a9b7f68c3",
  "name": "CreateCronjob",
  "description": "Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.\n",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "e1676e6f-40d1-4517-a7a6-9486a399b7d7",
      "type": "execute-command",
      "data": {
        "command": "kubectl create -f src/cronjob.yaml -n #{namespace}",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "bbd1bffd-44d8-49e3-8643-a3f5532e728d",
      "type": "execute-command",
      "data": {
        "command": "kubectl delete cronjob art -n #{namespace}",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "9753a3c3-cd3f-49f1-a63f-12f3e211496a",
      "name": "Check dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which kubectl",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "28c78012-d227-4a95-97a2-beb64b2c11d1",
      "name": "Resolve dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"kubectl must be installed manually\"",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "4ce1a9c2-f11b-4cc6-9a48-7ea5a8040a30",
      "name": "Re-check dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which kubectl",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "e1676e6f-40d1-4517-a7a6-9486a399b7d7",
      "p": "on-success",
      "o": "bbd1bffd-44d8-49e3-8643-a3f5532e728d"
    },
    {
      "s": "e1676e6f-40d1-4517-a7a6-9486a399b7d7",
      "p": "on-failure",
      "o": "bbd1bffd-44d8-49e3-8643-a3f5532e728d"
    },
    {
      "s": "9753a3c3-cd3f-49f1-a63f-12f3e211496a",
      "p": "on-success",
      "o": "e1676e6f-40d1-4517-a7a6-9486a399b7d7"
    },
    {
      "s": "9753a3c3-cd3f-49f1-a63f-12f3e211496a",
      "p": "on-failure",
      "o": "28c78012-d227-4a95-97a2-beb64b2c11d1"
    },
    {
      "s": "28c78012-d227-4a95-97a2-beb64b2c11d1",
      "p": "on-success",
      "o": "4ce1a9c2-f11b-4cc6-9a48-7ea5a8040a30"
    },
    {
      "s": "4ce1a9c2-f11b-4cc6-9a48-7ea5a8040a30",
      "p": "on-failure",
      "o": "e1676e6f-40d1-4517-a7a6-9486a399b7d7"
    }
  ],
  "tags": [
    "T1053",
    "T1053.007"
  ],
  "input_arguments": [
    {
      "name": "namespace",
      "type": "string",
      "description": "K8s namespace to list",
      "value": "default"
    }
  ]
}