{
  "id": "2db30061-589d-409b-b125-7b473944f9b3",
  "name": "Build Image On Host",
  "description": "Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. An adversary may take advantage of that build API to build a custom image on the host that includes malware downloaded from their C2 server, and then they then may utilize Deploy Container using that custom image.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "6836de9c-c388-40be-9794-f50d2643ad97",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1612  $PathtoAtomicsFolder/T1612/src/\ndocker run --name t1612_container  -d -t t1612\ndocker exec t1612_container ./test.sh",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "42a97a4d-0386-4cd3-a7a0-fa8ab6f1d19a",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1612_container\ndocker rmi -f t1612",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "040804f8-4caf-4060-93f1-730871144931",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "801b128f-8e73-4395-95cc-ea6d617b7c06",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "544cdf82-a951-471f-b279-117f34b013a0",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "379862e6-3ab7-4683-9e60-be05bc263ef0",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "174e230f-4ccc-4865-8333-281e506cd581",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "279a9419-a335-4819-97b3-52ac199d6eb0",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "6836de9c-c388-40be-9794-f50d2643ad97",
      "p": "on-success",
      "o": "42a97a4d-0386-4cd3-a7a0-fa8ab6f1d19a"
    },
    {
      "s": "6836de9c-c388-40be-9794-f50d2643ad97",
      "p": "on-failure",
      "o": "42a97a4d-0386-4cd3-a7a0-fa8ab6f1d19a"
    },
    {
      "s": "040804f8-4caf-4060-93f1-730871144931",
      "p": "on-success",
      "o": "6836de9c-c388-40be-9794-f50d2643ad97"
    },
    {
      "s": "040804f8-4caf-4060-93f1-730871144931",
      "p": "on-failure",
      "o": "801b128f-8e73-4395-95cc-ea6d617b7c06"
    },
    {
      "s": "801b128f-8e73-4395-95cc-ea6d617b7c06",
      "p": "on-success",
      "o": "544cdf82-a951-471f-b279-117f34b013a0"
    },
    {
      "s": "544cdf82-a951-471f-b279-117f34b013a0",
      "p": "on-failure",
      "o": "6836de9c-c388-40be-9794-f50d2643ad97"
    },
    {
      "s": "379862e6-3ab7-4683-9e60-be05bc263ef0",
      "p": "on-success",
      "o": "6836de9c-c388-40be-9794-f50d2643ad97"
    },
    {
      "s": "379862e6-3ab7-4683-9e60-be05bc263ef0",
      "p": "on-failure",
      "o": "174e230f-4ccc-4865-8333-281e506cd581"
    },
    {
      "s": "174e230f-4ccc-4865-8333-281e506cd581",
      "p": "on-success",
      "o": "279a9419-a335-4819-97b3-52ac199d6eb0"
    },
    {
      "s": "279a9419-a335-4819-97b3-52ac199d6eb0",
      "p": "on-failure",
      "o": "6836de9c-c388-40be-9794-f50d2643ad97"
    }
  ],
  "tags": [
    "T1612"
  ],
  "input_arguments": null
}