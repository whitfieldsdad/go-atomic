{
  "id": "2db30061-589d-409b-b125-7b473944f9b3",
  "name": "Build Image On Host",
  "description": "Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. An adversary may take advantage of that build API to build a custom image on the host that includes malware downloaded from their C2 server, and then they then may utilize Deploy Container using that custom image.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1612  $PathtoAtomicsFolder/T1612/src/\ndocker run --name t1612_container  -d -t t1612\ndocker exec t1612_container ./test.sh",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "a9162e60-6c7a-43d4-a1e6-9005d603bb5e",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1612_container\ndocker rmi -f t1612",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "53208f40-1eae-4dc5-8de8-43af0def732e",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "3c33beb3-9f7a-4279-9399-9d68966806d2",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "23ba56ce-9d97-4b2a-96fb-c2e142529234",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "db1012fe-f6ba-4e9b-8c97-21e4f6ab6413",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "9f20ac59-a4b7-4e41-9b9e-c17b0dc0b424",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "23b3840c-7cb2-4077-ae57-0d0b4b06c6b3",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85",
      "p": "on-success",
      "o": "a9162e60-6c7a-43d4-a1e6-9005d603bb5e"
    },
    {
      "s": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85",
      "p": "on-failure",
      "o": "a9162e60-6c7a-43d4-a1e6-9005d603bb5e"
    },
    {
      "s": "53208f40-1eae-4dc5-8de8-43af0def732e",
      "p": "on-success",
      "o": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85"
    },
    {
      "s": "53208f40-1eae-4dc5-8de8-43af0def732e",
      "p": "on-failure",
      "o": "3c33beb3-9f7a-4279-9399-9d68966806d2"
    },
    {
      "s": "3c33beb3-9f7a-4279-9399-9d68966806d2",
      "p": "on-success",
      "o": "23ba56ce-9d97-4b2a-96fb-c2e142529234"
    },
    {
      "s": "23ba56ce-9d97-4b2a-96fb-c2e142529234",
      "p": "on-failure",
      "o": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85"
    },
    {
      "s": "db1012fe-f6ba-4e9b-8c97-21e4f6ab6413",
      "p": "on-success",
      "o": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85"
    },
    {
      "s": "db1012fe-f6ba-4e9b-8c97-21e4f6ab6413",
      "p": "on-failure",
      "o": "9f20ac59-a4b7-4e41-9b9e-c17b0dc0b424"
    },
    {
      "s": "9f20ac59-a4b7-4e41-9b9e-c17b0dc0b424",
      "p": "on-success",
      "o": "23b3840c-7cb2-4077-ae57-0d0b4b06c6b3"
    },
    {
      "s": "23b3840c-7cb2-4077-ae57-0d0b4b06c6b3",
      "p": "on-failure",
      "o": "f35cd4ab-0fb3-42ba-b1c7-c370bc480d85"
    }
  ],
  "tags": [
    "T1612"
  ]
}