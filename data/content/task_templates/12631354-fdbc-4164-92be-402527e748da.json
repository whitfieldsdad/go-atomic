{
  "id": "12631354-fdbc-4164-92be-402527e748da",
  "name": "Tor Proxy Usage - MacOS",
  "description": "This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.\nUpon successful execution, the tor proxy service will be launched. \n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "9fed13fd-e8ef-4d0f-a7a3-a8ef2e275c17",
      "type": "execute-command",
      "data": {
        "command": "osascript -e 'tell application \"Terminal\" to do script \"tor\"'\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "5d2c6bd0-0ab1-4a7e-9b98-a66a13003f21",
      "type": "execute-command",
      "data": {
        "command": "killall tor \u003e /dev/null 2\u003e\u00261\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "b5b0803f-0f77-4168-a827-cd8f9ea7e04d",
      "name": "Check dependency 1/1",
      "description": "Tor must be installed on the machine \n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v tor --version)\" ]; then exit 0; else exit 1; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "31053710-37ea-4cd9-9bf5-303daf6c5201",
      "name": "Resolve dependency 1/1",
      "description": "Tor must be installed on the machine \n",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -x \"$(command -v brew --version)\" ]; then /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh keystroke return)\"; fi\nbrew install tor\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "1f8eb0c3-6678-4eb2-96ff-744a69d37683",
      "name": "Re-check dependency 1/1",
      "description": "Tor must be installed on the machine \n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v tor --version)\" ]; then exit 0; else exit 1; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "9fed13fd-e8ef-4d0f-a7a3-a8ef2e275c17",
      "p": "on-success",
      "o": "5d2c6bd0-0ab1-4a7e-9b98-a66a13003f21"
    },
    {
      "s": "9fed13fd-e8ef-4d0f-a7a3-a8ef2e275c17",
      "p": "on-failure",
      "o": "5d2c6bd0-0ab1-4a7e-9b98-a66a13003f21"
    },
    {
      "s": "b5b0803f-0f77-4168-a827-cd8f9ea7e04d",
      "p": "on-success",
      "o": "9fed13fd-e8ef-4d0f-a7a3-a8ef2e275c17"
    },
    {
      "s": "b5b0803f-0f77-4168-a827-cd8f9ea7e04d",
      "p": "on-failure",
      "o": "31053710-37ea-4cd9-9bf5-303daf6c5201"
    },
    {
      "s": "31053710-37ea-4cd9-9bf5-303daf6c5201",
      "p": "on-success",
      "o": "1f8eb0c3-6678-4eb2-96ff-744a69d37683"
    },
    {
      "s": "1f8eb0c3-6678-4eb2-96ff-744a69d37683",
      "p": "on-failure",
      "o": "9fed13fd-e8ef-4d0f-a7a3-a8ef2e275c17"
    }
  ],
  "tags": [
    "T1090",
    "T1090.003"
  ]
}