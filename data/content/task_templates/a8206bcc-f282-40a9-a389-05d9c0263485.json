{
  "id": "a8206bcc-f282-40a9-a389-05d9c0263485",
  "name": "cacls - Grant permission to specified user or group recursively",
  "description": "Modifies the filesystem permissions of the specified folder and contents to allow the specified user or group Full Control. If \"Access is denied\"\nis displayed it may be because the file or folder doesn't exit. Run the prereq command to create it. Upon successfull execution, \"Successfully processed 3 files\"\nwill be displayed.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "265b263f-64aa-490b-a936-57f030bb3b5c",
      "type": "execute-command",
      "data": {
        "command": "icacls.exe #{file_or_folder} /grant #{user_or_group}:F",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "e57ad32b-da40-4e68-8097-c1f0c9e6b673",
      "name": "Check dependency 1/1",
      "description": "Test requrires a file to modify to be located at (#{file_or_folder})\n",
      "type": "execute-command",
      "data": {
        "command": "IF EXIST #{file_or_folder} ( EXIT 0 ) ELSE ( EXIT 1 )",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "5fec0f95-fff2-4607-9e59-54b58291189d",
      "name": "Resolve dependency 1/1",
      "description": "Test requrires a file to modify to be located at (#{file_or_folder})\n",
      "type": "execute-command",
      "data": {
        "command": "mkdir #{file_or_folder}\necho T1222.001_cacls1 \u003e\u003e #{file_or_folder}\\T1222.001_cacls1.txt\necho T1222.001_cacls2 \u003e\u003e #{file_or_folder}\\T1222.001_cacls2.txt",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "a1037055-15c2-4e77-be0d-5615b29b225f",
      "name": "Re-check dependency 1/1",
      "description": "Test requrires a file to modify to be located at (#{file_or_folder})\n",
      "type": "execute-command",
      "data": {
        "command": "IF EXIST #{file_or_folder} ( EXIT 0 ) ELSE ( EXIT 1 )",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "e57ad32b-da40-4e68-8097-c1f0c9e6b673",
      "p": "on-success",
      "o": "265b263f-64aa-490b-a936-57f030bb3b5c"
    },
    {
      "s": "e57ad32b-da40-4e68-8097-c1f0c9e6b673",
      "p": "on-failure",
      "o": "5fec0f95-fff2-4607-9e59-54b58291189d"
    },
    {
      "s": "5fec0f95-fff2-4607-9e59-54b58291189d",
      "p": "on-success",
      "o": "a1037055-15c2-4e77-be0d-5615b29b225f"
    },
    {
      "s": "a1037055-15c2-4e77-be0d-5615b29b225f",
      "p": "on-failure",
      "o": "265b263f-64aa-490b-a936-57f030bb3b5c"
    }
  ],
  "tags": [
    "T1222",
    "T1222.001"
  ],
  "input_arguments": [
    {
      "name": "file_or_folder",
      "type": "path",
      "description": "Path of the file or folder to change permissions.",
      "value": "%temp%\\T1222.001_cacls"
    },
    {
      "name": "user_or_group",
      "type": "string",
      "description": "User or group to allow full control",
      "value": "Everyone"
    }
  ]
}