{
  "id": "69435dcf-c66f-4ec0-a8b1-82beb76b34db",
  "name": "Disable Windows IIS HTTP Logging",
  "description": "Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).\nThis action requires HTTP logging configurations in IIS to be unlocked.\n\nUse the cleanup commands to restore some default auditpol settings (your original settings will be lost)\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "3e7a0f17-21a3-45b8-833e-81bd3b6c3c41",
      "type": "execute-command",
      "data": {
        "command": "C:\\Windows\\System32\\inetsrv\\appcmd.exe set config \"#{website_name}\" /section:httplogging /dontLog:true",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "387f3aac-288a-4b79-896f-97a34f84f029",
      "type": "execute-command",
      "data": {
        "command": "if(Test-Path \"C:\\Windows\\System32\\inetsrv\\appcmd.exe\"){\n  C:\\Windows\\System32\\inetsrv\\appcmd.exe set config \"#{website_name}\" /section:httplogging /dontLog:false *\u003e$null\n}",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "3e7a0f17-21a3-45b8-833e-81bd3b6c3c41",
      "p": "on-success",
      "o": "387f3aac-288a-4b79-896f-97a34f84f029"
    },
    {
      "s": "3e7a0f17-21a3-45b8-833e-81bd3b6c3c41",
      "p": "on-failure",
      "o": "387f3aac-288a-4b79-896f-97a34f84f029"
    }
  ],
  "tags": [
    "T1562",
    "T1562.002"
  ],
  "input_arguments": [
    {
      "name": "website_name",
      "type": "string",
      "description": "The name of the website on a server",
      "value": "Default Web Site"
    }
  ]
}