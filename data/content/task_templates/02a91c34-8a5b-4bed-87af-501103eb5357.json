{
  "id": "02a91c34-8a5b-4bed-87af-501103eb5357",
  "name": "Create local account (Linux)",
  "description": "An adversary may wish to create an account with admin privileges to work with. In this test we create a \"art\" user with the password art, switch to art, execute whoami, exit and delete the art user.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "72266bc0-5be9-4982-83bc-ca92fc4a3491",
      "type": "execute-command",
      "data": {
        "command": "password=$(openssl passwd -1 art)\n([ \"$(uname)\" = 'Linux' ] \u0026\u0026 useradd --shell /bin/bash --create-home --password $password art) || (pw useradd art -g wheel -s /bin/sh \u0026\u0026 (echo $password | pw mod user testuser1 -h 0))\nsu art -c \"whoami; exit\"\n",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "c15597b9-a8d1-4fbc-9f87-f0eaedefd5dc",
      "type": "execute-command",
      "data": {
        "command": "[ \"$(uname)\" = 'Linux' ] \u0026\u0026 userdel art -rf || rmuser -y art\n",
        "command_type": "bash"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "72266bc0-5be9-4982-83bc-ca92fc4a3491",
      "p": "on-success",
      "o": "c15597b9-a8d1-4fbc-9f87-f0eaedefd5dc"
    },
    {
      "s": "72266bc0-5be9-4982-83bc-ca92fc4a3491",
      "p": "on-failure",
      "o": "c15597b9-a8d1-4fbc-9f87-f0eaedefd5dc"
    }
  ],
  "tags": [
    "T1078",
    "T1078.003"
  ]
}