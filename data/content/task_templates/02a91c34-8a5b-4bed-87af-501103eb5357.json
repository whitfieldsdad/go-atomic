{
  "id": "02a91c34-8a5b-4bed-87af-501103eb5357",
  "name": "Create local account (Linux)",
  "description": "An adversary may wish to create an account with admin privileges to work with. In this test we create a \"art\" user with the password art, switch to art, execute whoami, exit and delete the art user.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "ab7e0468-34d6-4438-bb53-f3fd450422a8",
      "type": "execute-command",
      "data": {
        "command": "password=$(openssl passwd -1 art)\n([ \"$(uname)\" = 'Linux' ] \u0026\u0026 useradd --shell /bin/bash --create-home --password $password art) || (pw useradd art -g wheel -s /bin/sh \u0026\u0026 (echo $password | pw mod user testuser1 -h 0))\nsu art -c \"whoami; exit\"",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "75a6a516-3cda-4218-aeef-46d9474d89d7",
      "type": "execute-command",
      "data": {
        "command": "[ \"$(uname)\" = 'Linux' ] \u0026\u0026 userdel art -rf || rmuser -y art",
        "command_type": "bash"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "ab7e0468-34d6-4438-bb53-f3fd450422a8",
      "p": "on-success",
      "o": "75a6a516-3cda-4218-aeef-46d9474d89d7"
    },
    {
      "s": "ab7e0468-34d6-4438-bb53-f3fd450422a8",
      "p": "on-failure",
      "o": "75a6a516-3cda-4218-aeef-46d9474d89d7"
    }
  ],
  "tags": [
    "T1078",
    "T1078.003"
  ]
}