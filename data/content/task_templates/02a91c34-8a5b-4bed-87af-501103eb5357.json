{
  "id": "02a91c34-8a5b-4bed-87af-501103eb5357",
  "name": "Create local account (Linux)",
  "description": "An adversary may wish to create an account with admin privileges to work with. In this test we create a \"art\" user with the password art, switch to art, execute whoami, exit and delete the art user.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "04f279de-2190-4e61-bbb9-676b6f536b61",
      "type": "execute-command",
      "data": {
        "command": "password=$(openssl passwd -1 art)\n([ \"$(uname)\" = 'Linux' ] \u0026\u0026 useradd --shell /bin/bash --create-home --password $password art) || (pw useradd art -g wheel -s /bin/sh \u0026\u0026 (echo $password | pw mod user testuser1 -h 0))\nsu art -c \"whoami; exit\"\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "f761d8fa-3c82-49cc-85c4-9d7ac9116b2b",
      "type": "execute-command",
      "data": {
        "command": "[ \"$(uname)\" = 'Linux' ] \u0026\u0026 userdel art -rf || rmuser -y art\n",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "04f279de-2190-4e61-bbb9-676b6f536b61",
      "p": "on-success",
      "o": "f761d8fa-3c82-49cc-85c4-9d7ac9116b2b"
    },
    {
      "s": "04f279de-2190-4e61-bbb9-676b6f536b61",
      "p": "on-failure",
      "o": "f761d8fa-3c82-49cc-85c4-9d7ac9116b2b"
    }
  ],
  "tags": [
    "T1078.003",
    "atomic-red-team"
  ]
}