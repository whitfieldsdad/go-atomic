{
  "id": "a96872b2-cbf3-46cf-8eb4-27e8c0e85263",
  "name": "Registry parse with pypykatz",
  "description": "Parses registry hives to obtain stored credentials\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "f700b665-b794-43b9-b1fa-92dc084c0b24",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live registry",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "fa0d17eb-350c-47d8-9132-a6947d7afcc9",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "f608ecd6-4f38-4495-971c-77f46070cc84",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "caf659b0-4eba-4ee3-8a75-db05a6042b3f",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "2f0acd10-5c91-4843-b24b-120c340777a6",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "df104832-b2d0-4f29-a69b-a8b8de307f21",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "cf66bc1f-af76-4c6e-b545-aa0f4aa6971c",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "d81e1b00-5d40-44cf-8d2a-1fa64bb0359b",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "4a105063-0f5f-4af1-abbc-0ea0385261f5",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "92e8a97a-8538-4c0a-85a2-c369151b3712",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "fa0d17eb-350c-47d8-9132-a6947d7afcc9",
      "p": "on-success",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    },
    {
      "s": "fa0d17eb-350c-47d8-9132-a6947d7afcc9",
      "p": "on-failure",
      "o": "f608ecd6-4f38-4495-971c-77f46070cc84"
    },
    {
      "s": "f608ecd6-4f38-4495-971c-77f46070cc84",
      "p": "on-success",
      "o": "caf659b0-4eba-4ee3-8a75-db05a6042b3f"
    },
    {
      "s": "caf659b0-4eba-4ee3-8a75-db05a6042b3f",
      "p": "on-failure",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    },
    {
      "s": "2f0acd10-5c91-4843-b24b-120c340777a6",
      "p": "on-success",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    },
    {
      "s": "2f0acd10-5c91-4843-b24b-120c340777a6",
      "p": "on-failure",
      "o": "df104832-b2d0-4f29-a69b-a8b8de307f21"
    },
    {
      "s": "df104832-b2d0-4f29-a69b-a8b8de307f21",
      "p": "on-success",
      "o": "cf66bc1f-af76-4c6e-b545-aa0f4aa6971c"
    },
    {
      "s": "cf66bc1f-af76-4c6e-b545-aa0f4aa6971c",
      "p": "on-failure",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    },
    {
      "s": "d81e1b00-5d40-44cf-8d2a-1fa64bb0359b",
      "p": "on-success",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    },
    {
      "s": "d81e1b00-5d40-44cf-8d2a-1fa64bb0359b",
      "p": "on-failure",
      "o": "4a105063-0f5f-4af1-abbc-0ea0385261f5"
    },
    {
      "s": "4a105063-0f5f-4af1-abbc-0ea0385261f5",
      "p": "on-success",
      "o": "92e8a97a-8538-4c0a-85a2-c369151b3712"
    },
    {
      "s": "92e8a97a-8538-4c0a-85a2-c369151b3712",
      "p": "on-failure",
      "o": "f700b665-b794-43b9-b1fa-92dc084c0b24"
    }
  ],
  "tags": [
    "T1003",
    "T1003.002"
  ],
  "input_arguments": null
}