{
  "id": "a96872b2-cbf3-46cf-8eb4-27e8c0e85263",
  "name": "Registry parse with pypykatz",
  "description": "Parses registry hives to obtain stored credentials\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "8e19173f-22bb-4ccc-9273-479a959737ab",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live registry",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "8223ba57-9071-4a10-a1a1-fb0eb7dfa92a",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "f6b7d8e1-ad9b-48ea-80e4-10c47f1be724",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "005405b6-5a4b-4aaf-b64f-dc3b0d24e15f",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "f3761f5a-9fff-45cb-831c-9f800f42135c",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "9651d02e-08b8-4e34-bff8-9a61f0030152",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "eeb25e4a-a084-4e5b-a47f-ce85afdc7043",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "c6557777-dae1-4aad-9121-6f3056d2470b",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "4d188b02-5c65-470d-8160-336c52e4ea36",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "ff5ec409-77a7-435c-89d1-940dab6e128a",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "8223ba57-9071-4a10-a1a1-fb0eb7dfa92a",
      "p": "on-success",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    },
    {
      "s": "8223ba57-9071-4a10-a1a1-fb0eb7dfa92a",
      "p": "on-failure",
      "o": "f6b7d8e1-ad9b-48ea-80e4-10c47f1be724"
    },
    {
      "s": "f6b7d8e1-ad9b-48ea-80e4-10c47f1be724",
      "p": "on-success",
      "o": "005405b6-5a4b-4aaf-b64f-dc3b0d24e15f"
    },
    {
      "s": "005405b6-5a4b-4aaf-b64f-dc3b0d24e15f",
      "p": "on-failure",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    },
    {
      "s": "f3761f5a-9fff-45cb-831c-9f800f42135c",
      "p": "on-success",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    },
    {
      "s": "f3761f5a-9fff-45cb-831c-9f800f42135c",
      "p": "on-failure",
      "o": "9651d02e-08b8-4e34-bff8-9a61f0030152"
    },
    {
      "s": "9651d02e-08b8-4e34-bff8-9a61f0030152",
      "p": "on-success",
      "o": "eeb25e4a-a084-4e5b-a47f-ce85afdc7043"
    },
    {
      "s": "eeb25e4a-a084-4e5b-a47f-ce85afdc7043",
      "p": "on-failure",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    },
    {
      "s": "c6557777-dae1-4aad-9121-6f3056d2470b",
      "p": "on-success",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    },
    {
      "s": "c6557777-dae1-4aad-9121-6f3056d2470b",
      "p": "on-failure",
      "o": "4d188b02-5c65-470d-8160-336c52e4ea36"
    },
    {
      "s": "4d188b02-5c65-470d-8160-336c52e4ea36",
      "p": "on-success",
      "o": "ff5ec409-77a7-435c-89d1-940dab6e128a"
    },
    {
      "s": "ff5ec409-77a7-435c-89d1-940dab6e128a",
      "p": "on-failure",
      "o": "8e19173f-22bb-4ccc-9273-479a959737ab"
    }
  ],
  "tags": [
    "T1003",
    "T1003.002"
  ]
}