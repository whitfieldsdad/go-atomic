{
  "id": "a96872b2-cbf3-46cf-8eb4-27e8c0e85263",
  "name": "Registry parse with pypykatz",
  "description": "Parses registry hives to obtain stored credentials\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live registry\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "3d5a2d2a-47a8-400e-b77d-3da9cf1b9892",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "f846778b-5cdb-437a-9dd0-4feeca85daa4",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "42ce69d4-422c-4302-93c5-5bc378a5bcab",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "befe15e7-36bd-4034-a370-0edd9d6d9005",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "dec59ad9-b159-4a81-bbd0-c0df3c6aa646",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "5e193a3b-4e7e-470a-a2ca-c15e88cd42cc",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "9e72132d-9d3a-4564-b285-1039ef04ccb4",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "920ce1c3-d0bb-4e8f-98ef-4b4ca36079ac",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "3f5a3e1e-6cf6-4f93-902d-59e134c4ed91",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "3d5a2d2a-47a8-400e-b77d-3da9cf1b9892",
      "p": "on-success",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    },
    {
      "s": "3d5a2d2a-47a8-400e-b77d-3da9cf1b9892",
      "p": "on-failure",
      "o": "f846778b-5cdb-437a-9dd0-4feeca85daa4"
    },
    {
      "s": "f846778b-5cdb-437a-9dd0-4feeca85daa4",
      "p": "on-success",
      "o": "42ce69d4-422c-4302-93c5-5bc378a5bcab"
    },
    {
      "s": "42ce69d4-422c-4302-93c5-5bc378a5bcab",
      "p": "on-failure",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    },
    {
      "s": "befe15e7-36bd-4034-a370-0edd9d6d9005",
      "p": "on-success",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    },
    {
      "s": "befe15e7-36bd-4034-a370-0edd9d6d9005",
      "p": "on-failure",
      "o": "dec59ad9-b159-4a81-bbd0-c0df3c6aa646"
    },
    {
      "s": "dec59ad9-b159-4a81-bbd0-c0df3c6aa646",
      "p": "on-success",
      "o": "5e193a3b-4e7e-470a-a2ca-c15e88cd42cc"
    },
    {
      "s": "5e193a3b-4e7e-470a-a2ca-c15e88cd42cc",
      "p": "on-failure",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    },
    {
      "s": "9e72132d-9d3a-4564-b285-1039ef04ccb4",
      "p": "on-success",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    },
    {
      "s": "9e72132d-9d3a-4564-b285-1039ef04ccb4",
      "p": "on-failure",
      "o": "920ce1c3-d0bb-4e8f-98ef-4b4ca36079ac"
    },
    {
      "s": "920ce1c3-d0bb-4e8f-98ef-4b4ca36079ac",
      "p": "on-success",
      "o": "3f5a3e1e-6cf6-4f93-902d-59e134c4ed91"
    },
    {
      "s": "3f5a3e1e-6cf6-4f93-902d-59e134c4ed91",
      "p": "on-failure",
      "o": "aea1bd8b-2d1b-4188-bd96-6b7080f2dbf4"
    }
  ],
  "tags": [
    "T1003.002",
    "atomic-red-team"
  ]
}