{
  "id": "a96872b2-cbf3-46cf-8eb4-27e8c0e85263",
  "name": "Registry parse with pypykatz",
  "description": "Parses registry hives to obtain stored credentials\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "171d3caf-0694-448b-995a-661fa7073482",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live registry\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "3926b2db-b9ef-41d9-a799-27a3491d6627",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "1a0cde1c-d12f-451f-a59c-ed591a865acc",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "06c9cce7-8592-49da-bdf8-d7181de17d43",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "2878802a-a1f6-4c63-8374-16b4463562af",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "4decec9c-3288-4d27-8328-5fc5a5b50014",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "4463fc42-0ba8-4b77-8d15-3d29e2c34d7c",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "83ee24b4-7abc-49f4-97fc-db18dfd2d969",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0c8785ac-8e42-4b37-9d7b-f00c116191f0",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "a55e8659-7bd7-4084-9ecc-6d70bc684f9c",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "3926b2db-b9ef-41d9-a799-27a3491d6627",
      "p": "on-success",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    },
    {
      "s": "3926b2db-b9ef-41d9-a799-27a3491d6627",
      "p": "on-failure",
      "o": "1a0cde1c-d12f-451f-a59c-ed591a865acc"
    },
    {
      "s": "1a0cde1c-d12f-451f-a59c-ed591a865acc",
      "p": "on-success",
      "o": "06c9cce7-8592-49da-bdf8-d7181de17d43"
    },
    {
      "s": "06c9cce7-8592-49da-bdf8-d7181de17d43",
      "p": "on-failure",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    },
    {
      "s": "2878802a-a1f6-4c63-8374-16b4463562af",
      "p": "on-success",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    },
    {
      "s": "2878802a-a1f6-4c63-8374-16b4463562af",
      "p": "on-failure",
      "o": "4decec9c-3288-4d27-8328-5fc5a5b50014"
    },
    {
      "s": "4decec9c-3288-4d27-8328-5fc5a5b50014",
      "p": "on-success",
      "o": "4463fc42-0ba8-4b77-8d15-3d29e2c34d7c"
    },
    {
      "s": "4463fc42-0ba8-4b77-8d15-3d29e2c34d7c",
      "p": "on-failure",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    },
    {
      "s": "83ee24b4-7abc-49f4-97fc-db18dfd2d969",
      "p": "on-success",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    },
    {
      "s": "83ee24b4-7abc-49f4-97fc-db18dfd2d969",
      "p": "on-failure",
      "o": "0c8785ac-8e42-4b37-9d7b-f00c116191f0"
    },
    {
      "s": "0c8785ac-8e42-4b37-9d7b-f00c116191f0",
      "p": "on-success",
      "o": "a55e8659-7bd7-4084-9ecc-6d70bc684f9c"
    },
    {
      "s": "a55e8659-7bd7-4084-9ecc-6d70bc684f9c",
      "p": "on-failure",
      "o": "171d3caf-0694-448b-995a-661fa7073482"
    }
  ],
  "tags": [
    "T1003.002",
    "atomic-red-team"
  ]
}