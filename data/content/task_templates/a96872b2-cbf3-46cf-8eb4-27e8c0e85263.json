{
  "id": "a96872b2-cbf3-46cf-8eb4-27e8c0e85263",
  "name": "Registry parse with pypykatz",
  "description": "Parses registry hives to obtain stored credentials\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live registry\n",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "fad933b3-19e9-4a31-b9bb-9f95cdea188b",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "a848a675-0156-43c4-9bf8-46e0709ae201",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "199e82cc-6235-45fa-b8d0-27d572264b06",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "fe227fa6-904d-4fda-8405-26b0643eeced",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "f459f8d8-1de9-4f5f-a5a1-a48c4e719ef3",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "d764bec9-995c-458c-b91b-933fe21b2ee0",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "5ea9080f-ec2c-4410-83fd-2c0b02349e13",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "a235e499-5743-4047-8dfc-a6f5b9b049ec",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "5f94e214-22a8-4083-86bd-a2b21ab5c298",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "fad933b3-19e9-4a31-b9bb-9f95cdea188b",
      "p": "on-success",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    },
    {
      "s": "fad933b3-19e9-4a31-b9bb-9f95cdea188b",
      "p": "on-failure",
      "o": "a848a675-0156-43c4-9bf8-46e0709ae201"
    },
    {
      "s": "a848a675-0156-43c4-9bf8-46e0709ae201",
      "p": "on-success",
      "o": "199e82cc-6235-45fa-b8d0-27d572264b06"
    },
    {
      "s": "199e82cc-6235-45fa-b8d0-27d572264b06",
      "p": "on-failure",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    },
    {
      "s": "fe227fa6-904d-4fda-8405-26b0643eeced",
      "p": "on-success",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    },
    {
      "s": "fe227fa6-904d-4fda-8405-26b0643eeced",
      "p": "on-failure",
      "o": "f459f8d8-1de9-4f5f-a5a1-a48c4e719ef3"
    },
    {
      "s": "f459f8d8-1de9-4f5f-a5a1-a48c4e719ef3",
      "p": "on-success",
      "o": "d764bec9-995c-458c-b91b-933fe21b2ee0"
    },
    {
      "s": "d764bec9-995c-458c-b91b-933fe21b2ee0",
      "p": "on-failure",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    },
    {
      "s": "5ea9080f-ec2c-4410-83fd-2c0b02349e13",
      "p": "on-success",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    },
    {
      "s": "5ea9080f-ec2c-4410-83fd-2c0b02349e13",
      "p": "on-failure",
      "o": "a235e499-5743-4047-8dfc-a6f5b9b049ec"
    },
    {
      "s": "a235e499-5743-4047-8dfc-a6f5b9b049ec",
      "p": "on-success",
      "o": "5f94e214-22a8-4083-86bd-a2b21ab5c298"
    },
    {
      "s": "5f94e214-22a8-4083-86bd-a2b21ab5c298",
      "p": "on-failure",
      "o": "ca7f7f15-14fd-4de8-8b59-b0f2b12ef2cd"
    }
  ],
  "tags": [
    "T1003",
    "T1003.002"
  ]
}