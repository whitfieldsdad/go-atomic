{
  "id": "31dad7ad-2286-4c02-ae92-274418c85fec",
  "name": "Linux VM Check via Hardware",
  "description": "Identify virtual machine hardware. This technique is used by the Pupy RAT and other malware.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "3d9d1b11-6cc3-44d5-b26f-64fcab445b1d",
      "type": "execute-command",
      "data": {
        "command": "if [ -f /sys/class/dmi/id/bios_version ]; then cat /sys/class/dmi/id/bios_version | grep -i amazon; fi\nif [ -f /sys/class/dmi/id/product_name ]; then cat /sys/class/dmi/id/product_name | grep -i \"Droplet\\|HVM\\|VirtualBox\\|VMware\"; fi\nif [ -f /sys/class/dmi/id/product_name ]; then cat /sys/class/dmi/id/chassis_vendor | grep -i \"Xen\\|Bochs\\|QEMU\"; fi\nif [ -x \"$(command -v dmidecode)\" ]; then sudo dmidecode | grep -i \"microsoft\\|vmware\\|virtualbox\\|quemu\\|domu\"; fi\nif [ -f /proc/scsi/scsi ]; then cat /proc/scsi/scsi | grep -i \"vmware\\|vbox\"; fi\nif [ -f /proc/ide/hd0/model ]; then cat /proc/ide/hd0/model | grep -i \"vmware\\|vbox\\|qemu\\|virtual\"; fi\nif [ -x \"$(command -v lspci)\" ]; then sudo lspci | grep -i \"vmware\\|virtualbox\"; fi\nif [ -x \"$(command -v lscpu)\" ]; then sudo lscpu | grep -i \"Xen\\|KVM\\|Microsoft\"; fi\n",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1082",
    "atomic-red-team"
  ]
}