{
  "id": "85f3a526-4cfa-4fe7-98c1-dea99be025c7",
  "name": "Disable UAC - Switch to the secure desktop when prompting for elevation via registry key",
  "description": "User Account Control (UAC) is a security mechanism for limiting the elevation of privileges, including administrative accounts, unless authorized. \nThis setting ensures that the elevation prompt is only used in secure desktop mode.\nDisable User Account Conrol (UAC) for secure desktop by setting the registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop to 0.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "dd05ee33-8b60-4e67-b5bd-9a37ebf61044",
      "type": "execute-command",
      "data": {
        "command": "Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name PromptOnSecureDesktop -Value 0 -Type Dword -Force",
        "command_type": "powershell"
      },
      "elevation_required": true
    },
    {
      "id": "a24425e8-3dd8-4842-b362-79a511ad2134",
      "type": "execute-command",
      "data": {
        "command": "Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name PromptOnSecureDesktop -Value 1 -Type Dword -Force\n",
        "command_type": "powershell"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "dd05ee33-8b60-4e67-b5bd-9a37ebf61044",
      "p": "on-success",
      "o": "a24425e8-3dd8-4842-b362-79a511ad2134"
    },
    {
      "s": "dd05ee33-8b60-4e67-b5bd-9a37ebf61044",
      "p": "on-failure",
      "o": "a24425e8-3dd8-4842-b362-79a511ad2134"
    }
  ],
  "tags": [
    "T1548",
    "T1548.002"
  ]
}