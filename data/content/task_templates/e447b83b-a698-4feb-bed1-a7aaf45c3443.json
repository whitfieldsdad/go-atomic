{
  "id": "e447b83b-a698-4feb-bed1-a7aaf45c3443",
  "name": "PDQ Deploy RAT",
  "description": "An adversary may use PDQ Deploy Software to deploy the Remote Adminstartion Tool, this will start the PDQ console.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "28c51ac3-1dc5-43fe-93de-3acca475e0a8",
      "type": "execute-command",
      "data": {
        "command": "\"%PROGRAMFILES(x86)%/#{PDQ_Deploy_exe}\"\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "704f4b03-b907-4e65-a01f-c98794da0754",
      "name": "Check dependency 1/1",
      "description": "PDQ Deploy will be installed at specified location (#{PDQ_Deploy_exe})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"${env:ProgramFiles(x86)}/#{PDQ_Deploy_exe}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d1921d0a-fe54-454b-9fac-7a6c6752a9d8",
      "name": "Resolve dependency 1/1",
      "description": "PDQ Deploy will be installed at specified location (#{PDQ_Deploy_exe})\n",
      "type": "execute-command",
      "data": {
        "command": "Write-Host Downloading PDQ Deploy installer\nNew-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://download.pdq.com/release/19/Deploy_19.3.350.0.exe\" -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\#{PDQ_Deploy_installer}\"\nWrite-Host Install PDQ Deploy\nStart-Process \"PathToAtomicsFolder\\..\\ExternalPayloads\\#{PDQ_Deploy_installer}\" -Wait -ArgumentList \"/s\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "991eb58e-bd9f-4de6-953b-b761c224fc7c",
      "name": "Re-check dependency 1/1",
      "description": "PDQ Deploy will be installed at specified location (#{PDQ_Deploy_exe})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"${env:ProgramFiles(x86)}/#{PDQ_Deploy_exe}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "704f4b03-b907-4e65-a01f-c98794da0754",
      "p": "on-success",
      "o": "28c51ac3-1dc5-43fe-93de-3acca475e0a8"
    },
    {
      "s": "704f4b03-b907-4e65-a01f-c98794da0754",
      "p": "on-failure",
      "o": "d1921d0a-fe54-454b-9fac-7a6c6752a9d8"
    },
    {
      "s": "d1921d0a-fe54-454b-9fac-7a6c6752a9d8",
      "p": "on-success",
      "o": "991eb58e-bd9f-4de6-953b-b761c224fc7c"
    },
    {
      "s": "991eb58e-bd9f-4de6-953b-b761c224fc7c",
      "p": "on-failure",
      "o": "28c51ac3-1dc5-43fe-93de-3acca475e0a8"
    }
  ],
  "tags": [
    "T1072",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "PDQ_Deploy_installer",
      "type": "path",
      "description": "PDQ Deploy Install",
      "value": "PDQDeploysetup.exe"
    },
    {
      "name": "PDQ_Deploy_exe",
      "type": "path",
      "description": "The PDQDeployConsole.exe executable from PDQDeploysetup.exe",
      "value": "Admin Arsenal/PDQ Deploy/PDQDeployConsole.exe"
    }
  ]
}