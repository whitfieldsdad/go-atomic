{
  "id": "124e13e5-d8a1-4378-a6ee-a53cd0c7e369",
  "name": "Simulating Access to Chrome Login Data - MacOS",
  "description": "This test locates the Login Data files used by Chrome to store encrypted credentials, then copies them to the temp directory for later exfil. \nOnce the files are exfiltrated, malware like CookieMiner could be used to perform credential extraction. \nSee https://unit42.paloaltonetworks.com/mac-malware-steals-cryptocurrency-exchanges-cookies/ . \n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "2cd99eb0-ca99-4be4-becf-c4c14b3b407f",
      "type": "execute-command",
      "data": {
        "command": "cp ~/Library/\"Application Support/Google/Chrome/Default/Login Data\" \"/tmp/T1555.003_Login Data\"\ncp ~/Library/\"Application Support/Google/Chrome/Default/Login Data For Account\" \"/tmp/T1555.003_Login Data For Account\"\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "160435ab-96c9-4ace-97a6-3bf1a295ef2e",
      "type": "execute-command",
      "data": {
        "command": "rm \"/tmp/T1555.003_Login Data\" \u003e/dev/null 2\u003e\u00261\nrm \"/tmp/T1555.003_Login Data For Account\" \u003e/dev/null 2\u003e\u00261\n",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "2cd99eb0-ca99-4be4-becf-c4c14b3b407f",
      "p": "on-success",
      "o": "160435ab-96c9-4ace-97a6-3bf1a295ef2e"
    },
    {
      "s": "2cd99eb0-ca99-4be4-becf-c4c14b3b407f",
      "p": "on-failure",
      "o": "160435ab-96c9-4ace-97a6-3bf1a295ef2e"
    }
  ],
  "tags": [
    "T1555.003",
    "atomic-red-team"
  ]
}