{
  "id": "ac34b0f7-0f85-4ac0-b93e-3ced2bc69bb8",
  "name": "Disable Windows Registry Tool",
  "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows registry tool to prevent user modifying registry entry.\nSee example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "d4b9d128-47a9-4f33-89d3-1fa3e7b58c96",
      "type": "execute-command",
      "data": {
        "command": "reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\system /v DisableRegistryTools /t REG_DWORD /d 1 /f\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "2c6eaf06-57f5-4861-96a1-a7126842ce7b",
      "type": "execute-command",
      "data": {
        "command": "powershell Remove-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\system\" -Name DisableRegistryTools -ErrorAction Ignore\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "d4b9d128-47a9-4f33-89d3-1fa3e7b58c96",
      "p": "on-success",
      "o": "2c6eaf06-57f5-4861-96a1-a7126842ce7b"
    },
    {
      "s": "d4b9d128-47a9-4f33-89d3-1fa3e7b58c96",
      "p": "on-failure",
      "o": "2c6eaf06-57f5-4861-96a1-a7126842ce7b"
    }
  ],
  "tags": [
    "T1112",
    "atomic-red-team"
  ]
}