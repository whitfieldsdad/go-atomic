{
  "id": "28104f8a-4ff1-4582-bcf6-699dce156608",
  "name": "Bypass UAC using SilentCleanup task",
  "description": "Bypass UAC using SilentCleanup task on Windows 8-10 using bat file from https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/\n\nThere is an auto-elevated task called SilentCleanup located in %windir%\\system32\\cleanmgr.exe This can be abused to elevate any file with Administrator privileges without prompting UAC (even highest level).\n\nFor example, we can set the windir registry kye to: \"cmd /k REM \"\n\nAnd forcefully run SilentCleanup task:\n\nschtasks /run /tn \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I\n\nREM will tell it to ignore everything after %windir% and treat it just as a NOTE. Therefore just executing cmd with admin privs.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "28e2b5da-fda8-4f7d-8277-f9e3e220a8a6",
      "type": "execute-command",
      "data": {
        "command": "\"#{file_path}\"\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1548.002",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "file_path",
      "type": "string",
      "description": "Path to the bat file",
      "value": "PathToAtomicsFolder\\T1548.002\\src\\T1548.002.bat"
    }
  ]
}