{
  "id": "7a0895f0-84c1-4adf-8491-a21510b1d4c1",
  "name": "Packet Capture Linux socket AF_INET,SOCK_RAW,TCP with sudo",
  "description": "Captures packets with domain=AF_INET,type=SOCK_RAW,protocol=TCP for a few seconds.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "89d9ee04-d1a9-4a98-bece-56f47f1d69a5",
      "type": "execute-command",
      "data": {
        "command": "sudo #{program_path} -4 -p 6 -t 3\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "ca683e25-cca7-4dc4-8888-a2b8de39c9c8",
      "type": "execute-command",
      "data": {
        "command": "rm -f #{program_path}\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "7b0da11e-0d5c-4b59-9f1b-b126be527865",
      "name": "Check dependency 1/1",
      "description": "compile C program\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{program_path}\" ]; then exit 0; else exit 1; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "8b4cf9fb-3ccf-4980-87f0-651a431ab423",
      "name": "Resolve dependency 1/1",
      "description": "compile C program\n",
      "type": "execute-command",
      "data": {
        "command": "cc #{csource_path} -o #{program_path}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "2597d2ed-03cc-4dd8-ade4-83238e4638b5",
      "name": "Re-check dependency 1/1",
      "description": "compile C program\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{program_path}\" ]; then exit 0; else exit 1; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "89d9ee04-d1a9-4a98-bece-56f47f1d69a5",
      "p": "on-success",
      "o": "ca683e25-cca7-4dc4-8888-a2b8de39c9c8"
    },
    {
      "s": "89d9ee04-d1a9-4a98-bece-56f47f1d69a5",
      "p": "on-failure",
      "o": "ca683e25-cca7-4dc4-8888-a2b8de39c9c8"
    },
    {
      "s": "7b0da11e-0d5c-4b59-9f1b-b126be527865",
      "p": "on-success",
      "o": "89d9ee04-d1a9-4a98-bece-56f47f1d69a5"
    },
    {
      "s": "7b0da11e-0d5c-4b59-9f1b-b126be527865",
      "p": "on-failure",
      "o": "8b4cf9fb-3ccf-4980-87f0-651a431ab423"
    },
    {
      "s": "8b4cf9fb-3ccf-4980-87f0-651a431ab423",
      "p": "on-success",
      "o": "2597d2ed-03cc-4dd8-ade4-83238e4638b5"
    },
    {
      "s": "2597d2ed-03cc-4dd8-ade4-83238e4638b5",
      "p": "on-failure",
      "o": "89d9ee04-d1a9-4a98-bece-56f47f1d69a5"
    }
  ],
  "tags": [
    "T1040",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "csource_path",
      "type": "string",
      "description": "Path to C program source",
      "value": "PathToAtomicsFolder/T1040/src/linux_pcapdemo.c"
    },
    {
      "name": "program_path",
      "type": "string",
      "description": "Path to compiled C program",
      "value": "/tmp/t1040_linux_pcapdemo"
    }
  ]
}