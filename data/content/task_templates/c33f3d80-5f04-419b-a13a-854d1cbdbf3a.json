{
  "id": "c33f3d80-5f04-419b-a13a-854d1cbdbf3a",
  "name": "rc.common",
  "description": "Modify rc.common\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "a5cefa09-2103-4cc1-b4d6-d8f56254df24",
      "type": "execute-command",
      "data": {
        "command": "filename='/etc/rc.common';if [ ! -f $filename ];then sudo touch $filename;else sudo cp $filename /etc/rc.common.original;fi\nprintf '%s\\n' '#!/bin/bash' | sudo tee /etc/rc.common\necho \"python3 -c \\\"import os, base64;exec(base64.b64decode('aW1wb3J0IG9zCm9zLnBvcGVuKCdlY2hvIGF0b21pYyB0ZXN0IGZvciBtb2RpZnlpbmcgcmMuY29tbW9uID4gL3RtcC9UMTAzNy4wMDQucmMuY29tbW9uJykK'))\\\"\" | sudo tee -a /etc/rc.common\nprintf '%s\\n' 'exit 0' | sudo tee -a /etc/rc.common\nsudo chmod +x /etc/rc.common",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "9938376f-1d8b-4b3a-8f88-4fc23b48b0c4",
      "type": "execute-command",
      "data": {
        "command": "origfilename='/etc/rc.common.original';if [ ! -f $origfilename ];then sudo rm /etc/rc.common;else sudo cp $origfilename /etc/rc.common \u0026\u0026 sudo rm $origfilename;fi",
        "command_type": "bash"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "a5cefa09-2103-4cc1-b4d6-d8f56254df24",
      "p": "on-success",
      "o": "9938376f-1d8b-4b3a-8f88-4fc23b48b0c4"
    },
    {
      "s": "a5cefa09-2103-4cc1-b4d6-d8f56254df24",
      "p": "on-failure",
      "o": "9938376f-1d8b-4b3a-8f88-4fc23b48b0c4"
    }
  ],
  "tags": [
    "T1037",
    "T1037.004"
  ]
}