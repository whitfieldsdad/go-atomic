{
  "id": "0ad9ab92-c48c-4f08-9b20-9633277c4646",
  "name": "Headless Browser Accessing Mockbin",
  "description": "The following Atomic Red Team test leverages the Chrome headless browser to access a mockbin site. Create your own Mockbin.org site and replace the BIN in the inputs.\nThe default Mockbin ID forwards to google.com and you may view the details here https://mockbin.org/bin/f6b9a876-a826-4ac0-83b8-639d6ad516ec/view.\nReference: https://cert.gov.ua/article/5702579\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "52ae14fc-2d90-467c-933b-dd5ed6d48c91",
      "type": "execute-command",
      "data": {
        "command": "start \"\" #{browser} --headless --disable-gpu https://mockbin.org/bin/#{bin_id}",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "43522422-23af-41b6-9ff8-9b2c3f815742",
      "type": "execute-command",
      "data": {
        "command": "taskkill /im #{browser} /f",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "52ae14fc-2d90-467c-933b-dd5ed6d48c91",
      "p": "on-success",
      "o": "43522422-23af-41b6-9ff8-9b2c3f815742"
    },
    {
      "s": "52ae14fc-2d90-467c-933b-dd5ed6d48c91",
      "p": "on-failure",
      "o": "43522422-23af-41b6-9ff8-9b2c3f815742"
    }
  ],
  "tags": [
    "T1564",
    "T1564.003"
  ],
  "input_arguments": [
    {
      "name": "bin_id",
      "type": "string",
      "description": "Mockbin.org BIN ID",
      "value": "f6b9a876-a826-4ac0-83b8-639d6ad516ec"
    },
    {
      "name": "browser",
      "type": "string",
      "description": "Browser to use (msedge, chrome, firefox)",
      "value": "chrome"
    }
  ]
}