{
  "id": "0ad9ab92-c48c-4f08-9b20-9633277c4646",
  "name": "Headless Browser Accessing Mockbin",
  "description": "The following Atomic Red Team test leverages the Chrome headless browser to access a mockbin site. Create your own Mockbin.org site and replace the BIN in the inputs.\nThe default Mockbin ID forwards to google.com and you may view the details here https://mockbin.org/bin/f6b9a876-a826-4ac0-83b8-639d6ad516ec/view.\nReference: https://cert.gov.ua/article/5702579\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "7724b5c6-346e-4f9b-b31b-0ef8a2885793",
      "type": "execute-command",
      "data": {
        "command": "start \"\" #{browser} --headless --disable-gpu https://mockbin.org/bin/#{bin_id}",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "8246530e-332d-4a7c-bb44-da3e085512f6",
      "type": "execute-command",
      "data": {
        "command": "taskkill /im #{browser} /f",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "7724b5c6-346e-4f9b-b31b-0ef8a2885793",
      "p": "on-success",
      "o": "8246530e-332d-4a7c-bb44-da3e085512f6"
    },
    {
      "s": "7724b5c6-346e-4f9b-b31b-0ef8a2885793",
      "p": "on-failure",
      "o": "8246530e-332d-4a7c-bb44-da3e085512f6"
    }
  ],
  "tags": [
    "T1564",
    "T1564.003"
  ],
  "input_arguments": [
    {
      "name": "bin_id",
      "type": "string",
      "description": "Mockbin.org BIN ID",
      "value": "f6b9a876-a826-4ac0-83b8-639d6ad516ec"
    },
    {
      "name": "browser",
      "type": "string",
      "description": "Browser to use (msedge, chrome, firefox)",
      "value": "chrome"
    }
  ]
}