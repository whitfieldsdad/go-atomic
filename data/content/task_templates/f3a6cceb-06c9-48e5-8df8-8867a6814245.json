{
  "id": "f3a6cceb-06c9-48e5-8df8-8867a6814245",
  "name": "Change Powershell Execution Policy to Bypass",
  "description": "Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.\nThey can either specify it during the execution of the powershell script or change the registry value for it.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a505a66b-aa46-4c00-ad6e-2d1eb41204b1",
      "type": "execute-command",
      "data": {
        "command": "Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope LocalMachine",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "8a5d3ba7-bb75-431b-997c-1e3abd594657",
      "type": "execute-command",
      "data": {
        "command": "try { Set-ExecutionPolicy -ExecutionPolicy #{default_execution_policy} -Scope LocalMachine -Force } catch {}",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a505a66b-aa46-4c00-ad6e-2d1eb41204b1",
      "p": "on-success",
      "o": "8a5d3ba7-bb75-431b-997c-1e3abd594657"
    },
    {
      "s": "a505a66b-aa46-4c00-ad6e-2d1eb41204b1",
      "p": "on-failure",
      "o": "8a5d3ba7-bb75-431b-997c-1e3abd594657"
    }
  ],
  "tags": [
    "T1112"
  ],
  "input_arguments": [
    {
      "name": "default_execution_policy",
      "type": "string",
      "description": "Specify the default poweshell execution policy",
      "value": "Default"
    }
  ]
}