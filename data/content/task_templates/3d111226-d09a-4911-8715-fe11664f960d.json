{
  "id": "3d111226-d09a-4911-8715-fe11664f960d",
  "name": "Simulating access to Chrome Login Data",
  "description": "Simulates an adversary accessing encrypted credentials from Google Chrome Login database. \n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "c1211650-e7eb-448b-8a4d-f6ad229b0ef2",
      "type": "execute-command",
      "data": {
        "command": "Copy-Item \"$env:LOCALAPPDATA\\Google\\Chrome\\User Data\\Default\\Login Data\" -Destination \"PathToAtomicsFolder\\..\\ExternalPayloads\"\nCopy-Item \"$env:LOCALAPPDATA\\Google\\Chrome\\User Data\\Default\\Login Data For Account\" -Destination \"PathToAtomicsFolder\\..\\ExternalPayloads\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "33a8a29e-2879-4a8e-acdb-f382a9d3124a",
      "type": "execute-command",
      "data": {
        "command": "Remove-Item -Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\Login Data\" -Force -ErrorAction Ignore\nRemove-Item -Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\Login Data For Account\" -Force -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "7d79973a-f49e-4603-9e78-7c712fdee672",
      "name": "Check dependency 1/1",
      "description": "Chrome must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if ((Test-Path \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\") -Or (Test-Path \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) {exit 0} else {exit 1}",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "71e4e2d0-5137-4f6d-8b83-fd18c2106a5a",
      "name": "Resolve dependency 1/1",
      "description": "Chrome must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\n$installer = \"PathToAtomicsFolder\\..\\ExternalPayloads\\ChromeStandaloneSetup64.msi\"\nInvoke-WebRequest -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\ChromeStandaloneSetup64.msi\" https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi\nmsiexec /i $installer /qn\nStart-Process -FilePath \"chrome.exe\"\nStop-Process -Name \"chrome\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "759abd67-d829-40cb-866f-ac0f35e299a6",
      "name": "Re-check dependency 1/1",
      "description": "Chrome must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if ((Test-Path \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\") -Or (Test-Path \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) {exit 0} else {exit 1}",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "c1211650-e7eb-448b-8a4d-f6ad229b0ef2",
      "p": "on-success",
      "o": "33a8a29e-2879-4a8e-acdb-f382a9d3124a"
    },
    {
      "s": "c1211650-e7eb-448b-8a4d-f6ad229b0ef2",
      "p": "on-failure",
      "o": "33a8a29e-2879-4a8e-acdb-f382a9d3124a"
    },
    {
      "s": "7d79973a-f49e-4603-9e78-7c712fdee672",
      "p": "on-success",
      "o": "c1211650-e7eb-448b-8a4d-f6ad229b0ef2"
    },
    {
      "s": "7d79973a-f49e-4603-9e78-7c712fdee672",
      "p": "on-failure",
      "o": "71e4e2d0-5137-4f6d-8b83-fd18c2106a5a"
    },
    {
      "s": "71e4e2d0-5137-4f6d-8b83-fd18c2106a5a",
      "p": "on-success",
      "o": "759abd67-d829-40cb-866f-ac0f35e299a6"
    },
    {
      "s": "759abd67-d829-40cb-866f-ac0f35e299a6",
      "p": "on-failure",
      "o": "c1211650-e7eb-448b-8a4d-f6ad229b0ef2"
    }
  ],
  "tags": [
    "T1555.003",
    "atomic-red-team"
  ]
}