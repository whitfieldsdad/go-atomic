{
  "id": "c7a0bb71-70ce-4a53-b115-881f241b795b",
  "name": "using Quicktime Player",
  "description": "Use AppleScript to get Quicktime Player to record an audio file from the default microphone.\n\nShould create a non-empty m4a file with sound from the microphone.\n\n- requires Automation permissions but no additional microphone permissions\n- saves file in /tmp by default. Other locations likely to require more permissions.\n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "bebfdead-9537-43bb-9f2d-c026edae015c",
      "type": "execute-command",
      "data": {
        "command": "sh #{filename} #{audiofile} #{duration}\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "87725cec-bc84-4edf-901e-fca02b93bd52",
      "type": "execute-command",
      "data": {
        "command": "if test -w #{audiofile}; then\n  rm #{audiofile}\nfi\n",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "bebfdead-9537-43bb-9f2d-c026edae015c",
      "p": "on-success",
      "o": "87725cec-bc84-4edf-901e-fca02b93bd52"
    },
    {
      "s": "bebfdead-9537-43bb-9f2d-c026edae015c",
      "p": "on-failure",
      "o": "87725cec-bc84-4edf-901e-fca02b93bd52"
    }
  ],
  "tags": [
    "T1123",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "filename",
      "type": "path",
      "description": "Location of the script",
      "value": "PathToAtomicsFolder/T1123/src/T1123.sh"
    },
    {
      "name": "audiofile",
      "type": "path",
      "description": "Location of the recorded audio file",
      "value": "/tmp/T1123.m4a"
    },
    {
      "name": "duration",
      "type": "integer",
      "description": "Length of recording to make in seconds",
      "value": "5"
    }
  ]
}