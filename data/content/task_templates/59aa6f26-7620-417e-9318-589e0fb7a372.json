{
  "id": "59aa6f26-7620-417e-9318-589e0fb7a372",
  "name": "Deploy Docker container",
  "description": "Adversaries may deploy containers based on retrieved or built malicious images or from benign images that download and execute malicious payloads at runtime. They can do this using docker create and docker start commands. Kinsing \u0026 Doki was exploited using this technique. \n",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "af70c102-0dde-42d9-859e-159485b6436a",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1610 $PathtoAtomicsFolder/T1610/src/\ndocker run --name t1610_container --rm -itd t1610 bash /tmp/script.sh\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "68b72b9b-d5f7-4c7c-b31f-bc0a3c80a232",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1610_container\ndocker rmi -f t1610:latest \n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "38d75887-dfc3-4cb1-a5a4-120f29e93ffa",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d02e528b-47ee-4e90-a23a-eb3dea50e6ea",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0de2ddbc-a717-4e28-ae0d-39ed0c9cfb22",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "658b4c2c-00aa-4e5c-9d76-6528cc806718",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "c0cef358-c5ff-4082-831f-b524f61b652b",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "86fd02a6-e235-45e2-a8e0-93737e99084e",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "af70c102-0dde-42d9-859e-159485b6436a",
      "p": "on-success",
      "o": "68b72b9b-d5f7-4c7c-b31f-bc0a3c80a232"
    },
    {
      "s": "af70c102-0dde-42d9-859e-159485b6436a",
      "p": "on-failure",
      "o": "68b72b9b-d5f7-4c7c-b31f-bc0a3c80a232"
    },
    {
      "s": "38d75887-dfc3-4cb1-a5a4-120f29e93ffa",
      "p": "on-success",
      "o": "af70c102-0dde-42d9-859e-159485b6436a"
    },
    {
      "s": "38d75887-dfc3-4cb1-a5a4-120f29e93ffa",
      "p": "on-failure",
      "o": "d02e528b-47ee-4e90-a23a-eb3dea50e6ea"
    },
    {
      "s": "d02e528b-47ee-4e90-a23a-eb3dea50e6ea",
      "p": "on-success",
      "o": "0de2ddbc-a717-4e28-ae0d-39ed0c9cfb22"
    },
    {
      "s": "0de2ddbc-a717-4e28-ae0d-39ed0c9cfb22",
      "p": "on-failure",
      "o": "af70c102-0dde-42d9-859e-159485b6436a"
    },
    {
      "s": "658b4c2c-00aa-4e5c-9d76-6528cc806718",
      "p": "on-success",
      "o": "af70c102-0dde-42d9-859e-159485b6436a"
    },
    {
      "s": "658b4c2c-00aa-4e5c-9d76-6528cc806718",
      "p": "on-failure",
      "o": "c0cef358-c5ff-4082-831f-b524f61b652b"
    },
    {
      "s": "c0cef358-c5ff-4082-831f-b524f61b652b",
      "p": "on-success",
      "o": "86fd02a6-e235-45e2-a8e0-93737e99084e"
    },
    {
      "s": "86fd02a6-e235-45e2-a8e0-93737e99084e",
      "p": "on-failure",
      "o": "af70c102-0dde-42d9-859e-159485b6436a"
    }
  ],
  "tags": [
    "T1610",
    "atomic-red-team"
  ]
}