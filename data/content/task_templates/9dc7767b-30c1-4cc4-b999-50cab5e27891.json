{
  "id": "9dc7767b-30c1-4cc4-b999-50cab5e27891",
  "name": "SystemBC Malware-as-a-Service Registry",
  "description": "This Atomic will create a registry key called socks5_powershell for persistance access\nhttps://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a5796a04-1570-470b-a978-cc2c69da842c",
      "type": "execute-command",
      "data": {
        "command": "$RunKey = \"#{reg_key_path}\"\nSet-ItemProperty -Path $RunKey -Name \"socks5_powershell\" -Value \"#{reg_key_value}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "341210d8-5bec-474f-954e-bd58c63b6177",
      "type": "execute-command",
      "data": {
        "command": "Remove-ItemProperty -Path #{reg_key_path} -Name \"socks5_powershell\" -Force -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a5796a04-1570-470b-a978-cc2c69da842c",
      "p": "on-success",
      "o": "341210d8-5bec-474f-954e-bd58c63b6177"
    },
    {
      "s": "a5796a04-1570-470b-a978-cc2c69da842c",
      "p": "on-failure",
      "o": "341210d8-5bec-474f-954e-bd58c63b6177"
    }
  ],
  "tags": [
    "T1547.001",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "reg_key_value",
      "type": "path",
      "description": "Thing to Run",
      "value": "powershell.exe -windowstyle hidden -ExecutionPolicy Bypass -File"
    },
    {
      "name": "reg_key_path",
      "type": "path",
      "description": "Path to registry key to update",
      "value": "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
    }
  ]
}