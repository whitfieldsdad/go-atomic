{
  "id": "9dc7767b-30c1-4cc4-b999-50cab5e27891",
  "name": "SystemBC Malware-as-a-Service Registry",
  "description": "This Atomic will create a registry key called socks5_powershell for persistance access\nhttps://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "d690dfab-7a02-4493-800b-fbac6aed23d3",
      "type": "execute-command",
      "data": {
        "command": "$RunKey = \"#{reg_key_path}\"\nSet-ItemProperty -Path $RunKey -Name \"socks5_powershell\" -Value \"#{reg_key_value}\"",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "298e1b88-9405-4657-bc9f-6cc4914411c4",
      "type": "execute-command",
      "data": {
        "command": "Remove-ItemProperty -Path #{reg_key_path} -Name \"socks5_powershell\" -Force -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "d690dfab-7a02-4493-800b-fbac6aed23d3",
      "p": "on-success",
      "o": "298e1b88-9405-4657-bc9f-6cc4914411c4"
    },
    {
      "s": "d690dfab-7a02-4493-800b-fbac6aed23d3",
      "p": "on-failure",
      "o": "298e1b88-9405-4657-bc9f-6cc4914411c4"
    }
  ],
  "tags": [
    "T1547",
    "T1547.001"
  ],
  "input_arguments": [
    {
      "name": "reg_key_value",
      "type": "path",
      "description": "Thing to Run",
      "value": "powershell.exe -windowstyle hidden -ExecutionPolicy Bypass -File"
    },
    {
      "name": "reg_key_path",
      "type": "path",
      "description": "Path to registry key to update",
      "value": "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
    }
  ]
}