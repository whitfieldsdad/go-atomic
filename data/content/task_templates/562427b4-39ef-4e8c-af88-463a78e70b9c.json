{
  "id": "562427b4-39ef-4e8c-af88-463a78e70b9c",
  "name": "Process Hollowing using PowerShell",
  "description": "This test uses PowerShell to create a Hollow from a PE on disk with explorer as the parent.\nCredit to FuzzySecurity (https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Start-Hollow.ps1)\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "8404c860-3864-4b3f-993e-9815384081b4",
      "type": "execute-command",
      "data": {
        "command": ". \"$PathToAtomicsFolder\\T1055.012\\src\\Start-Hollow.ps1\"\n$ppid=Get-Process #{parent_process_name} | select -expand id\nStart-Hollow -Sponsor \"#{sponsor_binary_path}\" -Hollow \"#{hollow_binary_path}\" -ParentPID $ppid -Verbose\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "1a0491f9-1053-4e8f-8546-74a14596db95",
      "type": "execute-command",
      "data": {
        "command": "Stop-Process -Name \"#{spawnto_process_name}\" -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "8404c860-3864-4b3f-993e-9815384081b4",
      "p": "on-success",
      "o": "1a0491f9-1053-4e8f-8546-74a14596db95"
    },
    {
      "s": "8404c860-3864-4b3f-993e-9815384081b4",
      "p": "on-failure",
      "o": "1a0491f9-1053-4e8f-8546-74a14596db95"
    }
  ],
  "tags": [
    "T1055.012",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "hollow_binary_path",
      "type": "string",
      "description": "Path of the binary to hollow (executable that will run inside the sponsor)",
      "value": "C:\\Windows\\System32\\cmd.exe"
    },
    {
      "name": "parent_process_name",
      "type": "string",
      "description": "Name of the parent process",
      "value": "explorer"
    },
    {
      "name": "sponsor_binary_path",
      "type": "string",
      "description": "Path of the sponsor binary (executable that will host the binary)",
      "value": "C:\\Windows\\System32\\notepad.exe"
    },
    {
      "name": "spawnto_process_name",
      "type": "string",
      "description": "Name of the process to spawn",
      "value": "notepad"
    }
  ]
}