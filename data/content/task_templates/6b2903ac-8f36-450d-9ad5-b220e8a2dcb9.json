{
  "id": "6b2903ac-8f36-450d-9ad5-b220e8a2dcb9",
  "name": "Simulate BlackByte Ransomware Print Bombing",
  "description": "This test attempts to open a file a specified number of times in Wordpad, then prints the contents. \nIt is designed to mimic BlackByte ransomware's print bombing technique, where tree.dll, which contains the ransom note, is opened in Wordpad 75 times and then printed. \nSee https://redcanary.com/blog/blackbyte-ransomware/. \n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "02de4e00-e0d6-493e-a690-145c7e3a3fc5",
      "type": "execute-command",
      "data": {
        "command": "cmd /c \"for /l %x in (1,1,#{max_to_print}) do start wordpad.exe /p #{file_to_print}\" | out-null\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "2d57b924-8a3c-46ff-8d02-8f1c840a8519",
      "type": "execute-command",
      "data": {
        "command": "stop-process -name wordpad -force -erroraction silentlycontinue\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "778636eb-d13d-4de9-8aa6-7b01ac72f6c0",
      "name": "Check dependency 1/1",
      "description": "File to print must exist on disk at specified location (#{file_to_print})\n",
      "type": "execute-command",
      "data": {
        "command": "if (test-path \"#{file_to_print}\"){exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "09ef095d-edf7-4c46-8804-580e6acc5686",
      "name": "Resolve dependency 1/1",
      "description": "File to print must exist on disk at specified location (#{file_to_print})\n",
      "type": "execute-command",
      "data": {
        "command": "new-item \"#{file_to_print}\" -value \"This file has been created by T1059.003 Test 4\" -Force | Out-Null\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d1566fd5-2b04-4a94-b026-0d3218a8629f",
      "name": "Re-check dependency 1/1",
      "description": "File to print must exist on disk at specified location (#{file_to_print})\n",
      "type": "execute-command",
      "data": {
        "command": "if (test-path \"#{file_to_print}\"){exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "02de4e00-e0d6-493e-a690-145c7e3a3fc5",
      "p": "on-success",
      "o": "2d57b924-8a3c-46ff-8d02-8f1c840a8519"
    },
    {
      "s": "02de4e00-e0d6-493e-a690-145c7e3a3fc5",
      "p": "on-failure",
      "o": "2d57b924-8a3c-46ff-8d02-8f1c840a8519"
    },
    {
      "s": "778636eb-d13d-4de9-8aa6-7b01ac72f6c0",
      "p": "on-success",
      "o": "02de4e00-e0d6-493e-a690-145c7e3a3fc5"
    },
    {
      "s": "778636eb-d13d-4de9-8aa6-7b01ac72f6c0",
      "p": "on-failure",
      "o": "09ef095d-edf7-4c46-8804-580e6acc5686"
    },
    {
      "s": "09ef095d-edf7-4c46-8804-580e6acc5686",
      "p": "on-success",
      "o": "d1566fd5-2b04-4a94-b026-0d3218a8629f"
    },
    {
      "s": "d1566fd5-2b04-4a94-b026-0d3218a8629f",
      "p": "on-failure",
      "o": "02de4e00-e0d6-493e-a690-145c7e3a3fc5"
    }
  ],
  "tags": [
    "T1059.003",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "file_to_print",
      "type": "string",
      "description": "File to be opened/printed by Wordpad.",
      "value": "PathToAtomicsFolder\\..\\ExternalPayloads\\T1059_003note.txt"
    },
    {
      "name": "max_to_print",
      "type": "integer",
      "description": "The maximum number of Wordpad windows the test will open/print.",
      "value": "75"
    }
  ]
}