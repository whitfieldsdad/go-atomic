{
  "id": "fa050f5e-bc75-4230-af73-b6fd7852cd73",
  "name": "PowerShell Fileless Script Execution",
  "description": "Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open \"C:\\Windows\\Temp\" and verify that\nart-marker.txt is in the folder.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "5e7bb670-2dc7-4116-83bd-aeb22de462ca",
      "type": "execute-command",
      "data": {
        "command": "# Encoded payload in next command is the following \"Set-Content -path \"$env:SystemRoot/Temp/art-marker.txt\" -value \"Hello from the Atomic Red Team\"\"\nreg.exe add \"HKEY_CURRENT_USER\\Software\\Classes\\AtomicRedTeam\" /v ART /t REG_SZ /d \"U2V0LUNvbnRlbnQgLXBhdGggIiRlbnY6U3lzdGVtUm9vdC9UZW1wL2FydC1tYXJrZXIudHh0IiAtdmFsdWUgIkhlbGxvIGZyb20gdGhlIEF0b21pYyBSZWQgVGVhbSI=\" /f\niex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String((gp 'HKCU:\\Software\\Classes\\AtomicRedTeam').ART)))\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "af0962a3-0b45-4ca6-8cb2-efbb569f64e9",
      "type": "execute-command",
      "data": {
        "command": "Remove-Item -path C:\\Windows\\Temp\\art-marker.txt -Force -ErrorAction Ignore\nRemove-Item HKCU:\\Software\\Classes\\AtomicRedTeam -Force -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "5e7bb670-2dc7-4116-83bd-aeb22de462ca",
      "p": "on-success",
      "o": "af0962a3-0b45-4ca6-8cb2-efbb569f64e9"
    },
    {
      "s": "5e7bb670-2dc7-4116-83bd-aeb22de462ca",
      "p": "on-failure",
      "o": "af0962a3-0b45-4ca6-8cb2-efbb569f64e9"
    }
  ],
  "tags": [
    "T1059.001",
    "atomic-red-team"
  ]
}