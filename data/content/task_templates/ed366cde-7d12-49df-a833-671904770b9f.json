{
  "id": "ed366cde-7d12-49df-a833-671904770b9f",
  "name": "Modify Fax service to run PowerShell",
  "description": "This test will temporarily modify the service Fax by changing the binPath to PowerShell\nand will then revert the binPath change, restoring Fax to its original state.\nUpon successful execution, cmd will modify the binpath for `Fax` to spawn powershell. Powershell will then spawn.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "0168b6e7-74a1-4ff8-90f6-650d0b061265",
      "type": "execute-command",
      "data": {
        "command": "sc config Fax binPath= \"C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -noexit -c \\\"write-host 'T1543.003 Test'\\\"\"\nsc start Fax\n",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "3e4167c7-d8c5-4c9b-bd2f-18c3914c1aee",
      "type": "execute-command",
      "data": {
        "command": "sc config Fax binPath= \"C:\\WINDOWS\\system32\\fxssvc.exe\" \u003enul 2\u003e\u00261",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "0168b6e7-74a1-4ff8-90f6-650d0b061265",
      "p": "on-success",
      "o": "3e4167c7-d8c5-4c9b-bd2f-18c3914c1aee"
    },
    {
      "s": "0168b6e7-74a1-4ff8-90f6-650d0b061265",
      "p": "on-failure",
      "o": "3e4167c7-d8c5-4c9b-bd2f-18c3914c1aee"
    }
  ],
  "tags": [
    "T1543",
    "T1543.003"
  ]
}