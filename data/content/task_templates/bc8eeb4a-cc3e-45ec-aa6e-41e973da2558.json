{
  "id": "bc8eeb4a-cc3e-45ec-aa6e-41e973da2558",
  "name": "System log file deletion via find utility",
  "description": "This test finds and deletes the system log files within /var/log/ directory using various executions(rm, shred, unlink)\n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "23d34510-2cfd-46a1-9ca3-76844dce3b83",
      "type": "execute-command",
      "data": {
        "command": "sudo find /var/log -name '#{system_log_name1}.*' -exec rm {} \\; #using \"rm\" execution\nsudo find /var/log/ -name \"#{system_log_name2}.*\" -exec shred -u -z -n 3 {} \\; #using \"shred\" execution\nsudo find /var/log/ -name \"#{system_log_name3}.*\" -exec unlink {} \\; #using \"unlink\" execution\n",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "e4a4877e-533f-46d1-9453-4a8fb10dcc5c",
      "name": "Check dependency 1/1",
      "description": "target files must exist\n",
      "type": "execute-command",
      "data": {
        "command": "stat /var/log/#{system_log_name1} /var/log/#{system_log_name2} /var/log/#{system_log_name3}\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "f9168c6f-fff5-4533-845f-3e3a03ebb7d9",
      "name": "Resolve dependency 1/1",
      "description": "target files must exist\n",
      "type": "execute-command",
      "data": {
        "command": "touch /var/log/#{system_log_name1} /var/log/#{system_log_name2} /var/log/#{system_log_name3}\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "af2648ba-4f7c-44da-9505-7b111a6b8a05",
      "name": "Re-check dependency 1/1",
      "description": "target files must exist\n",
      "type": "execute-command",
      "data": {
        "command": "stat /var/log/#{system_log_name1} /var/log/#{system_log_name2} /var/log/#{system_log_name3}\n",
        "command_type": ""
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "e4a4877e-533f-46d1-9453-4a8fb10dcc5c",
      "p": "on-success",
      "o": "23d34510-2cfd-46a1-9ca3-76844dce3b83"
    },
    {
      "s": "e4a4877e-533f-46d1-9453-4a8fb10dcc5c",
      "p": "on-failure",
      "o": "f9168c6f-fff5-4533-845f-3e3a03ebb7d9"
    },
    {
      "s": "f9168c6f-fff5-4533-845f-3e3a03ebb7d9",
      "p": "on-success",
      "o": "af2648ba-4f7c-44da-9505-7b111a6b8a05"
    },
    {
      "s": "af2648ba-4f7c-44da-9505-7b111a6b8a05",
      "p": "on-failure",
      "o": "23d34510-2cfd-46a1-9ca3-76844dce3b83"
    }
  ],
  "tags": [
    "T1070",
    "T1070.002"
  ],
  "input_arguments": [
    {
      "name": "system_log_name2",
      "type": "string",
      "description": "name or prefix of system log to delete.",
      "value": "system.log.97.gz"
    },
    {
      "name": "system_log_name3",
      "type": "string",
      "description": "name or prefix of system log to delete.",
      "value": "system.log.98.gz"
    },
    {
      "name": "system_log_name1",
      "type": "string",
      "description": "name or prefix of system log to delete.",
      "value": "system.log"
    }
  ]
}