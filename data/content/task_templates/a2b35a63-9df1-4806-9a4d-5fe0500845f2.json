{
  "id": "a2b35a63-9df1-4806-9a4d-5fe0500845f2",
  "name": "LinEnum tool execution",
  "description": "LinEnum is a bash script that performs discovery commands for accounts,processes, kernel version, applications, services, and uses the information from these commands to present operator with ways of escalating privileges or further exploitation of targeted host.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "f0b8a504-6a9b-4339-a7be-ff39623eaf42",
      "type": "execute-command",
      "data": {
        "command": "chmod +x #{linenum}\nbash #{linenum}\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "d16683eb-b611-41bb-a8e2-b6b33762e76d",
      "type": "execute-command",
      "data": {
        "command": "rm -rf #{linenum}\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "50387678-c2c0-403e-adf2-e65bcabe94cd",
      "name": "Check dependency 1/1",
      "description": "LinnEnum must exist on disk at specified location (#{linenum})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f #{linenum} ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "566090bf-f253-415d-a199-f0f311f4814f",
      "name": "Resolve dependency 1/1",
      "description": "LinnEnum must exist on disk at specified location (#{linenum})\n",
      "type": "execute-command",
      "data": {
        "command": "curl --create-dirs #{linenum_url} --output #{linenum}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b569e151-da89-424d-a5d8-604e426c002e",
      "name": "Re-check dependency 1/1",
      "description": "LinnEnum must exist on disk at specified location (#{linenum})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f #{linenum} ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f0b8a504-6a9b-4339-a7be-ff39623eaf42",
      "p": "on-success",
      "o": "d16683eb-b611-41bb-a8e2-b6b33762e76d"
    },
    {
      "s": "f0b8a504-6a9b-4339-a7be-ff39623eaf42",
      "p": "on-failure",
      "o": "d16683eb-b611-41bb-a8e2-b6b33762e76d"
    },
    {
      "s": "50387678-c2c0-403e-adf2-e65bcabe94cd",
      "p": "on-success",
      "o": "f0b8a504-6a9b-4339-a7be-ff39623eaf42"
    },
    {
      "s": "50387678-c2c0-403e-adf2-e65bcabe94cd",
      "p": "on-failure",
      "o": "566090bf-f253-415d-a199-f0f311f4814f"
    },
    {
      "s": "566090bf-f253-415d-a199-f0f311f4814f",
      "p": "on-success",
      "o": "b569e151-da89-424d-a5d8-604e426c002e"
    },
    {
      "s": "b569e151-da89-424d-a5d8-604e426c002e",
      "p": "on-failure",
      "o": "f0b8a504-6a9b-4339-a7be-ff39623eaf42"
    }
  ],
  "tags": [
    "T1059.004",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "linenum_url",
      "type": "url",
      "description": "Path to download LinEnum shell script",
      "value": "https://raw.githubusercontent.com/rebootuser/LinEnum/c47f9b226d3ce2848629f25fe142c1b2986bc427/LinEnum.sh"
    },
    {
      "name": "linenum",
      "type": "path",
      "description": "Path to the LinEnum shell script",
      "value": "PathToAtomicsFolder/T1059.004/src/LinEnum.sh"
    }
  ]
}