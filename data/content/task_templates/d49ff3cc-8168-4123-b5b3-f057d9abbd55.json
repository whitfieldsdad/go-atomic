{
  "id": "d49ff3cc-8168-4123-b5b3-f057d9abbd55",
  "name": "Activate Windows NoRun Group Policy Feature",
  "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Remove Run menu from Start Menu Group Policy.\nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "f3b5aaa5-03a6-4e90-857a-c6bc45a6ecf0",
      "type": "execute-command",
      "data": {
        "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoRun /t REG_DWORD /d 1 /f",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    },
    {
      "id": "7ca16033-bc0f-4c36-a8c7-be4107c596c6",
      "type": "execute-command",
      "data": {
        "command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoRun /f",
        "command_type": "command_prompt"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "f3b5aaa5-03a6-4e90-857a-c6bc45a6ecf0",
      "p": "on-success",
      "o": "7ca16033-bc0f-4c36-a8c7-be4107c596c6"
    },
    {
      "s": "f3b5aaa5-03a6-4e90-857a-c6bc45a6ecf0",
      "p": "on-failure",
      "o": "7ca16033-bc0f-4c36-a8c7-be4107c596c6"
    }
  ],
  "tags": [
    "T1112"
  ]
}