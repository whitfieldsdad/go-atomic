{
  "id": "8a895923-f99f-4668-acf2-6cc59a44f05e",
  "name": "Container and ResourceDiscovery",
  "description": "Adversaries may attempt to discover containers and other resources that are available within a containers environment.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "113a0b27-0607-4d9e-8675-5a51e44aab8f",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1613  $PathtoAtomicsFolder/T1613/src/\ndocker run --name t1613_container  -d -t t1613\ndocker ps\ndocker stats --no-stream\ndocker inspect $(docker ps -l -q --filter ancestor=t1613)",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "997f17f6-c901-4f6d-b510-e55dca2d778b",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1613_container\ndocker rmi -f t1613_container",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "08fee0e7-7882-4771-a6b1-9aa4b49b67c2",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "57a58b5f-4d8f-4a6e-9049-8ca72c865d0e",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "8d2f86f0-24a0-4d7d-8993-0cf33c9560b2",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "fd04f4e0-fc72-4778-8527-b635c5e1ebd2",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "210b2a76-a52c-4377-b4b1-c989f212628f",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "537fff99-632f-46b3-b898-89b254aa73f6",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "113a0b27-0607-4d9e-8675-5a51e44aab8f",
      "p": "on-success",
      "o": "997f17f6-c901-4f6d-b510-e55dca2d778b"
    },
    {
      "s": "113a0b27-0607-4d9e-8675-5a51e44aab8f",
      "p": "on-failure",
      "o": "997f17f6-c901-4f6d-b510-e55dca2d778b"
    },
    {
      "s": "08fee0e7-7882-4771-a6b1-9aa4b49b67c2",
      "p": "on-success",
      "o": "113a0b27-0607-4d9e-8675-5a51e44aab8f"
    },
    {
      "s": "08fee0e7-7882-4771-a6b1-9aa4b49b67c2",
      "p": "on-failure",
      "o": "57a58b5f-4d8f-4a6e-9049-8ca72c865d0e"
    },
    {
      "s": "57a58b5f-4d8f-4a6e-9049-8ca72c865d0e",
      "p": "on-success",
      "o": "8d2f86f0-24a0-4d7d-8993-0cf33c9560b2"
    },
    {
      "s": "8d2f86f0-24a0-4d7d-8993-0cf33c9560b2",
      "p": "on-failure",
      "o": "113a0b27-0607-4d9e-8675-5a51e44aab8f"
    },
    {
      "s": "fd04f4e0-fc72-4778-8527-b635c5e1ebd2",
      "p": "on-success",
      "o": "113a0b27-0607-4d9e-8675-5a51e44aab8f"
    },
    {
      "s": "fd04f4e0-fc72-4778-8527-b635c5e1ebd2",
      "p": "on-failure",
      "o": "210b2a76-a52c-4377-b4b1-c989f212628f"
    },
    {
      "s": "210b2a76-a52c-4377-b4b1-c989f212628f",
      "p": "on-success",
      "o": "537fff99-632f-46b3-b898-89b254aa73f6"
    },
    {
      "s": "537fff99-632f-46b3-b898-89b254aa73f6",
      "p": "on-failure",
      "o": "113a0b27-0607-4d9e-8675-5a51e44aab8f"
    }
  ],
  "tags": [
    "T1613"
  ]
}