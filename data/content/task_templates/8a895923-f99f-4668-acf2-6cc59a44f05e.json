{
  "id": "8a895923-f99f-4668-acf2-6cc59a44f05e",
  "name": "Container and ResourceDiscovery",
  "description": "Adversaries may attempt to discover containers and other resources that are available within a containers environment.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1613  $PathtoAtomicsFolder/T1613/src/\ndocker run --name t1613_container  -d -t t1613\ndocker ps\ndocker stats --no-stream\ndocker inspect $(docker ps -l -q --filter ancestor=t1613)",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "fea1afe0-e981-42bd-9517-85cf74203b8a",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1613_container\ndocker rmi -f t1613_container",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "989a6d61-8a1b-4457-a3d7-78355cca270f",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d40f9205-3b6c-438c-843a-988e99b8ec69",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b30b7fe9-90d8-4737-b9b3-338e9a3c786c",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0e5c0b30-3b46-4132-9d5a-7497301b21f5",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b850a5e7-63bf-4f26-80de-2652ae83df0d",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "a809d7ea-152c-4248-a75f-5e6fbfc93318",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a",
      "p": "on-success",
      "o": "fea1afe0-e981-42bd-9517-85cf74203b8a"
    },
    {
      "s": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a",
      "p": "on-failure",
      "o": "fea1afe0-e981-42bd-9517-85cf74203b8a"
    },
    {
      "s": "989a6d61-8a1b-4457-a3d7-78355cca270f",
      "p": "on-success",
      "o": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a"
    },
    {
      "s": "989a6d61-8a1b-4457-a3d7-78355cca270f",
      "p": "on-failure",
      "o": "d40f9205-3b6c-438c-843a-988e99b8ec69"
    },
    {
      "s": "d40f9205-3b6c-438c-843a-988e99b8ec69",
      "p": "on-success",
      "o": "b30b7fe9-90d8-4737-b9b3-338e9a3c786c"
    },
    {
      "s": "b30b7fe9-90d8-4737-b9b3-338e9a3c786c",
      "p": "on-failure",
      "o": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a"
    },
    {
      "s": "0e5c0b30-3b46-4132-9d5a-7497301b21f5",
      "p": "on-success",
      "o": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a"
    },
    {
      "s": "0e5c0b30-3b46-4132-9d5a-7497301b21f5",
      "p": "on-failure",
      "o": "b850a5e7-63bf-4f26-80de-2652ae83df0d"
    },
    {
      "s": "b850a5e7-63bf-4f26-80de-2652ae83df0d",
      "p": "on-success",
      "o": "a809d7ea-152c-4248-a75f-5e6fbfc93318"
    },
    {
      "s": "a809d7ea-152c-4248-a75f-5e6fbfc93318",
      "p": "on-failure",
      "o": "f6c276b3-bfd9-4eee-880c-dda1d7a67a9a"
    }
  ],
  "tags": [
    "T1613",
    "atomic-red-team"
  ]
}