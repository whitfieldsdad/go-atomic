{
  "id": "8a895923-f99f-4668-acf2-6cc59a44f05e",
  "name": "Container and ResourceDiscovery",
  "description": "Adversaries may attempt to discover containers and other resources that are available within a containers environment.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "f15f77ae-c830-4362-87be-e14ba3381edf",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1613  $PathtoAtomicsFolder/T1613/src/\ndocker run --name t1613_container  -d -t t1613\ndocker ps\ndocker stats --no-stream\ndocker inspect $(docker ps -l -q --filter ancestor=t1613)",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "eff175be-2757-4d37-ade9-918ae6999849",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1613_container\ndocker rmi -f t1613_container",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "79a0648b-f073-4bca-963d-fda7e367eba4",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "05f931f9-901e-4a1e-917d-96f60bf0e7ae",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "30105062-1fbc-4998-bd3d-5c88fedb2586",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "cdfb3ae6-51f8-4530-b99b-fb61284b9f4f",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "32e9ca0f-cd68-4d0d-8eb3-5ed52e6649a3",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "817d6c7b-14a0-4a13-8433-eafd281ea2b9",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f15f77ae-c830-4362-87be-e14ba3381edf",
      "p": "on-success",
      "o": "eff175be-2757-4d37-ade9-918ae6999849"
    },
    {
      "s": "f15f77ae-c830-4362-87be-e14ba3381edf",
      "p": "on-failure",
      "o": "eff175be-2757-4d37-ade9-918ae6999849"
    },
    {
      "s": "79a0648b-f073-4bca-963d-fda7e367eba4",
      "p": "on-success",
      "o": "f15f77ae-c830-4362-87be-e14ba3381edf"
    },
    {
      "s": "79a0648b-f073-4bca-963d-fda7e367eba4",
      "p": "on-failure",
      "o": "05f931f9-901e-4a1e-917d-96f60bf0e7ae"
    },
    {
      "s": "05f931f9-901e-4a1e-917d-96f60bf0e7ae",
      "p": "on-success",
      "o": "30105062-1fbc-4998-bd3d-5c88fedb2586"
    },
    {
      "s": "30105062-1fbc-4998-bd3d-5c88fedb2586",
      "p": "on-failure",
      "o": "f15f77ae-c830-4362-87be-e14ba3381edf"
    },
    {
      "s": "cdfb3ae6-51f8-4530-b99b-fb61284b9f4f",
      "p": "on-success",
      "o": "f15f77ae-c830-4362-87be-e14ba3381edf"
    },
    {
      "s": "cdfb3ae6-51f8-4530-b99b-fb61284b9f4f",
      "p": "on-failure",
      "o": "32e9ca0f-cd68-4d0d-8eb3-5ed52e6649a3"
    },
    {
      "s": "32e9ca0f-cd68-4d0d-8eb3-5ed52e6649a3",
      "p": "on-success",
      "o": "817d6c7b-14a0-4a13-8433-eafd281ea2b9"
    },
    {
      "s": "817d6c7b-14a0-4a13-8433-eafd281ea2b9",
      "p": "on-failure",
      "o": "f15f77ae-c830-4362-87be-e14ba3381edf"
    }
  ],
  "tags": [
    "T1613"
  ]
}