{
  "id": "8a895923-f99f-4668-acf2-6cc59a44f05e",
  "name": "Container and ResourceDiscovery",
  "description": "Adversaries may attempt to discover containers and other resources that are available within a containers environment.",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "ba22c917-f573-436b-a9f8-b98afcfa69bb",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1613  $PathtoAtomicsFolder/T1613/src/\ndocker run --name t1613_container  -d -t t1613\ndocker ps\ndocker stats --no-stream\ndocker inspect $(docker ps -l -q --filter ancestor=t1613)",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "c5d92e67-8371-4d45-9161-9596a966d4ef",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1613_container\ndocker rmi -f t1613_container",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "7aa9ae00-07c1-44a4-8bca-5c8f0f9e5cbb",
      "name": "Check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "2c75bd6e-3461-41b6-b5f8-bf4769e5b17a",
      "name": "Resolve dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "258b6f70-6821-4c9a-85e0-10b95c19c78d",
      "name": "Re-check dependency 1/2",
      "description": "Verify docker is installed.",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "bd851262-ed16-4270-86d7-a3b0ad9e2471",
      "name": "Check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "6de1716f-b2b4-4186-9f00-d16f1799684e",
      "name": "Resolve dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl start docker",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "51ed8661-f33b-4b1f-83c3-36fbbb8aa18b",
      "name": "Re-check dependency 2/2",
      "description": "Verify docker service is running.",
      "type": "execute-command",
      "data": {
        "command": "sudo systemctl status docker  --no-pager",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "ba22c917-f573-436b-a9f8-b98afcfa69bb",
      "p": "on-success",
      "o": "c5d92e67-8371-4d45-9161-9596a966d4ef"
    },
    {
      "s": "ba22c917-f573-436b-a9f8-b98afcfa69bb",
      "p": "on-failure",
      "o": "c5d92e67-8371-4d45-9161-9596a966d4ef"
    },
    {
      "s": "7aa9ae00-07c1-44a4-8bca-5c8f0f9e5cbb",
      "p": "on-success",
      "o": "ba22c917-f573-436b-a9f8-b98afcfa69bb"
    },
    {
      "s": "7aa9ae00-07c1-44a4-8bca-5c8f0f9e5cbb",
      "p": "on-failure",
      "o": "2c75bd6e-3461-41b6-b5f8-bf4769e5b17a"
    },
    {
      "s": "2c75bd6e-3461-41b6-b5f8-bf4769e5b17a",
      "p": "on-success",
      "o": "258b6f70-6821-4c9a-85e0-10b95c19c78d"
    },
    {
      "s": "258b6f70-6821-4c9a-85e0-10b95c19c78d",
      "p": "on-failure",
      "o": "ba22c917-f573-436b-a9f8-b98afcfa69bb"
    },
    {
      "s": "bd851262-ed16-4270-86d7-a3b0ad9e2471",
      "p": "on-success",
      "o": "ba22c917-f573-436b-a9f8-b98afcfa69bb"
    },
    {
      "s": "bd851262-ed16-4270-86d7-a3b0ad9e2471",
      "p": "on-failure",
      "o": "6de1716f-b2b4-4186-9f00-d16f1799684e"
    },
    {
      "s": "6de1716f-b2b4-4186-9f00-d16f1799684e",
      "p": "on-success",
      "o": "51ed8661-f33b-4b1f-83c3-36fbbb8aa18b"
    },
    {
      "s": "51ed8661-f33b-4b1f-83c3-36fbbb8aa18b",
      "p": "on-failure",
      "o": "ba22c917-f573-436b-a9f8-b98afcfa69bb"
    }
  ],
  "tags": [
    "T1613"
  ],
  "input_arguments": null
}