{
  "id": "2cb98256-625e-4da9-9d44-f2e5f90b8bd5",
  "name": "Suspicious vbs file run from startup Folder",
  "description": "vbs files can be placed in and ran from the startup folder to maintain persistance. Upon execution, \"T1547.001 Hello, World VBS!\" will be displayed twice. \nAdditionally, the new files can be viewed in the \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nfolder and will also run when the computer is restarted and the user logs in.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a9006243-8fec-409b-94c8-9e6d738b59b4",
      "type": "execute-command",
      "data": {
        "command": "Copy-Item \"$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup.vbs\" \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs\"\nCopy-Item \"$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup.vbs\" \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs\"\ncscript.exe \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs\"\ncscript.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "595d51f3-1265-4c7e-860d-d3a3981a7578",
      "type": "execute-command",
      "data": {
        "command": "Remove-Item \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs\" -ErrorAction Ignore\nRemove-Item \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs\" -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a9006243-8fec-409b-94c8-9e6d738b59b4",
      "p": "on-success",
      "o": "595d51f3-1265-4c7e-860d-d3a3981a7578"
    },
    {
      "s": "a9006243-8fec-409b-94c8-9e6d738b59b4",
      "p": "on-failure",
      "o": "595d51f3-1265-4c7e-860d-d3a3981a7578"
    }
  ],
  "tags": [
    "T1547.001",
    "atomic-red-team"
  ]
}