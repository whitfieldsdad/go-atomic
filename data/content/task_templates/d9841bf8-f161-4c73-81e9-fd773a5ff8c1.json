{
  "id": "d9841bf8-f161-4c73-81e9-fd773a5ff8c1",
  "name": "Allow SMB and RDP on Microsoft Defender Firewall",
  "description": "Allow all SMB and RDP rules on the Microsoft Defender Firewall for all profiles.\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will reset the firewall and risk disabling those services...\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "919ed412-19fd-410c-b105-cbda27e841a9",
      "type": "execute-command",
      "data": {
        "command": "netsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes\nnetsh advfirewall firewall set rule group=\"file and printer sharing\" new enable=Yes\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "92158e15-3cb7-4fd5-9630-683009435a8b",
      "type": "execute-command",
      "data": {
        "command": "netsh advfirewall reset \u003enul 2\u003e\u00261\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "919ed412-19fd-410c-b105-cbda27e841a9",
      "p": "on-success",
      "o": "92158e15-3cb7-4fd5-9630-683009435a8b"
    },
    {
      "s": "919ed412-19fd-410c-b105-cbda27e841a9",
      "p": "on-failure",
      "o": "92158e15-3cb7-4fd5-9630-683009435a8b"
    }
  ],
  "tags": [
    "T1562.004",
    "atomic-red-team"
  ]
}