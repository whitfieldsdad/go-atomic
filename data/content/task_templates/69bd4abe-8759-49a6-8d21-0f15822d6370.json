{
  "id": "69bd4abe-8759-49a6-8d21-0f15822d6370",
  "name": "Griffon Recon",
  "description": "This script emulates the reconnaissance script seen in used by Griffon and was modified by security researcher Kirk Sayre \nin order simply print the recon results to the screen as opposed to exfiltrating them. [Script](https://gist.github.com/kirk-sayre-work/7cb5bf4e2c7c77fa5684ddc17053f1e5).  \nFor more information see also [https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon](https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon) and [https://attack.mitre.org/software/S0417/](https://attack.mitre.org/software/S0417/)",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "3f415077-99e2-4634-9c9b-942d75256123",
      "type": "execute-command",
      "data": {
        "command": "cscript \"#{vbscript}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "9b388f04-bfc0-4439-bbc6-f114999e5a4d",
      "name": "Check dependency 1/1",
      "description": "Sample script file must exist on disk at specified location (#{vbscript})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{vbscript}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "e134c37d-83a7-43b2-bffe-ea1382916718",
      "name": "Resolve dependency 1/1",
      "description": "Sample script file must exist on disk at specified location (#{vbscript})\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory (split-path \"#{vbscript}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1082/src/griffon_recon.vbs\" -OutFile \"#{vbscript}\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b0a36de0-5612-40ce-b684-a57c50ac9b9d",
      "name": "Re-check dependency 1/1",
      "description": "Sample script file must exist on disk at specified location (#{vbscript})\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{vbscript}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "9b388f04-bfc0-4439-bbc6-f114999e5a4d",
      "p": "on-success",
      "o": "3f415077-99e2-4634-9c9b-942d75256123"
    },
    {
      "s": "9b388f04-bfc0-4439-bbc6-f114999e5a4d",
      "p": "on-failure",
      "o": "e134c37d-83a7-43b2-bffe-ea1382916718"
    },
    {
      "s": "e134c37d-83a7-43b2-bffe-ea1382916718",
      "p": "on-success",
      "o": "b0a36de0-5612-40ce-b684-a57c50ac9b9d"
    },
    {
      "s": "b0a36de0-5612-40ce-b684-a57c50ac9b9d",
      "p": "on-failure",
      "o": "3f415077-99e2-4634-9c9b-942d75256123"
    }
  ],
  "tags": [
    "T1082",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "vbscript",
      "type": "string",
      "description": "Path to sample script",
      "value": "PathToAtomicsFolder\\T1082\\src\\griffon_recon.vbs"
    }
  ]
}