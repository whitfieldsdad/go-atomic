{
  "id": "6c2da894-0b57-43cb-87af-46ea3b501388",
  "name": "Remote System Discovery - ip tcp_metrics",
  "description": "Use the ip tcp_metrics command to display the recent cached entries for IPv4 and IPv6 source and destination addresses. \n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "f79d8ac0-f7c3-4786-bf38-6fda789b73f3",
      "type": "execute-command",
      "data": {
        "command": "ip tcp_metrics show |grep --invert-match \"^127\\.\"",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "917b9478-38b3-4fd1-8a4c-09d624f191da",
      "name": "Check dependency 1/1",
      "description": "Check if ip command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ip)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "e06dd181-40c3-4986-b17b-b604f0d7e4ce",
      "name": "Resolve dependency 1/1",
      "description": "Check if ip command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "apt-get install iproute2 -y",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "11d57779-558f-42c5-94f7-eb3e3a5c9974",
      "name": "Re-check dependency 1/1",
      "description": "Check if ip command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ip)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "917b9478-38b3-4fd1-8a4c-09d624f191da",
      "p": "on-success",
      "o": "f79d8ac0-f7c3-4786-bf38-6fda789b73f3"
    },
    {
      "s": "917b9478-38b3-4fd1-8a4c-09d624f191da",
      "p": "on-failure",
      "o": "e06dd181-40c3-4986-b17b-b604f0d7e4ce"
    },
    {
      "s": "e06dd181-40c3-4986-b17b-b604f0d7e4ce",
      "p": "on-success",
      "o": "11d57779-558f-42c5-94f7-eb3e3a5c9974"
    },
    {
      "s": "11d57779-558f-42c5-94f7-eb3e3a5c9974",
      "p": "on-failure",
      "o": "f79d8ac0-f7c3-4786-bf38-6fda789b73f3"
    }
  ],
  "tags": [
    "T1018"
  ],
  "input_arguments": null
}