{
  "id": "40074085-dbc8-492b-90a3-11bcfc52fda8",
  "name": "Tamper with Defender ATP on Linux/MacOS",
  "description": "With root privileges, an adversary can disable real time protection. Note, this test assumes Defender is not in passive mode and real-time protection is enabled. The use of a managed.json on Linux or Defender .plist on MacOS will prevent these changes. Tamper protection will also prevent this (available on MacOS, but not Linux at the time of writing). Installation of MDATP is a prerequisite. Installation steps vary across MacOS and Linux distros. See Microsoft public documentation for instructions: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-install-manually?view=o365-worldwide https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/linux-install-manually?view=o365-worldwide\n",
  "platforms": [
    "linux",
    "darwin"
  ],
  "steps": [
    {
      "id": "b8258f1b-3646-4c0c-b6c5-04d1a13e46ee",
      "type": "execute-command",
      "data": {
        "command": "sudo mdatp config real-time-protection --value disabled\n",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "d160bc28-6b21-49cc-acfd-12b8947f2df1",
      "type": "execute-command",
      "data": {
        "command": "sudo mdatp config real-time-protection --value enabled\n",
        "command_type": "sh"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "b8258f1b-3646-4c0c-b6c5-04d1a13e46ee",
      "p": "on-success",
      "o": "d160bc28-6b21-49cc-acfd-12b8947f2df1"
    },
    {
      "s": "b8258f1b-3646-4c0c-b6c5-04d1a13e46ee",
      "p": "on-failure",
      "o": "d160bc28-6b21-49cc-acfd-12b8947f2df1"
    }
  ],
  "tags": [
    "T1562",
    "T1562.001"
  ]
}