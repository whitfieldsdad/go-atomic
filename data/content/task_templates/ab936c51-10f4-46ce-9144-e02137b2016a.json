{
  "id": "ab936c51-10f4-46ce-9144-e02137b2016a",
  "name": "Data Transfer Size Limits",
  "description": "Take a file/directory, split it into 5Mb chunks\n",
  "platforms": [
    "darwin",
    "linux"
  ],
  "steps": [
    {
      "id": "3bbbd2e4-797f-4e55-b98e-1095a1df425a",
      "type": "execute-command",
      "data": {
        "command": "cd #{folder_path}; split -b 5000000 #{file_name}\nls -l #{folder_path}\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "6ef6a30c-3aec-484e-b59d-233b66d25e9d",
      "type": "execute-command",
      "data": {
        "command": "if [ -f #{folder_path}/safe_to_delete ]; then rm -rf #{folder_path}; fi;\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "3a3fde57-4df6-431e-b23d-208fda0a4a9f",
      "name": "Check dependency 1/1",
      "description": "The file must exist for the test to run.",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -f #{folder_path}/#{file_name} ]; then exit 1; else exit 0; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "7a7044a5-0149-48e7-8b2b-952fa0ac28db",
      "name": "Resolve dependency 1/1",
      "description": "The file must exist for the test to run.",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -d #{folder_path} ]; then mkdir -p #{folder_path}; touch #{folder_path}/safe_to_delete; fi; dd if=/dev/urandom of=#{folder_path}/#{file_name} bs=25000000 count=1\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "27908ed1-202c-4ab3-bc36-0253a1837a2e",
      "name": "Re-check dependency 1/1",
      "description": "The file must exist for the test to run.",
      "type": "execute-command",
      "data": {
        "command": "if [ ! -f #{folder_path}/#{file_name} ]; then exit 1; else exit 0; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "3bbbd2e4-797f-4e55-b98e-1095a1df425a",
      "p": "on-success",
      "o": "6ef6a30c-3aec-484e-b59d-233b66d25e9d"
    },
    {
      "s": "3bbbd2e4-797f-4e55-b98e-1095a1df425a",
      "p": "on-failure",
      "o": "6ef6a30c-3aec-484e-b59d-233b66d25e9d"
    },
    {
      "s": "3a3fde57-4df6-431e-b23d-208fda0a4a9f",
      "p": "on-success",
      "o": "3bbbd2e4-797f-4e55-b98e-1095a1df425a"
    },
    {
      "s": "3a3fde57-4df6-431e-b23d-208fda0a4a9f",
      "p": "on-failure",
      "o": "7a7044a5-0149-48e7-8b2b-952fa0ac28db"
    },
    {
      "s": "7a7044a5-0149-48e7-8b2b-952fa0ac28db",
      "p": "on-success",
      "o": "27908ed1-202c-4ab3-bc36-0253a1837a2e"
    },
    {
      "s": "27908ed1-202c-4ab3-bc36-0253a1837a2e",
      "p": "on-failure",
      "o": "3bbbd2e4-797f-4e55-b98e-1095a1df425a"
    }
  ],
  "tags": [
    "T1030",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "file_name",
      "type": "path",
      "description": "File name",
      "value": "T1030_urandom"
    },
    {
      "name": "folder_path",
      "type": "path",
      "description": "Path where the test creates artifacts",
      "value": "/tmp/T1030"
    }
  ]
}