{
  "id": "2a3c7035-d14f-467a-af94-933e49fe6786",
  "name": "Process Injection with Go using CreateThread WinAPI (Natively)",
  "description": "This program executes shellcode in the current process using the following steps\n1. Allocate memory for the shellcode with VirtualAlloc setting the page permissions to Read/Write\n2. Use the RtlCopyMemory macro to copy the shellcode to the allocated memory space\n3. Change the memory page permissions to Execute/Read with VirtualProtect\n4. Call CreateThread on shellcode address\n5. Call WaitForSingleObject so the program does not end before the shellcode is executed\n\nThis program loads the DLLs and gets a handle to the used procedures itself instead of using the windows package directly.\n\n- PoC Credit: (https://github.com/Ne0nd0g/go-shellcode#createthreadnative)\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a533210f-86bb-417e-b569-ef00a5ac594a",
      "type": "execute-command",
      "data": {
        "command": "$PathToAtomicsFolder\\T1055\\bin\\x64\\CreateThreadNative.exe -debug\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "42a347b8-6f57-4768-b425-7be5bcff0fc6",
      "type": "execute-command",
      "data": {
        "command": "Stop-Process -Name CalculatorApp -ErrorAction SilentlyContinue",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a533210f-86bb-417e-b569-ef00a5ac594a",
      "p": "on-success",
      "o": "42a347b8-6f57-4768-b425-7be5bcff0fc6"
    },
    {
      "s": "a533210f-86bb-417e-b569-ef00a5ac594a",
      "p": "on-failure",
      "o": "42a347b8-6f57-4768-b425-7be5bcff0fc6"
    }
  ],
  "tags": [
    "T1055",
    "atomic-red-team"
  ]
}