{
  "id": "d430bf85-b656-40e7-b238-42db01df0183",
  "name": "Enumerate PlugNPlay Camera",
  "description": "Enumerate PlugNPlay Camera using powershell commandlet. this technique was seen in dcrat malware backdoor capabilities where it enumerate the camera info mounted on the compromised host. reference: https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "0ccc3c6b-84c3-4182-8f26-d8321feefe9b",
      "type": "execute-command",
      "data": {
        "command": "Get-CimInstance -Query \"SELECT * FROM Win32_PnPEntity WHERE (PNPClass = 'Image' OR PNPClass = 'Camera')\"\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1592.001",
    "atomic-red-team"
  ]
}