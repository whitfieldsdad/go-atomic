{
  "id": "31e794c4-48fd-4a76-aca4-6587c155bc11",
  "name": "List All Secrets",
  "description": "A Kubernetes secret is an object that lets users store and manage sensitive information, such as passwords and connection strings in the cluster. Secrets can be consumed by reference in the pod configuration. Attackers who have permissions to retrieve the secrets from the API server (by using the pod service account, for example) can access sensitive information that might include credentials to various services or provide further access to the cluster.\n[More information about secrets](https://kubernetes.io/docs/concepts/configuration/secret/).\n\nThis test will make a request to the Kubernetes api at the `/api/v1/secrets` endpoint requesting every secret stored within the cluster.\n",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "5d63515f-c350-4164-8674-0dee8169ec82",
      "type": "execute-command",
      "data": {
        "command": "kubectl get secrets --all-namespaces",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "c3a830b9-e0ac-4d2e-ad38-1e9fb830ea8d",
      "name": "Check dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which kubectl",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "dab1f138-b871-4584-8ac2-c7d148f2bcd7",
      "name": "Resolve dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "echo \"kubectl not installed, please install kubectl (https://kubernetes.io/docs/tasks/tools/)\"",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "2d58895b-b957-41a0-82b8-84d9ac0aa7c3",
      "name": "Re-check dependency 1/1",
      "description": "kubectl must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which kubectl",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "c3a830b9-e0ac-4d2e-ad38-1e9fb830ea8d",
      "p": "on-success",
      "o": "5d63515f-c350-4164-8674-0dee8169ec82"
    },
    {
      "s": "c3a830b9-e0ac-4d2e-ad38-1e9fb830ea8d",
      "p": "on-failure",
      "o": "dab1f138-b871-4584-8ac2-c7d148f2bcd7"
    },
    {
      "s": "dab1f138-b871-4584-8ac2-c7d148f2bcd7",
      "p": "on-success",
      "o": "2d58895b-b957-41a0-82b8-84d9ac0aa7c3"
    },
    {
      "s": "2d58895b-b957-41a0-82b8-84d9ac0aa7c3",
      "p": "on-failure",
      "o": "5d63515f-c350-4164-8674-0dee8169ec82"
    }
  ],
  "tags": [
    "T1552",
    "T1552.007"
  ]
}