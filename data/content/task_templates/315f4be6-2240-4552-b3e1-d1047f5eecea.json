{
  "id": "315f4be6-2240-4552-b3e1-d1047f5eecea",
  "name": "Tamper with Windows Defender Evade Scanning -Extension",
  "description": "Malware can exclude specific extensions from being scanned and evading detection. \nUpon successful execution, the extension(s) should be on the list of excluded extensions.\nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionExtension.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "f9ce79ab-b3d7-4ef4-8256-aaa09072109d",
      "type": "execute-command",
      "data": {
        "command": "$excludedExts= \"#{excluded_exts}\"\nAdd-MpPreference -ExclusionExtension  $excludedExts",
        "command_type": "powershell"
      },
      "elevation_required": true
    },
    {
      "id": "ab3e49f4-20cd-46b0-ad6e-859843a155ad",
      "type": "execute-command",
      "data": {
        "command": "$excludedExts= \"#{excluded_exts}\"\nRemove-MpPreference -ExclusionExtension  $excludedExts -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "f9ce79ab-b3d7-4ef4-8256-aaa09072109d",
      "p": "on-success",
      "o": "ab3e49f4-20cd-46b0-ad6e-859843a155ad"
    },
    {
      "s": "f9ce79ab-b3d7-4ef4-8256-aaa09072109d",
      "p": "on-failure",
      "o": "ab3e49f4-20cd-46b0-ad6e-859843a155ad"
    }
  ],
  "tags": [
    "T1562",
    "T1562.001"
  ],
  "input_arguments": [
    {
      "name": "excluded_exts",
      "type": "string",
      "description": "A list of extension to exclude from scanning",
      "value": ".exe"
    }
  ]
}