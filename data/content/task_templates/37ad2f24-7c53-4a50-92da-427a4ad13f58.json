{
  "id": "37ad2f24-7c53-4a50-92da-427a4ad13f58",
  "name": "Create/Append to .bash_logout",
  "description": "The Bash shell runs ~/.bash_logout \"if it exists\" to run commands on user logout. An adversary may create or append to a .bash_logout to clear history, start processes etc. Note the ~/.bash_logout is only run if you explicitly exit or log out of an \"interactive login shell session\" i.e. via the console, SSH, /bin/bash -l or su -l \u003cusername\u003e. \n\nThis test creates the art user, logs in, creates a .bash_logout which will echo some text into the art.txt file on logout and logs out and the /home/art/art.txt is created.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "783df829-d45f-4548-a0ed-fa371ab9a567",
      "type": "execute-command",
      "data": {
        "command": "useradd --create-home --shell /bin/bash art\nsu --login art\necho 'echo \"Atomic Red Team was here... T1546.004\" \u003e\u003e $HOME/art.txt' \u003e\u003e $HOME/.bash_logout\n",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "862c3a3f-e52c-4d67-9bae-bf17a087e301",
      "type": "execute-command",
      "data": {
        "command": "userdel -fr art\n",
        "command_type": "bash"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "783df829-d45f-4548-a0ed-fa371ab9a567",
      "p": "on-success",
      "o": "862c3a3f-e52c-4d67-9bae-bf17a087e301"
    },
    {
      "s": "783df829-d45f-4548-a0ed-fa371ab9a567",
      "p": "on-failure",
      "o": "862c3a3f-e52c-4d67-9bae-bf17a087e301"
    }
  ],
  "tags": [
    "T1546",
    "T1546.004"
  ]
}