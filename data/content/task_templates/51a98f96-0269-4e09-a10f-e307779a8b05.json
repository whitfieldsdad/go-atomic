{
  "id": "51a98f96-0269-4e09-a10f-e307779a8b05",
  "name": "Suspicious LAPS Attributes Query with adfind ms-Mcs-AdmPwd",
  "description": "This test executes LDAP query using adfind command and lists Microsoft LAPS attributes ms-mcs-AdmPwd and ms-mcs-AdmPwdExpirationTime",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "f8398044-a6dc-4e51-acae-cf122531cea1",
      "type": "execute-command",
      "data": {
        "command": "\u0026 \"PathToAtomicsFolder\\..\\ExternalPayloads\\AdFind.exe\" #{optional_args} -h #{domain} -s subtree -f \"objectclass=computer\" ms-Mcs-AdmPwd, ms-Mcs-AdmPwdExpirationTime\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "tags": [
    "T1087.002",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "domain",
      "type": "string",
      "description": "Domain of the host",
      "value": "$env:USERDOMAIN"
    },
    {
      "name": "optional_args",
      "type": "string",
      "description": "Allows defining arguments to add to the adfind command to tailor it to the specific needs of the environment. Use \"-arg\" notation to add arguments separated by spaces.",
      "value": ""
    }
  ]
}