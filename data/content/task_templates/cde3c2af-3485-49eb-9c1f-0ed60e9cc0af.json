{
  "id": "cde3c2af-3485-49eb-9c1f-0ed60e9cc0af",
  "name": "Data Compressed - nix - gzip Single File",
  "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration. This test uses standard gzip compression.\n",
  "platforms": [
    "linux",
    "darwin"
  ],
  "steps": [
    {
      "id": "ba69eacf-3451-4aa0-a9c8-cf1ad6a1da69",
      "type": "execute-command",
      "data": {
        "command": "test -e #{input_file} \u0026\u0026 gzip -k #{input_file} || (echo '#{input_content}' \u003e\u003e #{input_file}; gzip -k #{input_file})",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "4f65f489-cbb7-448c-9d49-e11c1f08bf36",
      "type": "execute-command",
      "data": {
        "command": "rm -f #{input_file}.gz",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "ba69eacf-3451-4aa0-a9c8-cf1ad6a1da69",
      "p": "on-success",
      "o": "4f65f489-cbb7-448c-9d49-e11c1f08bf36"
    },
    {
      "s": "ba69eacf-3451-4aa0-a9c8-cf1ad6a1da69",
      "p": "on-failure",
      "o": "4f65f489-cbb7-448c-9d49-e11c1f08bf36"
    }
  ],
  "tags": [
    "T1560",
    "T1560.001"
  ],
  "input_arguments": [
    {
      "name": "input_file",
      "type": "path",
      "description": "Path that should be compressed",
      "value": "$HOME/victim-gzip.txt"
    },
    {
      "name": "input_content",
      "type": "string",
      "description": "contents of compressed files if file does not already exist. default contains test credit card and social security number",
      "value": "confidential! SSN: 078-05-1120 - CCN: 4000 1234 5678 9101"
    }
  ]
}