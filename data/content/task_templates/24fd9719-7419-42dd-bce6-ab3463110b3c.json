{
  "id": "24fd9719-7419-42dd-bce6-ab3463110b3c",
  "name": "Mirror Blast Emulation",
  "description": "Emulates the JS -\u003e MSI chain of the MirrorBlast T505 campaign by executing an xlsm file designed. \nRequires the 32 bit version of Office to run. [MirrorBlast Campaign Analysis](https://blog.morphisec.com/explosive-new-mirrorblast-campaign-targets-financial-companies)\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a11abeaa-6003-4cca-9256-cabb95f415aa",
      "type": "execute-command",
      "data": {
        "command": "Cd \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\"\nNew-ItemProperty -Path Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Excel\\Security -Name \"VBAWarnings\" -Value \"1\" -PropertyType DWORD -Force | Out-Null\n\u0026 '.\\Excel 2016.lnk' \"PathToAtomicsFolder\\T1204.002\\bin\\mirrorblast_emulation.xlsm\"",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "bc001e34-963e-452d-ac53-89557b18defa",
      "type": "execute-command",
      "data": {
        "command": "reg delete \"HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Excel\\Security\" /v \"VBAWarnings\" /f",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a11abeaa-6003-4cca-9256-cabb95f415aa",
      "p": "on-success",
      "o": "bc001e34-963e-452d-ac53-89557b18defa"
    },
    {
      "s": "a11abeaa-6003-4cca-9256-cabb95f415aa",
      "p": "on-failure",
      "o": "bc001e34-963e-452d-ac53-89557b18defa"
    }
  ],
  "tags": [
    "T1204.002",
    "atomic-red-team"
  ]
}