{
  "id": "900e2c49-221b-42ec-ae3c-4717e41e6219",
  "name": "Docker Exec Into Container",
  "description": "Attackers who have permissions, can run malicious commands in containers in the cluster using exec command (“docker exec”). In this method, attackers can use legitimate images, such as an OS image (e.g., Ubuntu) as a backdoor container, and run their malicious code remotely by using “docker exec”. Kinsing (Golang-based malware) was executed with an Ubuntu container entry point that runs shell scripts.\n",
  "platforms": [
    "containers"
  ],
  "steps": [
    {
      "id": "79666ed2-5be0-4527-aec0-8428bd546fc6",
      "type": "execute-command",
      "data": {
        "command": "docker build -t t1609  $PathtoAtomicsFolder/T1609/src/ \ndocker run --name t1609_container --rm -itd t1609 bash /tmp/script.sh\ndocker exec -i t1609_container bash -c \"cat /tmp/output.txt\"",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "dd1e2e40-ebd2-496d-85e1-372f8dbc3342",
      "type": "execute-command",
      "data": {
        "command": "docker stop t1609_container\ndocker rmi -f t1609:latest",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "f6ad8d74-3790-44de-bc87-ab8be5d34609",
      "name": "Check dependency 1/1",
      "description": "docker must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "c6096233-9522-45d7-8768-319a39fb742e",
      "name": "Resolve dependency 1/1",
      "description": "docker must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ \"\" == \"`which docker`\" ]; then echo \"Docker Not Found\"; if [ -n \"`which apt-get`\" ]; then sudo apt-get -y install docker ; elif [ -n \"`which yum`\" ]; then sudo yum -y install docker ; fi ; else echo \"Docker installed\"; fi",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "89f285a7-45f3-4545-980e-0136beb5135e",
      "name": "Re-check dependency 1/1",
      "description": "docker must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "which docker",
        "command_type": "bash"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "79666ed2-5be0-4527-aec0-8428bd546fc6",
      "p": "on-success",
      "o": "dd1e2e40-ebd2-496d-85e1-372f8dbc3342"
    },
    {
      "s": "79666ed2-5be0-4527-aec0-8428bd546fc6",
      "p": "on-failure",
      "o": "dd1e2e40-ebd2-496d-85e1-372f8dbc3342"
    },
    {
      "s": "f6ad8d74-3790-44de-bc87-ab8be5d34609",
      "p": "on-success",
      "o": "79666ed2-5be0-4527-aec0-8428bd546fc6"
    },
    {
      "s": "f6ad8d74-3790-44de-bc87-ab8be5d34609",
      "p": "on-failure",
      "o": "c6096233-9522-45d7-8768-319a39fb742e"
    },
    {
      "s": "c6096233-9522-45d7-8768-319a39fb742e",
      "p": "on-success",
      "o": "89f285a7-45f3-4545-980e-0136beb5135e"
    },
    {
      "s": "89f285a7-45f3-4545-980e-0136beb5135e",
      "p": "on-failure",
      "o": "79666ed2-5be0-4527-aec0-8428bd546fc6"
    }
  ],
  "tags": [
    "T1609"
  ]
}