{
  "id": "d03683ec-aae0-42f9-9b4c-534780e0f8e1",
  "name": "LogMeIn Files Detected Test on Windows",
  "description": "An adversary may attempt to trick the user into downloading LogMeIn and use to establish C2. Download of LogMeIn installer will be at the destination location and ran when sucessfully executed.\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "7dea5bb5-1ad4-49c3-b52c-2bb05a3526a1",
      "type": "execute-command",
      "data": {
        "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\LogMeInIgnition.msi https://secure.logmein.com/LogMeInIgnition.msi\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\LogMeInIgnition.msi\"\nStart-Process -Wait $file1 /quiet;\nStart-Process 'C:\\Program Files (x86)\\LogMeIn Ignition\\LMIIgnition.exe' \"/S\"",
        "command_type": "powershell"
      },
      "elevation_required": true
    },
    {
      "id": "32d1fabc-afcc-4bf2-971c-9755c3ca57a5",
      "type": "execute-command",
      "data": {
        "command": "get-package *'LogMeIn Client'* -ErrorAction Ignore | uninstall-package \n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\LogMeInIgnition.msi\"\nRemove-Item $file1 -ErrorAction Ignore",
        "command_type": "powershell"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "7dea5bb5-1ad4-49c3-b52c-2bb05a3526a1",
      "p": "on-success",
      "o": "32d1fabc-afcc-4bf2-971c-9755c3ca57a5"
    },
    {
      "s": "7dea5bb5-1ad4-49c3-b52c-2bb05a3526a1",
      "p": "on-failure",
      "o": "32d1fabc-afcc-4bf2-971c-9755c3ca57a5"
    }
  ],
  "tags": [
    "T1219"
  ]
}