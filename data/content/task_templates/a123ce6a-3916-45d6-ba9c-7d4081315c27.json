{
  "id": "a123ce6a-3916-45d6-ba9c-7d4081315c27",
  "name": "Tamper with Windows Defender Evade Scanning -Process",
  "description": "Malware can exclude specific processes from being scanned and evading detection.\nUpon successful execution, the process(es) should be on the list of excluded processes. \nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionProcess.\"\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "c21bb4fb-87e1-4d20-8386-7ec1d21356be",
      "type": "execute-command",
      "data": {
        "command": "$excludedProcess = \"#{excluded_process}\"\nAdd-MpPreference -ExclusionProcess $excludedProcess",
        "command_type": "powershell"
      },
      "elevation_required": true
    },
    {
      "id": "4fbd67cc-febc-4f66-8c4d-cecc121105e1",
      "type": "execute-command",
      "data": {
        "command": "$excludedProcess = \"#{excluded_process}\"\nRemove-MpPreference -ExclusionProcess  $excludedProcess",
        "command_type": "powershell"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "c21bb4fb-87e1-4d20-8386-7ec1d21356be",
      "p": "on-success",
      "o": "4fbd67cc-febc-4f66-8c4d-cecc121105e1"
    },
    {
      "s": "c21bb4fb-87e1-4d20-8386-7ec1d21356be",
      "p": "on-failure",
      "o": "4fbd67cc-febc-4f66-8c4d-cecc121105e1"
    }
  ],
  "tags": [
    "T1562",
    "T1562.001"
  ],
  "input_arguments": [
    {
      "name": "excluded_process",
      "type": "string",
      "description": "A list of processes to exclude from scanning",
      "value": "outlook.exe"
    }
  ]
}