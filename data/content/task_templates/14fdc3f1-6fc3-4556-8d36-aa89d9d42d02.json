{
  "id": "14fdc3f1-6fc3-4556-8d36-aa89d9d42d02",
  "name": "secedit used to create a Run key in the HKLM Hive",
  "description": "secedit allows to manipulate the HKLM hive of the Windows registry. This test creates a Run key with the keyname calc having calc.exe as the value in the HKLM hive.\n[Reference](https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d)\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "1eb3fa03-4d18-4a09-af3a-a977241b6dce",
      "type": "execute-command",
      "data": {
        "command": "secedit /import /db #{secedit_db} /cfg \"#{ini_file}\"\nsecedit /configure /db #{secedit_db}\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "1b90e90d-302e-4b51-96f3-47a3fbfbcd39",
      "type": "execute-command",
      "data": {
        "command": "REG DELETE \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /V \"calc\" /f \u003enul 2\u003e\u00261",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "1eb3fa03-4d18-4a09-af3a-a977241b6dce",
      "p": "on-success",
      "o": "1b90e90d-302e-4b51-96f3-47a3fbfbcd39"
    },
    {
      "s": "1eb3fa03-4d18-4a09-af3a-a977241b6dce",
      "p": "on-failure",
      "o": "1b90e90d-302e-4b51-96f3-47a3fbfbcd39"
    }
  ],
  "tags": [
    "T1547.001",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "ini_file",
      "type": "string",
      "description": "INI config template",
      "value": "$PathToAtomicsFolder\\T1547.001\\src\\regtemplate.ini"
    },
    {
      "name": "secedit_db",
      "type": "string",
      "description": "Custom secedit db",
      "value": "mytemplate.db"
    }
  ]
}