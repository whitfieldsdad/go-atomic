{
  "id": "b1a4d687-ba52-4057-81ab-757c3dc0d3b5",
  "name": "Modify Internet Zone Protocol Defaults in Current User Registry - PowerShell",
  "description": "This test simulates an adversary modifying the Internet Zone Protocol Defaults in the registry of the currently logged-in user using PowerShell. Such modifications can be indicative of an adversary attempting to weaken browser security settings. \nTo verify the effects of the test:\n1. Open the Registry Editor (regedit.exe).\n2. Navigate to \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\".\n3. Check for the presence of the \"http\" and \"https\" DWORD values set to `0`.\nOr run:\n```powershell\nGet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' | Select-Object http,https\n```\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "ea9db0fe-b73e-4a8a-b720-2892faa823dc",
      "type": "execute-command",
      "data": {
        "command": "# Set the registry values for http and https to 0\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'http' -Value 0\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'https' -Value 0\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "d302b98b-b733-485e-b125-8068a7ab64eb",
      "type": "execute-command",
      "data": {
        "command": "# Restore the registry values for http and https to 3\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'http' -Value 3\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'https' -Value 3\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "ea9db0fe-b73e-4a8a-b720-2892faa823dc",
      "p": "on-success",
      "o": "d302b98b-b733-485e-b125-8068a7ab64eb"
    },
    {
      "s": "ea9db0fe-b73e-4a8a-b720-2892faa823dc",
      "p": "on-failure",
      "o": "d302b98b-b733-485e-b125-8068a7ab64eb"
    }
  ],
  "tags": [
    "T1112"
  ]
}