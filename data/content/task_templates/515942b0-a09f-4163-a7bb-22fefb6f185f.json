{
  "id": "515942b0-a09f-4163-a7bb-22fefb6f185f",
  "name": "Port Scan Nmap",
  "description": "Scan ports to check for listening ports with Nmap.\nUpon successful execution, sh will utilize nmap, telnet, and nc to contact a single or range of addresses on port 80 to determine if listening. Results will be via stdout.\n",
  "platforms": [
    "linux",
    "darwin"
  ],
  "steps": [
    {
      "id": "8d58c111-eb96-4b77-942d-592e4edc1679",
      "type": "execute-command",
      "data": {
        "command": "sudo nmap -sS #{network_range} -p #{port}\ntelnet #{host} #{port}\nnc -nv #{host} #{port}\n",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "d222ae85-c410-41d4-bf54-b02983c4bbe0",
      "name": "Check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "02928ef3-59a2-4a03-b414-1c538c71b393",
      "name": "Resolve dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nmap)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y nmap)||(which pkg \u0026\u0026 pkg install -y nmap)\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "5f23b5dd-5183-49b3-9ded-28f794d2c06f",
      "name": "Re-check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "bfd29589-411b-4267-ab74-6b9c8d83cd80",
      "name": "Check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "07726e3d-abd8-4cbe-8bcc-039fecb3ba0d",
      "name": "Resolve dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nc)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y netcat)||(which pkg \u0026\u0026 pkg install -y netcat)\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "f4fa13a2-92d7-46ac-b9bc-9fa8138056be",
      "name": "Re-check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "50e42aff-404a-4483-bc2d-1cf8975a0648",
      "name": "Check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "20b8ba6a-b32b-4655-ae3f-1686eadade02",
      "name": "Resolve dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release telnet)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y telnet)\n",
        "command_type": ""
      },
      "elevation_required": true
    },
    {
      "id": "fa461dc9-e696-4539-b5bb-c53816a61c69",
      "name": "Re-check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;\n",
        "command_type": ""
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "d222ae85-c410-41d4-bf54-b02983c4bbe0",
      "p": "on-success",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    },
    {
      "s": "d222ae85-c410-41d4-bf54-b02983c4bbe0",
      "p": "on-failure",
      "o": "02928ef3-59a2-4a03-b414-1c538c71b393"
    },
    {
      "s": "02928ef3-59a2-4a03-b414-1c538c71b393",
      "p": "on-success",
      "o": "5f23b5dd-5183-49b3-9ded-28f794d2c06f"
    },
    {
      "s": "5f23b5dd-5183-49b3-9ded-28f794d2c06f",
      "p": "on-failure",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    },
    {
      "s": "bfd29589-411b-4267-ab74-6b9c8d83cd80",
      "p": "on-success",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    },
    {
      "s": "bfd29589-411b-4267-ab74-6b9c8d83cd80",
      "p": "on-failure",
      "o": "07726e3d-abd8-4cbe-8bcc-039fecb3ba0d"
    },
    {
      "s": "07726e3d-abd8-4cbe-8bcc-039fecb3ba0d",
      "p": "on-success",
      "o": "f4fa13a2-92d7-46ac-b9bc-9fa8138056be"
    },
    {
      "s": "f4fa13a2-92d7-46ac-b9bc-9fa8138056be",
      "p": "on-failure",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    },
    {
      "s": "50e42aff-404a-4483-bc2d-1cf8975a0648",
      "p": "on-success",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    },
    {
      "s": "50e42aff-404a-4483-bc2d-1cf8975a0648",
      "p": "on-failure",
      "o": "20b8ba6a-b32b-4655-ae3f-1686eadade02"
    },
    {
      "s": "20b8ba6a-b32b-4655-ae3f-1686eadade02",
      "p": "on-success",
      "o": "fa461dc9-e696-4539-b5bb-c53816a61c69"
    },
    {
      "s": "fa461dc9-e696-4539-b5bb-c53816a61c69",
      "p": "on-failure",
      "o": "8d58c111-eb96-4b77-942d-592e4edc1679"
    }
  ],
  "tags": [
    "T1046"
  ],
  "input_arguments": [
    {
      "name": "host",
      "type": "string",
      "description": "Host to scan.",
      "value": "192.168.1.1"
    },
    {
      "name": "port",
      "type": "string",
      "description": "Ports to scan.",
      "value": "80"
    },
    {
      "name": "network_range",
      "type": "string",
      "description": "Network Range to Scan.",
      "value": "192.168.1.0/24"
    }
  ]
}