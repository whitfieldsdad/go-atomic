{
  "id": "515942b0-a09f-4163-a7bb-22fefb6f185f",
  "name": "Port Scan Nmap",
  "description": "Scan ports to check for listening ports with Nmap.\nUpon successful execution, sh will utilize nmap, telnet, and nc to contact a single or range of addresses on port 80 to determine if listening. Results will be via stdout.\n",
  "platforms": [
    "linux",
    "darwin"
  ],
  "steps": [
    {
      "id": "b676e4bc-defd-4594-84ad-bfd020bed261",
      "type": "execute-command",
      "data": {
        "command": "sudo nmap -sS #{network_range} -p #{port}\ntelnet #{host} #{port}\nnc -nv #{host} #{port}",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "dce1f6b0-2e06-4548-ab86-a1928347fe91",
      "name": "Check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "335d8718-0fdd-4f89-9e88-454bd2231c4d",
      "name": "Resolve dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nmap)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y nmap)||(which pkg \u0026\u0026 pkg install -y nmap)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "02c33597-17bd-4513-aefe-9bc423d659bb",
      "name": "Re-check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "339bd669-eebe-457f-8b62-b9d6f11f41b4",
      "name": "Check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "0743a972-cdf5-4805-8d85-d876114c55e1",
      "name": "Resolve dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nc)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y netcat)||(which pkg \u0026\u0026 pkg install -y netcat)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "56b16806-b67f-44a2-abc5-19a4841818f9",
      "name": "Re-check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "a90ba1b5-49a6-4c97-8eb5-6104f1d765c3",
      "name": "Check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "adee784f-208a-424e-ba11-849e9e66de21",
      "name": "Resolve dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release telnet)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y telnet)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "8bea6c22-986d-437b-9bc7-e4cd189be524",
      "name": "Re-check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "dce1f6b0-2e06-4548-ab86-a1928347fe91",
      "p": "on-success",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    },
    {
      "s": "dce1f6b0-2e06-4548-ab86-a1928347fe91",
      "p": "on-failure",
      "o": "335d8718-0fdd-4f89-9e88-454bd2231c4d"
    },
    {
      "s": "335d8718-0fdd-4f89-9e88-454bd2231c4d",
      "p": "on-success",
      "o": "02c33597-17bd-4513-aefe-9bc423d659bb"
    },
    {
      "s": "02c33597-17bd-4513-aefe-9bc423d659bb",
      "p": "on-failure",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    },
    {
      "s": "339bd669-eebe-457f-8b62-b9d6f11f41b4",
      "p": "on-success",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    },
    {
      "s": "339bd669-eebe-457f-8b62-b9d6f11f41b4",
      "p": "on-failure",
      "o": "0743a972-cdf5-4805-8d85-d876114c55e1"
    },
    {
      "s": "0743a972-cdf5-4805-8d85-d876114c55e1",
      "p": "on-success",
      "o": "56b16806-b67f-44a2-abc5-19a4841818f9"
    },
    {
      "s": "56b16806-b67f-44a2-abc5-19a4841818f9",
      "p": "on-failure",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    },
    {
      "s": "a90ba1b5-49a6-4c97-8eb5-6104f1d765c3",
      "p": "on-success",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    },
    {
      "s": "a90ba1b5-49a6-4c97-8eb5-6104f1d765c3",
      "p": "on-failure",
      "o": "adee784f-208a-424e-ba11-849e9e66de21"
    },
    {
      "s": "adee784f-208a-424e-ba11-849e9e66de21",
      "p": "on-success",
      "o": "8bea6c22-986d-437b-9bc7-e4cd189be524"
    },
    {
      "s": "8bea6c22-986d-437b-9bc7-e4cd189be524",
      "p": "on-failure",
      "o": "b676e4bc-defd-4594-84ad-bfd020bed261"
    }
  ],
  "tags": [
    "T1046"
  ],
  "input_arguments": [
    {
      "name": "host",
      "type": "string",
      "description": "Host to scan.",
      "value": "192.168.1.1"
    },
    {
      "name": "port",
      "type": "string",
      "description": "Ports to scan.",
      "value": "80"
    },
    {
      "name": "network_range",
      "type": "string",
      "description": "Network Range to Scan.",
      "value": "192.168.1.0/24"
    }
  ]
}