{
  "id": "515942b0-a09f-4163-a7bb-22fefb6f185f",
  "name": "Port Scan Nmap",
  "description": "Scan ports to check for listening ports with Nmap.\nUpon successful execution, sh will utilize nmap, telnet, and nc to contact a single or range of addresses on port 80 to determine if listening. Results will be via stdout.\n",
  "platforms": [
    "linux",
    "darwin"
  ],
  "steps": [
    {
      "id": "83c261c1-8031-46de-87dd-4ffedeae221f",
      "type": "execute-command",
      "data": {
        "command": "sudo nmap -sS #{network_range} -p #{port}\ntelnet #{host} #{port}\nnc -nv #{host} #{port}",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "c7fed3d5-133d-449b-bc4f-4c88e52d8398",
      "name": "Check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "e969d7e6-febc-46b6-b4fa-ff88fdd7c976",
      "name": "Resolve dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nmap)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y nmap)||(which pkg \u0026\u0026 pkg install -y nmap)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "52d8ab59-2aff-4458-840f-2da97ae03852",
      "name": "Re-check dependency 1/3",
      "description": "Check if nmap command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nmap)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "891e8295-e858-45bb-9ed7-00b3c2f10d59",
      "name": "Check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "48eb0097-fa95-44f3-83b2-e263a99b46bb",
      "name": "Resolve dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release nc)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y netcat)||(which pkg \u0026\u0026 pkg install -y netcat)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "ecfcc1bf-1af3-4d3c-89a5-8c002f49ed64",
      "name": "Re-check dependency 2/3",
      "description": "Check if nc command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v nc)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "46ffbce1-557b-41a0-95eb-9da5a1e4703c",
      "name": "Check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "155f9053-352e-4f0d-bc32-1d879a1d7f4f",
      "name": "Resolve dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "(which yum \u0026\u0026 yum -y install epel-release telnet)||(which apt-get \u0026\u0026 DEBIAN_FRONTEND=noninteractive apt-get install -y telnet)",
        "command_type": "sh"
      },
      "elevation_required": true
    },
    {
      "id": "53ab0c9f-df9f-4a09-b0f6-afd3322f5148",
      "name": "Re-check dependency 3/3",
      "description": "Check if telnet command exists on the machine\n",
      "type": "execute-command",
      "data": {
        "command": "if [ -x \"$(command -v telnet)\" ]; then exit 0; else exit 1; fi;",
        "command_type": "sh"
      },
      "elevation_required": true
    }
  ],
  "flows": [
    {
      "s": "c7fed3d5-133d-449b-bc4f-4c88e52d8398",
      "p": "on-success",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    },
    {
      "s": "c7fed3d5-133d-449b-bc4f-4c88e52d8398",
      "p": "on-failure",
      "o": "e969d7e6-febc-46b6-b4fa-ff88fdd7c976"
    },
    {
      "s": "e969d7e6-febc-46b6-b4fa-ff88fdd7c976",
      "p": "on-success",
      "o": "52d8ab59-2aff-4458-840f-2da97ae03852"
    },
    {
      "s": "52d8ab59-2aff-4458-840f-2da97ae03852",
      "p": "on-failure",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    },
    {
      "s": "891e8295-e858-45bb-9ed7-00b3c2f10d59",
      "p": "on-success",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    },
    {
      "s": "891e8295-e858-45bb-9ed7-00b3c2f10d59",
      "p": "on-failure",
      "o": "48eb0097-fa95-44f3-83b2-e263a99b46bb"
    },
    {
      "s": "48eb0097-fa95-44f3-83b2-e263a99b46bb",
      "p": "on-success",
      "o": "ecfcc1bf-1af3-4d3c-89a5-8c002f49ed64"
    },
    {
      "s": "ecfcc1bf-1af3-4d3c-89a5-8c002f49ed64",
      "p": "on-failure",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    },
    {
      "s": "46ffbce1-557b-41a0-95eb-9da5a1e4703c",
      "p": "on-success",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    },
    {
      "s": "46ffbce1-557b-41a0-95eb-9da5a1e4703c",
      "p": "on-failure",
      "o": "155f9053-352e-4f0d-bc32-1d879a1d7f4f"
    },
    {
      "s": "155f9053-352e-4f0d-bc32-1d879a1d7f4f",
      "p": "on-success",
      "o": "53ab0c9f-df9f-4a09-b0f6-afd3322f5148"
    },
    {
      "s": "53ab0c9f-df9f-4a09-b0f6-afd3322f5148",
      "p": "on-failure",
      "o": "83c261c1-8031-46de-87dd-4ffedeae221f"
    }
  ],
  "tags": [
    "T1046"
  ],
  "input_arguments": [
    {
      "name": "host",
      "type": "string",
      "description": "Host to scan.",
      "value": "192.168.1.1"
    },
    {
      "name": "port",
      "type": "string",
      "description": "Ports to scan.",
      "value": "80"
    },
    {
      "name": "network_range",
      "type": "string",
      "description": "Network Range to Scan.",
      "value": "192.168.1.0/24"
    }
  ]
}