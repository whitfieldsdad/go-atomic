{
  "id": "23c9c127-322b-4c75-95ca-eff464906114",
  "name": "Persistance with Event Monitor - emond",
  "description": "Establish persistence via a rule run by OSX's emond (Event Monitor) daemon at startup, based on https://posts.specterops.io/leveraging-emond-on-macos-for-persistence-a040a2785124\n",
  "platforms": [
    "darwin"
  ],
  "steps": [
    {
      "id": "a26cb03d-cc11-4347-89a8-25c26bc032c2",
      "type": "execute-command",
      "data": {
        "command": "sudo cp \"#{plist}\" /etc/emond.d/rules/T1546.014_emond.plist\nsudo touch /private/var/db/emondClients/T1546.014\n",
        "command_type": "sh"
      },
      "elevation_required": false
    },
    {
      "id": "91a350a0-248b-451b-a66b-63fd52179af1",
      "type": "execute-command",
      "data": {
        "command": "sudo rm /etc/emond.d/rules/T1546.014_emond.plist\nsudo rm /private/var/db/emondClients/T1546.014\n",
        "command_type": "sh"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a26cb03d-cc11-4347-89a8-25c26bc032c2",
      "p": "on-success",
      "o": "91a350a0-248b-451b-a66b-63fd52179af1"
    },
    {
      "s": "a26cb03d-cc11-4347-89a8-25c26bc032c2",
      "p": "on-failure",
      "o": "91a350a0-248b-451b-a66b-63fd52179af1"
    }
  ],
  "tags": [
    "T1546.014",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "plist",
      "type": "path",
      "description": "Path to attacker emond plist file",
      "value": "PathToAtomicsFolder/T1546.014/src/T1546.014_emond.plist"
    }
  ]
}