{
  "id": "bc8be0ac-475c-4fbf-9b1d-9fffd77afbde",
  "name": "Create a new user in PowerShell",
  "description": "Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run \"net user\" in powershell or CMD and observe that there is a new user named \"T1136.001_PowerShell\"\n",
  "platforms": [
    "windows"
  ],
  "steps": [
    {
      "id": "a1d5bcee-708a-4a93-8aa1-0611b1581b14",
      "type": "execute-command",
      "data": {
        "command": "New-LocalUser -Name \"#{username}\" -NoPassword\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    },
    {
      "id": "c10f6851-8f64-49c0-815a-4bcd29e5b099",
      "type": "execute-command",
      "data": {
        "command": "Remove-LocalUser -Name \"#{username}\" -ErrorAction Ignore\n",
        "command_type": "powershell"
      },
      "elevation_required": false
    }
  ],
  "flows": [
    {
      "s": "a1d5bcee-708a-4a93-8aa1-0611b1581b14",
      "p": "on-success",
      "o": "c10f6851-8f64-49c0-815a-4bcd29e5b099"
    },
    {
      "s": "a1d5bcee-708a-4a93-8aa1-0611b1581b14",
      "p": "on-failure",
      "o": "c10f6851-8f64-49c0-815a-4bcd29e5b099"
    }
  ],
  "tags": [
    "T1136.001",
    "atomic-red-team"
  ],
  "input_arguments": [
    {
      "name": "username",
      "type": "string",
      "description": "Username of the user to create",
      "value": "T1136.001_PowerShell"
    }
  ]
}